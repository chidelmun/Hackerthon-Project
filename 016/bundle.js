!function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";var r=e(155);t.exports=function(e){return e({vert:r(["\n      precision mediump float;\n#define GLSLIFY 1\n\n      attribute vec2 position;\n      uniform mat4 inverseProjection, inverseView;\n      uniform mat3 normalView;\n      varying vec3 vDirection;\n      varying vec2 vUv;\n\n      void main () {\n        vDirection = mat3(inverseView) * (inverseProjection * vec4(position, 0, 1)).xyz;\n        gl_Position = vec4(position, 0.999, 1);\n        vUv = gl_Position.xy;\n      }\n    ",""]),frag:r(["\n      precision mediump float;\n#define GLSLIFY 1\n\n      //\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289_1(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute_1(vec3 x) {\n  return mod289_1(((x*34.0)+1.0)*x);\n}\n\nfloat snoise_1(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289_1(i); // Avoid truncation effects in permutation\n  vec3 p = permute_1( permute_1( i.y + vec3(0.0, i1.y, 1.0 ))\n    + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n      //\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_0(vec4 x) {\n     return mod289_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_0(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_0 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_0;\n  vec3 i1 = min( g_0.xyz, l.zxy );\n  vec3 i2 = max( g_0.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_0(i);\n  vec4 p = permute_0( permute_0( permute_0(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n      uniform float time, viewportHeight;\n      varying vec3 vDirection;\n      varying vec2 vUv;\n      float TAU = 6.283185307179586;\n\n      float unitSin(float x) {\n        return sin(x * TAU) * 0.5 + 0.5;\n      }\n      float unitCos(float x) {\n        return sin(x * TAU) * 0.5 + 0.5;\n      }\n      float unitSnoise2 (vec2 vec) {\n        return snoise_1(vec) * 0.5 + 0.5;\n      }\n      float unitSnoise3 (vec3 vec) {\n        return snoise_0(vec) * 0.5 + 0.5;\n      }\n\n      void main () {\n        vec3 direction = normalize(vDirection);\n        vec3 green = vec3(0.3, 0.5, 0.3) * unitSnoise2(2.0 * vec2(sin(5.0 * direction.y) + direction.x + time * 0.01, direction.y));\n        vec3 yellow = vec3(0.5, 0.4, 0.3) * unitSnoise2(6.0 * vec2(direction.x, direction.y + time * 0.01));\n        float grain = 0.02 * snoise_0(direction * viewportHeight * 0.2);\n        float height = clamp(0.4, 1.0, direction.y * 2.0 + 1.4);\n        float vignette = 1.0 - pow(length(vUv * 0.6), 3.0);\n        vec3 ambient = vec3(0.5, 0.6, 0.3);\n        vec3 color = vignette * height * mix(ambient, green + yellow, 0.4) + grain;\n        gl_FragColor = vec4(color, 1.0);\n      }\n    ",""]),attributes:{position:[[-4,-4],[0,4],[4,-4]]},uniforms:{viewportHeight:e.context("viewportHeight")},count:3})}},{155:155}],2:[function(e,t,n){"use strict";function r(){var e=s.createBox(l,p,d);return e.positions.forEach(function(e){e[0]+=l/2}),s.splitLoop(e,e.cells[0],.75),s.subdivide(e,1),e.positions.forEach(function(e){var t=e[0]*(1/l);e[2]*=a(v,1,t),u.rotateX(e,e,c,m)}),i(e,e.cells.slice()),e.positions.forEach(function(e){e[1]+=_+u.squaredLength(e)*w}),s.computeNormals(e),e}function i(e,t){for(var n=b,r=0;r<h;r++)t=s.getNewGeometry(e,"cells",function(){var r=s.getNewGeometry(e,"positions",function(){s.cloneCells(e,t)});n*=y,r.forEach(function(e){e[0]*=x,e[2]*=x,e[1]*=x,e[1]+=n,u.rotateY(e,e,c,g)})})}function o(e,t){return e({attributes:{position:t.positions,normal:t.normals},uniforms:{hueShiftAmount:.9,edgeGlow:.4,brightness:1},elements:s.elementsFromQuads(e,t,"triangle")})}var a=e(156),s=e(8),u=(e(155),e(100),e(82),e(130)),f=6.283185307179586,c=[0,0,0],l=.25,p=.015,d=.03,h=400,m=0*f,v=.4,g=.051*f,b=35e-5,y=1,x=.995,_=-.15,w=1;t.exports=function(e){var t=r(),n=o(e,t);return n}},{100:100,130:130,155:155,156:156,8:8,82:82}],3:[function(e,t,n){"use strict";function r(e){var t=.1,n=[0,-t,0],r=[0,t,0];return function(t){var i=t.time;return a.identity(e),a.translate(e,e,n),a.rotateZ(e,e,.1*u.noise2D(.2*i,0)+.7),a.translate(e,e,r),e}}function i(e){var t=s.identity([]);return function(){return s.normalFromMat4(t,e)}}var o=e(155),a=e(100),s=e(82),u=(e(130),new(e(175)));t.exports=function(e,t){var n=a.translate([],a.identity([]),[.1,.05,0]);a.identity([]);return e({vert:o(["\n      precision mediump float;\n#define GLSLIFY 1\n\n      attribute vec3 normal, position;\n      uniform mat4 model, morph, view, projection, projView;\n      uniform mat3 normalModel, normalMorph, normalView;\n      uniform vec3 cameraPosition;\n      varying vec3 vNormal, vCameraVector;\n\n      void main() {\n        float unitHeight = clamp(position.y + 0.8, 0.0, 1.0);\n        vec4 position4 = vec4(position, 1.0);\n\n        vec4 morphedPosition = mix(\n          model * position4,\n          morph * model * position4,\n          unitHeight\n        );\n\n        vNormal = normalView * mix(\n          normalModel * normal,\n          normalMorph * normalModel * normal,\n          unitHeight\n        );\n\n        vCameraVector = normalView * (morphedPosition.xyz - cameraPosition);\n\n        gl_Position = projView * morphedPosition;\n      }\n    ",""]),frag:o(["\n      precision mediump float;\n#define GLSLIFY 1\n\n      vec2 matcap(vec3 eye, vec3 normal) {\n  vec3 reflected = reflect(eye, normal);\n\n  float m = 2.0 * sqrt(\n    pow(reflected.x, 2.0) +\n    pow(reflected.y, 2.0) +\n    pow(reflected.z + 1.0, 2.0)\n  );\n\n  return reflected.xy / m + 0.5;\n}\n\n      vec3 hueShift (in vec3 color_0, in float shift) {\n  vec3 p = vec3(0.55735) * dot(vec3(0.55735), color_0);\n  vec3 u = color_0 - p;\n  vec3 v = cross(vec3(0.55735), u);\n  return u * cos(shift * 6.2832) + v * sin(shift * 6.2832) + p;\n}\n\n      vec3 rgb2hsl(in vec3 c) {\n  float h = 0.0;\n\tfloat s = 0.0;\n\tfloat l = 0.0;\n\tfloat r = c.r;\n\tfloat g = c.g;\n\tfloat b = c.b;\n\tfloat cMin = min(r, min(g, b));\n\tfloat cMax = max(r, max(g, b));\n\n\tl = (cMax + cMin) / 2.0;\n\tif (cMax > cMin) {\n\t\tfloat cDelta = cMax - cMin;\n\n\t\ts = l < .0 ? cDelta / (cMax + cMin) : cDelta / (2.0 - (cMax + cMin));\n\n\t\tif (r == cMax) {\n\t\t\th = (g - b) / cDelta;\n\t\t} else if (g == cMax) {\n\t\t\th = 2.0 + (b - r) / cDelta;\n\t\t} else {\n\t\t\th = 4.0 + (r - g) / cDelta;\n\t\t}\n\n\t\tif (h < 0.0) {\n\t\t\th += 6.0;\n\t\t}\n\t\th = h / 6.0;\n\t}\n\treturn vec3(h, s, l);\n}\n\n      float hue2rgb(float f1, float f2, float hue) {\n    if (hue < 0.0)\n        hue += 1.0;\n    else if (hue > 1.0)\n        hue -= 1.0;\n    float res;\n    if ((6.0 * hue) < 1.0)\n        res = f1 + (f2 - f1) * 6.0 * hue;\n    else if ((2.0 * hue) < 1.0)\n        res = f2;\n    else if ((3.0 * hue) < 2.0)\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\n    else\n        res = f1;\n    return res;\n}\n\nvec3 hsl2rgb(vec3 hsl) {\n    vec3 rgb;\n    \n    if (hsl.y == 0.0) {\n        rgb = vec3(hsl.z); // Luminance\n    } else {\n        float f2;\n        \n        if (hsl.z < 0.5)\n            f2 = hsl.z * (1.0 + hsl.y);\n        else\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\n            \n        float f1 = 2.0 * hsl.z - f2;\n        \n        rgb.r = hue2rgb(f1, f2, hsl.x + (1.0/3.0));\n        rgb.g = hue2rgb(f1, f2, hsl.x);\n        rgb.b = hue2rgb(f1, f2, hsl.x - (1.0/3.0));\n    }   \n    return rgb;\n}\n\nvec3 hsl2rgb(float h, float s, float l) {\n    return hsl2rgb(vec3(h, s, l));\n}\n\n      uniform sampler2D matcapTexture;\n      varying vec3 vNormal, vCameraVector;\n      uniform float hueShiftAmount, saturationShiftAmount, lightnessShiftAmount, edgeGlow, brightness;\n\n      void main() {\n        vec3 normal = normalize(vNormal);\n        vec2 uv = matcap(\n          normalize(vCameraVector),\n          normal\n        );\n\n        float edge = edgeGlow * pow(1.0 - dot(normal, vec3(0.0, 0.2, 0.9)), 2.0);\n        vec3 color = texture2D(matcapTexture, uv).rgb;\n        vec3 hslColor = rgb2hsl(color);\n        hslColor[0] += hueShiftAmount;\n        hslColor[1] += saturationShiftAmount;\n        hslColor[2] += lightnessShiftAmount;\n        vec3 rgbColor = hsl2rgb(hslColor);\n        gl_FragColor = vec4(edge + brightness * rgbColor, 1.0);\n      }\n    ",""]),uniforms:{model:n,normalModel:s.normalFromMat4([],n),morph:r(n),normalMorph:i(n),matcapTexture:e.prop("matcapTexture"),edgeGlow:.4,brightness:1,hueShiftAmount:.3,saturationShiftAmount:.2,lightnessShiftAmount:0},cull:{enable:!0}})}},{100:100,130:130,155:155,175:175,82:82}],4:[function(e,t,n){"use strict";var r=e(9)(),i=e(6)(r),o={depth:1,color:[0,0,0,1]},a=e(174),s=e(3)(r),u=e(2)(r),f=e(5)(r),c=e(7)(r),l=e(1)(r);a({manifest:{matcapTexture:{type:"image",src:"/common/textures/matcap/00ZBrush_RedWax.png",parser:function(e){return r.texture({data:e,mag:"linear",min:"linear",flipY:!0})}}},onDone:function(e){var t=r.frame(function(){try{r.clear(o),i(function(){s(e,function(){u(e),f(e),c(e)}),l()}),window.frameDone()}catch(e){console.error(e),t.cancel()}})}})},{1:1,174:174,2:2,3:3,5:5,6:6,7:7,9:9}],5:[function(e,t,n){"use strict";function r(){var e=s.createBox(p,d,h);return e.positions.forEach(function(e){e[0]+=p/2}),s.splitLoop(e,e.cells[0],.75),s.subdivide(e,1),e.positions.forEach(function(e){var t=u.squaredLength(e);t<.1*p&&t>.025*p&&(e[1]+=b)}),s.subdivide(e,1),e.positions.forEach(function(e){var t=e[0]*(1/p);e[2]*=a(g,1,t),u.rotateX(e,e,l,v)}),i(e,e.cells.slice(),f(9)),e.positions.forEach(function(e){e[1]+=w+u.squaredLength(e)*y}),s.computeNormals(e),e}function i(e,t,n){for(var r=function(r){var i=n()*_,o=n(-S,S),a=n(-A,A),f=n(-k,k),c=n(-E,E);t=s.getNewGeometry(e,"cells",function(){var n=s.getNewGeometry(e,"positions",function(){s.cloneCells(e,t)});n.forEach(function(e){e[0]*=1+o,e[1]*=1+a,e[2]*=1+f,e[1]+=c*(u.length(e)/p),u.rotateY(e,e,l,x+i)})})},i=0;i<m;i++)r(i)}function o(e,t){return e({attributes:{position:t.positions,normal:t.normals},uniforms:{hueShiftAmount:0,edgeGlow:.3,brightness:1,saturationShiftAmount:.6,lightnessShiftAmount:-.05},elements:s.elementsFromQuads(e,t,"triangle")})}var a=e(156),s=e(8),u=(e(155),e(100),e(82),e(130)),f=e(11),c=6.283185307179586,l=[0,0,0],p=.5,d=.015,h=.07,m=25,v=0*c,g=.4,b=.03,y=.6,x=c/m,_=.15,w=-.16,S=.04,A=0,k=.1,E=.02;t.exports=function(e){var t=r(),n=o(e,t);return n}},{100:100,11:11,130:130,155:155,156:156,8:8,82:82}],6:[function(e,t,n){"use strict";function r(e,t){for(var n=arguments,r=[],i=0;i<e;i++)r.push([]);var o=[r];return function(e,r){for(var i=0;i<n.length;i++)o[i+1]=n[i];return t.apply(null,o)}}var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e(130),a=e(82),s=e(100),u=e(159),f=e(162),c=6.283185307179586,l=.1*c,p=.3;t.exports=function(e){function t(e){var t=arguments;return function(r){var i=(r.time,r.tick),o=r.viewportWidth,a=r.viewportHeight;return i!==d&&(c.update(),c.copyInto(n.position,n.direction,n.up),n.viewport[2]=o,n.viewport[3]=a,n.update(),d=i),e.apply(null,t)}}var n=f({fov:l,near:.1,far:10,position:[0,0,1]}),c=u({phi:.4*Math.PI,theta:p,distanceBounds:[.75,1.25],zoomSpeed:0,pinchSpeed:0,rotateSpeed:.001,damping:.01,parent:e._gl.canvas,element:e._gl.canvas});n.update();var d=void 0;return e({uniforms:{projection:t(function(){return n.projection}),view:function(){return n.view},projView:function(){return n.projView},inverseProjection:function(){return s.invert([],n.projection)},normalProjView:function(){return a.normalFromMat4([],n.projView)},inverseView:r(1,function(e){var t=i(e,1);t[0];return s.invert([],n.view)}),normalView:r(1,function(e){var t=i(e,1),r=t[0];return a.normalFromMat4(r,n.view)}),light0:o.normalize([],[0,1,.1]),light1:o.normalize([],[.5,-1,.5]),light2:o.normalize([],[-.5,.2,.8]),lightColor0:o.scale([],[1,.9,.9],0),lightColor1:o.scale([],[.8,1,1],0),lightColor2:o.scale([],[.8,.8,1],0),time:function(e){var t=e.time;return t},cameraPosition:function(){return n.position}},context:{fov:l}})}},{100:100,130:130,159:159,162:162,82:82}],7:[function(e,t,n){"use strict";function r(){var e=o.createBox(a,a*s,a);return o.extrude(e,e.cells[1],.8,.025),o.extrude(e,e.cells[1],0,.05),o.extrude(e,e.cells[1],0,.05),o.extrude(e,e.cells[1],0,.05),o.extrude(e,e.cells[0],.5,-.005),e.positions.forEach(function(e){e[1]+=u}),o.subdivide(e,2)}function i(e,t){return e({attributes:{position:t.positions,normal:t.normals},uniforms:{hueShiftAmount:.3,edgeGlow:.3,brightness:.75,saturationShiftAmount:.3,lightnessShiftAmount:-.05},elements:o.elementsFromQuads(e,t,"triangle")})}var o=(e(156),e(8)),a=(e(155),e(100),e(82),e(130),e(11),.2),s=.25,u=-.16;t.exports=function(e){var t=r(),n=i(e,t);return n}},{100:100,11:11,130:130,155:155,156:156,8:8,82:82}],8:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){var n=e.positions,r=e.cells,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,o=F(t,4),a=o[0],s=o[1],u=o[2],f=o[3],c=n[a],l=n[s],p=n[u],d=n[f],h=I.lerp([],l,p,i),m=I.lerp([],c,d,i),v=n.length,g=v+1;n[v]=h,n[g]=m,t[2]=v,t[3]=g,r.push([g,v,u,f])}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=e.positions,i=e.cells,o=e.normals,a=F(t,4),s=a[0],u=a[1],f=a[2],c=a[3],l=r.length,p=l+1,d=l+2,h=l+3,m=I.lerp([],r[u],r[f],n),v=I.lerp([],r[s],r[c],n);r[l]=m,r[p]=v,r[d]=m.slice(),r[h]=v.slice(),t[2]=l,t[3]=p,i.push([h,d,f,c]);var g=o[s];o[p]=g.slice(),o[h]=g.slice(),o[l]=g.slice(),o[d]=g.slice()}function a(e,t){var n=e.positions,r=e.cells,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,o=F(t,4),a=o[0],s=o[1],u=o[2],f=o[3],c=n[a],l=n[s],p=n[u],d=n[f],h=I.lerp([],l,c,i),m=I.lerp([],p,d,i),v=n.length,g=v+1;n[v]=h,n[g]=m,t[1]=v,t[2]=g,r.push([v,s,u,g])}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=e.positions,i=e.cells,o=e.normals,a=F(t,4),s=a[0],u=a[1],f=a[2],c=a[3],l=r.length,p=l+1,d=l+2,h=l+3,m=I.lerp([],r[s],r[u],n),v=I.lerp([],r[c],r[f],n);r[l]=m,r[p]=v,r[d]=m.slice(),r[h]=v.slice(),t[0]=l,t[3]=p,i.push([s,d,h,c]);var g=o[s];o[l]=g.slice(),o[p]=g.slice(),o[d]=g.slice(),o[h]=g.slice()}function u(e){for(var t={},n=0;n<e.cells.length;n++)for(var r=e.cells[n],i=0;i<r.length;i++){var o=r[i],a=t[o];a||(a=[],t[o]=a),a.push(r)}return t}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.positions[t[0]],i=e.positions[t[1]],o=e.positions[t[2]],a=e.positions[t[3]];return n[0]=.25*(r[0]+i[0]+o[0]+a[0]),n[1]=.25*(r[1]+i[1]+o[1]+a[1]),n[2]=.25*(r[2]+i[2]+o[2]+a[2]),n}function c(e,t){var n=e.positions.length,r=[n,n+1,n+2,n+3];return e.cells.push(r),e.positions.push(e.positions[t[0]].slice()),e.positions.push(e.positions[t[1]].slice()),e.positions.push(e.positions[t[2]].slice()),e.positions.push(e.positions[t[3]].slice()),e.normals.push(e.normals[t[0]].slice()),e.normals.push(e.normals[t[1]].slice()),e.normals.push(e.normals[t[2]].slice()),e.normals.push(e.normals[t[3]].slice()),r}function l(e,t){for(var n=[],r=0;r<t.length;r++)for(var i=t[r],o=0;o<i.length;o++){var a=i[o];n[a]=a}for(var s=n.filter(function(e){return void 0!==e}),u=e.positions.length,f=t.length,c=0;c<f;c++){var l=t[c];e.cells.push(l.map(function(e){return s.indexOf(e)+u}))}for(var p=0;p<s.length;p++)e.positions.push(e.positions[s[p]].slice());for(var d=0;d<s.length;d++)e.normals.push(e.normals[s[d]].slice());return e}function p(e,t){var n=e.normals[t[0]];H(e,t,n),I.copy(e.normals[t[1]],n),I.copy(e.normals[t[2]],n),I.copy(e.normals[t[3]],n)}function d(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0;r<e.cells.length;r++){var i=e.cells[r];i.indexOf(t)>=0&&n.push(i)}return n}function h(e,t){var n=F(t,4),r=n[0],i=n[1],o=n[2],a=n[3];t.reverse();var s=e.normals[r],u=e.normals[i],f=e.normals[o],c=e.normals[a];return I.scale(s,s,-1),I.scale(u,u,-1),I.scale(f,f,-1),I.scale(c,c,-1),t}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.positions||(t.positions=[]),t.normals||(t.normals=[]),t.cells||(t.cells=[]);var n=t.positions.length,r=void 0,i=[n,n+1,n+2,n+3];if(t.cells.push(i),e.positions)t.positions.push(e.positions[0]),t.positions.push(e.positions[1]),t.positions.push(e.positions[2]),t.positions.push(e.positions[3]);else{var o=void 0,a=void 0;e.w&&e.h?(o=e.w/2,a=e.h/2):(o=.5,a=.5);var s=e.facing||"y+",u=s[0];switch(r=s[1],u){case"x":t.positions.push([0,-o,-a]),t.positions.push([0,o,-a]),t.positions.push([0,o,a]),t.positions.push([0,-o,a]);break;case"y":t.positions.push([-o,0,-a]),t.positions.push([-o,0,a]),t.positions.push([o,0,a]),t.positions.push([o,0,-a]);break;case"z":t.positions.push([-o,-a,0]),t.positions.push([-o,a,0]),t.positions.push([o,a,0]),t.positions.push([o,-a,0])}}var f=H(t,i,[]);return t.normals.push(f),t.normals.push(f.slice()),t.normals.push(f.slice()),t.normals.push(f.slice()),"-"===r&&h(t,i),{quads:t,cell:i}}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments[3],i=m({w:e,h:n},r),o=i.quads,a=i.cell;return o.positions.forEach(function(e){e[1]-=t/2}),c(o,a),h(o,o.cells[1]),G(o,a,0,t),o}function g(e,t,n,r){return b(v(e,t,n,r))}function b(e){for(var t=e.positions,n=e.normals,r=e.cells,i=0;i<t.length;i++)for(var o=t[i],a=i+1;a<t.length;a++){var s=t[a];if(o[0]===s[0]&&o[1]===s[1]&&o[2]===s[2]){for(var u=0;u<r.length;u++)for(var f=r[u],c=0;c<f.length;c++){var l=f[c];l===i?f[c]=a-1:l>i&&f[c]--}t.splice(i,1),n.splice(i,1),i--;break}}for(var p=new Map,d=0;d<t.length;d++)q(e,d,n[d],p);return e}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"triangles",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uint16Array,i="lines"===n?8:6,o=new r(t.cells.length*i);if("lines"===n)for(var a=0;a<t.cells.length;a++){var s=F(t.cells[a],4),u=s[0],f=s[1],c=s[2],l=s[3],p=a*i;o[p+0]=u,o[p+1]=f,o[p+2]=f,o[p+3]=c,o[p+4]=c,o[p+5]=l,o[p+6]=l,o[p+7]=u}else for(var d=0;d<t.cells.length;d++){var h=d*i,m=F(t.cells[d],4),u=m[0],f=m[1],c=m[2],l=m[3];o[h+0]=u,o[h+1]=f,o[h+2]=c,o[h+3]=c,o[h+4]=l,o[h+5]=u}return o}function x(e){e.normals||(e.normals=[]);for(var t=new Map,n=u(e),r=0;r<e.positions.length;r++){var i=e.normals[r];i||(i=[],e.normals[r]=i),q(e,r,i,t,n)}return e}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments[3],i=void 0,o=void 0,a=void 0,s=void 0;r?(i=1,o=2,a=3,s=0):(i=0,o=1,a=2,s=3);var u=t[i],f=t[o],c=e.positions.length,l=e.positions.length+1,p=t[a],d=t[s],h=I.lerp([],e.positions[f],e.positions[p],n),m=I.lerp([],e.positions[u],e.positions[d],n),v=I.lerp([],e.normals[f],e.normals[p],n),g=I.lerp([],e.normals[u],e.normals[d],n);e.positions.push(h),e.positions.push(m),e.normals.push(I.normalize(v,v)),e.normals.push(I.normalize(g,g));var b=t,y=[];e.cells.push(y),b[a]=c,b[s]=l,y[i]=l,y[o]=c,y[a]=p,y[s]=d;var x=S(e,f,c,p,n),_=w(e,x,l);return _||S(e,d,l,u,1-n),e}function w(e,t,n){var r=e.positions,i=e.normals,o=e.cells;if(t>=0&&n>=0){var a=r[t],s=r[n];if(a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]){for(var u=t<n?t:n,f=t>n?t:n,c=0;c<o.length;c++)for(var l=o[c],p=0;p<l.length;p++){var d=l[p];d===f?l[p]=u:d>f&&(l[p]=d-1)}r.splice(f,1),i.splice(f,1)}}}function S(e,t,n,r,i){for(var o=void 0;;){var a=A(e,t,r);if(!a)break;var s=a.indexOf(t),u=a.indexOf(r),f=(s+1)%4,c=(u+3)%4,l=a[f],p=e.positions.length,d=a[c],h=I.lerp([],e.positions[l],e.positions[d],i),m=I.lerp([],e.normals[l],e.normals[d],i);I.normalize(m,m),e.positions.push(h),e.normals.push(m);var v=a,g=[];e.cells.push(g),v[c]=p,v[u]=n,g[s]=n,g[f]=p,g[c]=d,g[u]=r,t=l,n=p,r=d,o=p}return o}function A(e,t,n,r){return e.cells.find(function(e){if(e===r)return!1;var i=e.indexOf(t);return i>=0&&(e[(i+1)%4]===n||e[(i+3)%4]===n)})}function k(e,t){var n=e[t],r=n.length;return{mark:function(){return r=n.length},get:function(){return n.slice(r,n.length)}}}function E(e,t,n){var r=e[t],i=r.length;return n(),r.slice(i,r.length)}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.positions,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.cells,i=B(n,r,t,!1);return e.positions=i.positions,e.cells=i.cells,x(e),e}function O(e){return e.cells.map(function(t){return T(e,t)})}function T(e,t){var n=F(t,4),r=n[0],i=n[1],o=n[2],a=n[3],s=e.positions,u=s[r],f=s[i],c=s[o],l=s[a];return[.25*(u[0]+f[0]+c[0]+l[0]),.25*(u[1]+f[1]+c[1]+l[1]),.25*(u[2]+f[2]+c[2]+l[2])]}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments[3],i=1-.5*n,o=.5*n+(1-i)*n;return _(e,t,i,r),_(e,t,o,r),e}function M(e,t,n,i){if("cells"===n)return C(e,t,i);var o=void 0,a=void 0;return i?(o=t[1],a=t[2]):(o=t[0],a=t[1]),[].concat(r(z(e,t,n,o,a)),r(t.map(function(t){return e[n][t]})),r(z(e,t,n,a,o).reverse()))}function C(e,t,n){var i=void 0,o=void 0;return n?(i=t[1],o=t[2]):(i=t[0],o=t[1]),[].concat(r(P(e,t,i,o)),[t],r(P(e,t,o,i).reverse()))}function P(e,t,n,r){for(var i=[],o=n,a=r,s=t;;){if(s=A(e,o,a,s),!s||s===t)break;i.push(s);var u=s.indexOf(o),f=s.indexOf(a),c=(u+1)%4,l=(f+3)%4;o=s[c],a=s[l]}return i}function z(e,t,n,r,i){for(var o=[],a=r,s=i,u=t;;){if(u=A(e,a,s,u),!u||u===t)break;var f=u.indexOf(a),c=u.indexOf(s),l=(f+1)%4,p=(c+3)%4;o.push(e[n][u[l]]),o.push(e[n][u[p]]),a=u[l],s=u[p]}return o}function L(e,t,n){var r={};return t.forEach(function(t){var i=t.map(function(t){var i=r[t];if(void 0===i){i=e.positions.length,r[t]=i;var o=e.positions[t],a=e.normals[t],s=o.slice(),u=a.slice();s[n]*=-1,u[n]*=-1,e.positions.push(s),e.normals.push(u)}return i});i.reverse(),e.cells.push(i)}),e}var F=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),I=e(130),B=e(71),R=function(){var e=[0,0,0];return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.positions,o=t.cells,a=t.normals,s=F(n,4),u=s[0],f=s[1],c=s[2],l=s[3],p=i.length,d=p+1,h=d+1,m=h+1,v=i[u],g=i[f],b=i[c],y=i[l];e[0]=(v[0]+g[0]+b[0]+y[0])/4,e[1]=(v[1]+g[1]+b[1]+y[1])/4,e[2]=(v[2]+g[2]+b[2]+y[2])/4,i.push(I.lerp([],v,e,r)),i.push(I.lerp([],g,e,r)),i.push(I.lerp([],b,e,r)),i.push(I.lerp([],y,e,r)),a.push(a[u].slice()),a.push(a[f].slice()),a.push(a[c].slice()),a.push(a[l].slice()),n[0]=p,n[1]=d,n[2]=h,n[3]=m;var x=[u,f,d,p],_=[d,f,c,h],w=[m,h,c,l],S=[u,p,m,l];return o.push(x),o.push(_),o.push(w),o.push(S),[x,_,w,S,n]}}(),N=function(){var e=[],t=[],n=[];return function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=r.positions,u=r.normals,f=R(r,i,o),c=F(f,4),l=c[0],p=c[1],d=c[2],h=c[3];e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=l[2],e[5]=l[3],e[6]=p[0],e[7]=p[3],e[8]=d[0],e[9]=d[1],e[10]=h[1],e[11]=h[2],H(r,i,n),I.scale(t,n,a);for(var m=0;m<e.length;m++){var v=s[e[m]];I.add(v,v,t)}var g=new Map;g.set(i,n);var b=F(i,4),y=b[0],x=b[1],_=b[2],w=b[3],S=s.length-4,A=s.length-3,k=s.length-2,E=s.length-1;q(r,y,u[y],g),q(r,x,u[x],g),q(r,_,u[_],g),q(r,w,u[w],g),q(r,S,u[S],g),q(r,A,u[A],g),q(r,k,u[k],g),q(r,E,u[E],g)}}(),q=function(){var e=[];return function(t,n,r,i,o){var a=void 0;a=o?o[n]:d(t,n,e),I.set(r,0,0,0);for(var s=0;s<a.length;s++){var u=a[s],f=void 0;i&&(f=i.get(u)),f||(f=H(t,u,[]),i&&i.set(f)),I.add(r,r,f)}for(I.normalize(r,r);e.length;)e.pop();return r}}(),V=function(){var e=[0,0,0];return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.positions,o=t.cells,a=t.normals,s=F(n,4),u=s[0],f=s[1],c=s[2],l=s[3],p=i[u],d=i[f],h=i[c],m=i[l];e[0]=(p[0]+d[0]+h[0]+m[0])/4,e[1]=(p[1]+d[1]+h[1]+m[1])/4,e[2]=(p[2]+d[2]+h[2]+m[2])/4;var v=I.lerp([],p,e,r),g=I.lerp([],d,e,r),b=I.lerp([],h,e,r),y=I.lerp([],m,e,r),x=i.length,_=x,w=u,S=f,A=x+1,k=x+2,E=c,j=l,O=x+3,T=x+4,D=x+5,M=x+6,C=x+7,P=x+8,z=x+9,L=x+10,B=x+11,R=x+12,N=x+13,q=x+14,V=x+15;n[0]=T,n[1]=C,n[2]=L,n[3]=N;var G=[w,S,P,M],H=[z,A,k,B],U=[q,R,E,j],W=[_,D,V,O];o.push(G),o.push(H),o.push(U),o.push(W),i[_]=p.slice(),i[w]=p,i[S]=d,i[A]=d.slice(),i[k]=h.slice(),i[E]=h,i[j]=m,i[O]=m.slice(),i[T]=v,i[D]=v.slice(),i[M]=v.slice(),i[C]=g,i[P]=g.slice(),i[z]=g.slice(),i[L]=b,i[B]=b.slice(),i[R]=b.slice(),i[N]=y,i[q]=y.slice(),i[V]=y.slice();var Q=a[u];return a[_]=Q.slice(),a[w]=a[u],a[S]=a[f],a[A]=Q.slice(),a[k]=Q.slice(),a[E]=a[c],a[j]=a[l],a[O]=Q.slice(),a[T]=Q.slice(),a[D]=Q.slice(),a[M]=Q.slice(),a[C]=Q.slice(),a[P]=Q.slice(),a[z]=Q.slice(),a[L]=Q.slice(),a[B]=Q.slice(),a[R]=Q.slice(),a[N]=Q.slice(),a[q]=Q.slice(),a[V]=Q.slice(),[G,H,U,W]}}(),G=function(){var e=[],t=[];return function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n.positions,s=n.normals,u=V(n,r,i),f=F(u,4),c=f[0],l=f[1],d=f[2],h=f[3];e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=c[2],e[5]=c[3],e[6]=l[0],e[7]=l[3],e[8]=d[0],e[9]=d[1],e[10]=h[1],e[11]=h[2];var m=s[r[0]];I.scale(t,m,o);for(var v=0;v<e.length;v++){var g=a[e[v]];I.add(g,g,t)}for(var b=0;b<u.length;b++)p(n,u[b])}}(),H=function(){var e=[],t=[];return function(n,r,i){var o=n.positions[r[0]],a=n.positions[r[1]],s=n.positions[r[2]];return I.subtract(e,a,o),I.subtract(t,s,a),I.normalize(i,I.cross(i,e,t)),i}}();t.exports={averageNormalForPosition:q,clone:c,cloneCells:l,computeCenterPositions:O,computeCellCenter:T,computeNormals:x,createBox:g,createBoxDisjoint:v,createGeometryGetter:k,createQuad:m,elementsFromQuads:y,extrude:N,extrudeDisjoint:G,flip:h,getCellNormal:H,getCellFromEdge:A,getCellsFromPositionIndex:d,getCenter:f,getLoop:M,getNewGeometry:E,inset:R,insetDisjoint:V,insetLoop:D,mergePositions:b,mirror:L,subdivide:j,splitHorizontal:a,splitHorizontalDisjoint:s,splitLoop:_,splitVertical:i,splitVerticalDisjoint:o,updateNormals:p}},{130:130,71:71}],9:[function(e,t,n){"use strict";var r=e(173);t.exports=function(){var e=this,t=arguments,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=Object.assign({onDone:function(r){if("function"==typeof n.onDone&&n.onDone.apply(e,t),r){var i=document.createElement("div");document.body.appendChild(i),i.className="error";var o=document.createElement("div");o.innerText=r,i.appendChild(o)}}},n);return"function"==typeof headlessRegl?i=headlessRegl(i):window.frameDone=function(){},r(i)}},{173:173}],10:[function(e,t,n){function r(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)}}t.exports=function(){var e=Array.prototype.slice.call(arguments),t=0,n=0,i=0,o=1;0===e.length&&(e=[+new Date]);var a=r();t=n=i=a(" ");for(var s=0;s<e.length;s++)t-=a(e[s]),t<0&&(t+=1),n-=a(e[s]),n<0&&(n+=1),i-=a(e[s]),i<0&&(i+=1);return function(){var e=2091639*t+2.3283064365386963e-10*o;
return t=n,n=i,i=e-(o=0|e)}}},{}],11:[function(e,t,n){var r=e(10);t.exports=function(){var e=r.apply(this,arguments);return function(t,n,r){t=void 0===t?0:t,n=void 0===n?1:n;var i=t+e()*(n-t);return r?parseInt(i,10):i}}},{10:10}],12:[function(e,t,n){function r(e,t,n,r,u){o(e,n[0],n[1],0),o(t,n[0],n[1],1),i(e,e,r,u),i(t,t,r,u),a(t,t,e),s(t,t)}var i=e(14),o=e(145),a=e(148),s=e(138);t.exports=r},{138:138,14:14,145:145,148:148}],13:[function(e,t,n){function r(e,t,n,r){var f=n[0],c=n[1],l=n[2],p=n[3],d=a,h=s;o(u,t[0],t[1],t[2],1),i(u,u,r);var m=u[3];return 0!==m&&(u[0]=u[0]/m,u[1]=u[1]/m,u[2]=u[2]/m),e[0]=f+l/2*u[0]+(0+l/2),e[1]=c+p/2*u[1]+(0+p/2),e[2]=(h-d)/2*u[2]+(h+d)/2,e[3]=0===m?0:1/m,e}var i=e(154),o=e(153),a=0,s=1,u=[0,0,0,0];t.exports=r},{153:153,154:154}],14:[function(e,t,n){function r(e,t,n,r){var o=n[0],a=n[1],s=n[2],u=n[3],f=t[0],c=t[1],l=t[2];return f-=o,c=u-c-1,c-=a,e[0]=2*f/s-1,e[1]=2*c/u-1,e[2]=2*l-1,i(e,e,r)}var i=e(15);t.exports=r},{15:15}],15:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],f=n[3],c=n[4],l=n[5],p=n[6],d=n[7],h=n[8],m=n[9],v=n[10],g=n[11],b=n[12],y=n[13],x=n[14],_=n[15],w=1/(r*f+i*d+o*g+_);return e[0]=(r*a+i*c+o*h+b)*w,e[1]=(r*s+i*l+o*m+y)*w,e[2]=(r*u+i*p+o*v+x)*w,e}t.exports=r},{}],16:[function(e,t,n){function r(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}t.exports=r},{}],17:[function(e,t,n){"use strict";var r,i=e(33),o=e(41),a=e(46),s=e(47),u=Function.prototype.bind,f=Object.defineProperty,c=Object.prototype.hasOwnProperty;r=function(e,t,n){var r,o=s(t)&&a(t.value);return r=i(t),delete r.writable,delete r.value,r.get=function(){return c.call(this,e)?o:(t.value=u.call(o,null==n?this:this[n]),f(this,e,t),this[e])},r},t.exports=function(e){var t=arguments[1];return o(e,function(e,n){return r(n,e,t)})}},{33:33,41:41,46:46,47:47}],18:[function(e,t,n){"use strict";var r,i=e(30),o=e(42),a=e(36),s=e(48);r=t.exports=function(e,t){var n,r,a,u,f;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(n=a=!0,r=!1):(n=s.call(e,"c"),r=s.call(e,"e"),a=s.call(e,"w")),f={value:t,configurable:n,enumerable:r,writable:a},u?i(o(u),f):f},r.gs=function(e,t,n){var r,u,f,c;return"string"!=typeof e?(f=n,n=t,t=e,e=null):f=arguments[3],null==t?t=void 0:a(t)?null==n?n=void 0:a(n)||(f=n,n=void 0):(f=t,t=n=void 0),null==e?(r=!0,u=!1):(r=s.call(e,"c"),u=s.call(e,"e")),c={get:t,set:n,configurable:r,enumerable:u},f?i(o(f),c):c}},{30:30,36:36,42:42,48:48}],19:[function(e,t,n){t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],20:[function(e,t,n){function r(e,t){return{configurable:!0,enumerable:!0,get:e,set:t}}t.exports=r},{}],21:[function(e,t,n){"use strict";var r=e(47);t.exports=function(){return r(this).length=0,this}},{47:47}],22:[function(e,t,n){"use strict";var r=e(28),i=e(47),o=Array.prototype.indexOf,a=Object.prototype.hasOwnProperty,s=Math.abs,u=Math.floor;t.exports=function(e){var t,n,f,c;if(e===e)return o.apply(this,arguments);for(n=r(i(this).length),f=arguments[1],f=isNaN(f)?0:f>=0?u(f):r(this.length)-u(s(f)),t=f;t<n;++t)if(a.call(this,t)&&(c=this[t],c!==c))return t;return-1}},{28:28,47:47}],23:[function(e,t,n){"use strict";var r=Object.prototype.toString,i=r.call(function(){return arguments}());t.exports=function(e){return r.call(e)===i}},{}],24:[function(e,t,n){"use strict";t.exports=e(25)()?Math.sign:e(26)},{25:25,26:26}],25:[function(e,t,n){"use strict";t.exports=function(){var e=Math.sign;return"function"==typeof e&&(1===e(10)&&e(-20)===-1)}},{}],26:[function(e,t,n){"use strict";t.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1}},{}],27:[function(e,t,n){"use strict";var r=e(24),i=Math.abs,o=Math.floor;t.exports=function(e){return isNaN(e)?0:(e=Number(e),0!==e&&isFinite(e)?r(e)*o(i(e)):e)}},{24:24}],28:[function(e,t,n){"use strict";var r=e(27),i=Math.max;t.exports=function(e){return i(0,r(e))}},{27:27}],29:[function(e,t,n){"use strict";var r=e(46),i=e(47),o=Function.prototype.bind,a=Function.prototype.call,s=Object.keys,u=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(n,f){var c,l=arguments[2],p=arguments[3];return n=Object(i(n)),r(f),c=s(n),p&&c.sort("function"==typeof p?o.call(p,n):void 0),"function"!=typeof e&&(e=c[e]),a.call(e,c,function(e,r){return u.call(n,e)?a.call(f,l,n[e],e,n,r):t})}}},{46:46,47:47}],30:[function(e,t,n){"use strict";t.exports=e(31)()?Object.assign:e(32)},{31:31,32:32}],31:[function(e,t,n){"use strict";t.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],32:[function(e,t,n){"use strict";var r=e(38),i=e(47),o=Math.max;t.exports=function(e,t){var n,a,s,u=o(arguments.length,2);for(e=Object(i(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<u;++a)t=arguments[a],r(t).forEach(s);if(void 0!==n)throw n;return e}},{38:38,47:47}],33:[function(e,t,n){"use strict";var r=e(30),i=e(47);t.exports=function(e){var t=Object(i(e));return t!==e?t:r({},e)}},{30:30,47:47}],34:[function(e,t,n){"use strict";var r,i=Object.create;e(44)()||(r=e(45)),t.exports=function(){var e,t,n;return r?1!==r.level?i:(e={},t={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){return"__proto__"===e?void(t[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(t[e]=n)}),Object.defineProperties(e,t),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,n){return i(null===t?e:t,n)}):i}()},{44:44,45:45}],35:[function(e,t,n){"use strict";t.exports=e(29)("forEach")},{29:29}],36:[function(e,t,n){"use strict";t.exports=function(e){return"function"==typeof e}},{}],37:[function(e,t,n){"use strict";var r={function:!0,object:!0};t.exports=function(e){return null!=e&&r[typeof e]||!1}},{}],38:[function(e,t,n){"use strict";t.exports=e(39)()?Object.keys:e(40)},{39:39,40:40}],39:[function(e,t,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],40:[function(e,t,n){"use strict";var r=Object.keys;t.exports=function(e){return r(null==e?e:Object(e))}},{}],41:[function(e,t,n){"use strict";var r=e(46),i=e(35),o=Function.prototype.call;t.exports=function(e,t){var n={},a=arguments[2];return r(t),i(e,function(e,r,i,s){n[r]=o.call(t,a,e,r,i,s)}),n}},{35:35,46:46}],42:[function(e,t,n){"use strict";var r=Array.prototype.forEach,i=Object.create,o=function(e,t){var n;for(n in e)t[n]=e[n]};t.exports=function(e){var t=i(null);return r.call(arguments,function(e){null!=e&&o(Object(e),t)}),t}},{}],43:[function(e,t,n){"use strict";t.exports=e(44)()?Object.setPrototypeOf:e(45)},{44:44,45:45}],44:[function(e,t,n){"use strict";var r=Object.create,i=Object.getPrototypeOf,o={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||r;return"function"==typeof e&&i(e(t(null),o))===o}},{}],45:[function(e,t,n){"use strict";var r,i=e(37),o=e(47),a=Object.prototype.isPrototypeOf,s=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(e,t){if(o(e),null===t||i(t))return e;throw new TypeError("Prototype must be null or an object")},t.exports=function(e){var t,n;return e?(2===e.level?e.set?(n=e.set,t=function(e,t){return n.call(r(e,t),t),e}):t=function(e,t){return r(e,t).__proto__=t,e}:t=function e(t,n){var i;return r(t,n),i=a.call(e.nullPolyfill,t),i&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,i&&s(e.nullPolyfill,"__proto__",u),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e,t=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{e=r.set,e.call(t,n)}catch(e){}if(Object.getPrototypeOf(t)===n)return{set:e,level:2}}return t.__proto__=n,Object.getPrototypeOf(t)===n?{level:2}:(t={},t.__proto__=n,Object.getPrototypeOf(t)===n&&{level:1})}()),e(34)},{34:34,37:37,47:47}],46:[function(e,t,n){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],47:[function(e,t,n){"use strict";t.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}},{}],48:[function(e,t,n){"use strict";t.exports=e(49)()?String.prototype.contains:e(50)},{49:49,50:50}],49:[function(e,t,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(r.contains("dwa")===!0&&r.contains("foo")===!1)}},{}],50:[function(e,t,n){"use strict";var r=String.prototype.indexOf;t.exports=function(e){return r.call(this,e,arguments[1])>-1}},{}],51:[function(e,t,n){"use strict";var r=Object.prototype.toString,i=r.call("");t.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||r.call(e)===i)||!1}},{}],52:[function(e,t,n){"use strict";var r,i=e(43),o=e(48),a=e(18),s=e(55),u=Object.defineProperty;r=t.exports=function(e,t){return this instanceof r?(s.call(this,e),t=t?o.call(t,"key+value")?"key+value":o.call(t,"key")?"key":"value":"value",void u(this,"__kind__",a("",t))):new r(e,t)},i&&i(r,s),r.prototype=Object.create(s.prototype,{constructor:a(r),_resolve:a(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e}),toString:a(function(){return"[object Array Iterator]"})})},{18:18,43:43,48:48,55:55}],53:[function(e,t,n){"use strict";var r=e(23),i=e(46),o=e(51),a=e(54),s=Array.isArray,u=Function.prototype.call,f=Array.prototype.some;t.exports=function(e,t){var n,c,l,p,d,h,m,v,g=arguments[2];if(s(e)||r(e)?n="array":o(e)?n="string":e=a(e),i(t),l=function(){p=!0},"array"===n)return void f.call(e,function(e){if(u.call(t,g,e,l),p)return!0});if("string"!==n)for(c=e.next();!c.done;){if(u.call(t,g,c.value,l),p)return;c=e.next()}else for(h=e.length,d=0;d<h&&(m=e[d],d+1<h&&(v=m.charCodeAt(0),v>=55296&&v<=56319&&(m+=e[++d])),u.call(t,g,m,l),!p);++d);}},{23:23,46:46,51:51,54:54}],54:[function(e,t,n){"use strict";var r=e(23),i=e(51),o=e(52),a=e(57),s=e(58),u=e(64).iterator;t.exports=function(e){return"function"==typeof s(e)[u]?e[u]():r(e)?new o(e):i(e)?new a(e):new o(e)}},{23:23,51:51,52:52,57:57,58:58,64:64}],55:[function(e,t,n){"use strict";var r,i=e(21),o=e(30),a=e(46),s=e(47),u=e(18),f=e(17),c=e(64),l=Object.defineProperty,p=Object.defineProperties;t.exports=r=function(e,t){return this instanceof r?(p(this,{__list__:u("w",s(e)),__context__:u("w",t),__nextIndex__:u("w",0)}),void(t&&(a(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear)))):new r(e,t)},p(r.prototype,o({constructor:u(r),_next:u(function(){var e;if(this.__list__)return this.__redo__&&(e=this.__redo__.shift(),void 0!==e)?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:u(function(){return this._createResult(this._next())}),_createResult:u(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:u(function(e){return this.__list__[e]}),_unBind:u(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:u(function(){return"[object Iterator]"})},f({_onAdd:u(function(e){if(!(e>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void l(this,"__redo__",u("c",[e]));this.__redo__.forEach(function(t,n){t>=e&&(this.__redo__[n]=++t)},this),this.__redo__.push(e)}}),_onDelete:u(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(t=this.__redo__.indexOf(e),t!==-1&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,n){t>e&&(this.__redo__[n]=--t)},this)))}),_onClear:u(function(){this.__redo__&&i.call(this.__redo__),this.__nextIndex__=0})}))),l(r.prototype,c.iterator,u(function(){return this})),l(r.prototype,c.toStringTag,u("","Iterator"))},{17:17,18:18,21:21,30:30,46:46,47:47,64:64}],56:[function(e,t,n){"use strict";var r=e(23),i=e(51),o=e(64).iterator,a=Array.isArray;t.exports=function(e){return null!=e&&(!!a(e)||(!!i(e)||(!!r(e)||"function"==typeof e[o])))}},{23:23,51:51,64:64}],57:[function(e,t,n){"use strict";var r,i=e(43),o=e(18),a=e(55),s=Object.defineProperty;r=t.exports=function(e){return this instanceof r?(e=String(e),a.call(this,e),void s(this,"__length__",o("",e.length))):new r(e)},i&&i(r,a),r.prototype=Object.create(a.prototype,{constructor:o(r),_next:o(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:o(function(e){var t,n=this.__list__[e];return this.__nextIndex__===this.__length__?n:(t=n.charCodeAt(0),t>=55296&&t<=56319?n+this.__list__[this.__nextIndex__++]:n)}),toString:o(function(){return"[object String Iterator]"})})},{18:18,43:43,55:55}],58:[function(e,t,n){"use strict";var r=e(56);t.exports=function(e){if(!r(e))throw new TypeError(e+" is not iterable");return e}},{56:56}],59:[function(e,t,n){"use strict";t.exports=e(60)()?Set:e(63)},{60:60,63:63}],60:[function(e,t,n){"use strict";t.exports=function(){var e,t,n;return"function"==typeof Set&&(e=new Set(["raz","dwa","trzy"]),"[object Set]"===String(e)&&(3===e.size&&("function"==typeof e.add&&("function"==typeof e.clear&&("function"==typeof e.delete&&("function"==typeof e.entries&&("function"==typeof e.forEach&&("function"==typeof e.has&&("function"==typeof e.keys&&("function"==typeof e.values&&(t=e.values(),n=t.next(),n.done===!1&&"raz"===n.value)))))))))))}},{}],61:[function(e,t,n){"use strict";t.exports=function(){return"undefined"!=typeof Set&&"[object Set]"===Object.prototype.toString.call(Set.prototype)}()},{}],62:[function(e,t,n){"use strict";var r,i=e(43),o=e(48),a=e(18),s=e(55),u=e(64).toStringTag,f=Object.defineProperty;r=t.exports=function(e,t){return this instanceof r?(s.call(this,e.__setData__,e),t=t&&o.call(t,"key+value")?"key+value":"value",void f(this,"__kind__",a("",t))):new r(e,t)},i&&i(r,s),r.prototype=Object.create(s.prototype,{constructor:a(r),_resolve:a(function(e){return"value"===this.__kind__?this.__list__[e]:[this.__list__[e],this.__list__[e]]}),toString:a(function(){return"[object Set Iterator]"})}),f(r.prototype,u,a("c","Set Iterator"))},{18:18,43:43,48:48,55:55,64:64}],63:[function(e,t,n){"use strict";var r,i,o,a=e(21),s=e(22),u=e(43),f=e(46),c=e(18),l=e(69),p=e(64),d=e(58),h=e(53),m=e(62),v=e(61),g=Function.prototype.call,b=Object.defineProperty,y=Object.getPrototypeOf;v&&(o=Set),t.exports=r=function(){var e,t=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return e=v&&u?u(new o,y(this)):this,null!=t&&d(t),b(e,"__setData__",c("c",[])),t?(h(t,function(e){s.call(this,e)===-1&&this.push(e)},e.__setData__),e):e},v&&(u&&u(r,o),r.prototype=Object.create(o.prototype,{constructor:c(r)})),l(Object.defineProperties(r.prototype,{add:c(function(e){return this.has(e)?this:(this.emit("_add",this.__setData__.push(e)-1,e),this)}),clear:c(function(){this.__setData__.length&&(a.call(this.__setData__),this.emit("_clear"))}),delete:c(function(e){var t=s.call(this.__setData__,e);return t!==-1&&(this.__setData__.splice(t,1),this.emit("_delete",t,e),!0)}),entries:c(function(){return new m(this,"key+value")}),forEach:c(function(e){var t,n,r,i=arguments[1];for(f(e),t=this.values(),n=t._next();void 0!==n;)r=t._resolve(n),g.call(e,i,r,r,this),n=t._next()}),has:c(function(e){return s.call(this.__setData__,e)!==-1}),keys:c(i=function(){return this.values()}),size:c.gs(function(){return this.__setData__.length}),values:c(function(){return new m(this)}),toString:c(function(){return"[object Set]"})})),b(r.prototype,p.iterator,c(i)),b(r.prototype,p.toStringTag,c("c","Set"))},{18:18,21:21,22:22,43:43,46:46,53:53,58:58,61:61,62:62,64:64,69:69}],64:[function(e,t,n){"use strict";t.exports=e(65)()?Symbol:e(67)},{65:65,67:67}],65:[function(e,t,n){"use strict";var r={object:!0,symbol:!0};t.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!r[typeof Symbol.iterator]&&(!!r[typeof Symbol.toPrimitive]&&!!r[typeof Symbol.toStringTag])}},{}],66:[function(e,t,n){"use strict";t.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))}},{}],67:[function(e,t,n){"use strict";var r,i,o,a,s=e(18),u=e(68),f=Object.create,c=Object.defineProperties,l=Object.defineProperty,p=Object.prototype,d=f(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),a=!0}catch(e){}}var h=function(){var e=f(null);return function(t){for(var n,r,i=0;e[t+(i||"")];)++i;return t+=i||"",e[t]=!0,n="@@"+t,l(p,n,s.gs(null,function(e){r||(r=!0,l(this,n,s(e)),r=!1)})),n}}();o=function(e){if(this instanceof o)throw new TypeError("TypeError: Symbol is not a constructor");return i(e)},t.exports=i=function e(t){var n;if(this instanceof e)throw new TypeError("TypeError: Symbol is not a constructor");return a?r(t):(n=f(o.prototype),t=void 0===t?"":String(t),c(n,{__description__:s("",t),__name__:s("",h(t))}))},c(i,{for:s(function(e){return d[e]?d[e]:d[e]=i(String(e))}),keyFor:s(function(e){var t;u(e);for(t in d)if(d[t]===e)return t}),hasInstance:s("",r&&r.hasInstance||i("hasInstance")),isConcatSpreadable:s("",r&&r.isConcatSpreadable||i("isConcatSpreadable")),iterator:s("",r&&r.iterator||i("iterator")),match:s("",r&&r.match||i("match")),replace:s("",r&&r.replace||i("replace")),search:s("",r&&r.search||i("search")),species:s("",r&&r.species||i("species")),split:s("",r&&r.split||i("split")),toPrimitive:s("",r&&r.toPrimitive||i("toPrimitive")),toStringTag:s("",r&&r.toStringTag||i("toStringTag")),unscopables:s("",r&&r.unscopables||i("unscopables"))}),c(o.prototype,{constructor:s(i),toString:s("",function(){return this.__name__})}),c(i.prototype,{toString:s(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:s(function(){return u(this)})}),l(i.prototype,i.toPrimitive,s("",function(){var e=u(this);return"symbol"==typeof e?e:e.toString()})),l(i.prototype,i.toStringTag,s("c","Symbol")),l(o.prototype,i.toStringTag,s("c",i.prototype[i.toStringTag])),l(o.prototype,i.toPrimitive,s("c",i.prototype[i.toPrimitive]))},{18:18,68:68}],68:[function(e,t,n){"use strict";var r=e(66);t.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},{66:66}],69:[function(e,t,n){"use strict";var r,i,o,a,s,u,f,c=e(18),l=e(46),p=Function.prototype.apply,d=Function.prototype.call,h=Object.create,m=Object.defineProperty,v=Object.defineProperties,g=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var n;return l(t),g.call(this,"__ee__")?n=this.__ee__:(n=b.value=h(null),m(this,"__ee__",b),b.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},i=function(e,t){var n,i;return l(t),i=this,r.call(this,e,n=function(){o.call(i,e,n),p.call(t,this,arguments)}),n.__eeOnceListener__=t,this},o=function(e,t){var n,r,i,o;if(l(t),!g.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if(r=n[e],"object"==typeof r)for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},a=function(e){var t,n,r,i,o;if(g.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)p.call(r,this,o)}else switch(arguments.length){case 1:d.call(i,this);break;case 2:d.call(i,this,arguments[1]);break;case 3:d.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];p.call(i,this,o)}},s={on:r,once:i,off:o,emit:a},u={on:c(r),once:c(i),off:c(o),emit:c(a)},f=v({},u),t.exports=n=function(e){return null==e?h(f):v(Object(e),u)},n.methods=s},{18:18,46:46}],70:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,u,f;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),f=n.slice(),r=f.length,u=0;u<r;u++)f[u].apply(this,o);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],71:[function(e,t,n){function r(e){return e[0]<e[1]?e:[e[1],e[0]]}function i(e,t,n,r){return e[0]=t[0]+r*n[0],e[1]=t[1]+r*n[1],e[2]=t[2]+r*n[2],e}function o(e,t){function n(e){return"index"in e||(e.index=T++,newPositions.push([e[0],e[1],e[2]])),e.index}originalPoints=[],faces=[],O=[];for(var o=0;o<t.length;++o){var a=t[o],f=[];faces[o]={};for(var c=0;c<a.length;++c){var l,p=a[c];if("undefined"==typeof originalPoints[p]){var d=e[p],h=s.fromValues(d[0],d[1],d[2]);l={point:h,faces:[],edges:new u},originalPoints[p]=l}else l=originalPoints[p];l.faces.push(faces[o]),f.push(l)}faces[o].points=f;for(var m=s.fromValues(0,0,0),v=0;v<faces[o].points.length;++v){var d=faces[o].points[v].point;s.add(m,d,m)}s.scale(m,m,1/faces[o].points.length),faces[o].facePoint=m;for(var g=[],b=0;b<a.length;++b){var y;3==a.length?0==b?y=[a[0],a[1]]:1==b?y=[a[1],a[2]]:2==b&&(y=[a[2],a[0]]):0==b?y=[a[0],a[1]]:1==b?y=[a[1],a[2]]:2==b?y=[a[2],a[3]]:3==b&&(y=[a[3],a[0]]),y=r(y);var x;"undefined"==typeof O[y]?(x={points:[originalPoints[y[0]],originalPoints[y[1]]],faces:[]},O[y]=x):x=O[y],x.faces.push(faces[o]),x.points[0].edges.add(x),x.points[1].edges.add(x),g.push(x)}faces[o].edges=g}for(key in O){for(var y=O[key],m=s.fromValues(0,0,0),_=0,v=0;v<y.faces.length;++v){var w=y.faces[v].facePoint;s.add(m,w,m),++_}for(var v=0;v<y.points.length;++v){var S=y.points[v].point;s.add(m,S,m),++_}s.scale(m,m,1/_),y.edgePoint=m,_=0;for(var A=s.fromValues(0,0,0),v=0;v<y.points.length;++v){var S=y.points[v].point;s.add(A,S,A),++_}s.scale(A,A,1/_),y.midPoint=A}for(var v=0;v<e.length;++v){for(var k=originalPoints[v],E=k.faces.length,j=s.fromValues(0,0,0),c=0;c<k.faces.length;++c){var w=k.faces[c].facePoint;s.add(j,j,w)}for(var O=Array.from(k.edges),c=0;c<O.length;c++){var y=O[c];i(j,j,y.midPoint,2)}s.scale(j,j,1/E),i(j,j,k.point,E-3),s.scale(j,j,1/E),k.newPoint=j}newPositions=[],newCells=[];for(var T=0,D=0;D<faces.length;++D)for(var M=faces[D],C=0;C<M.points.length;++C){var k=M.points[C],P=k.newPoint,z=M.edges[(C+0)%M.edges.length].edgePoint,L=M.facePoint,F=M.edges[(C+M.edges.length-1)%M.edges.length].edgePoint,I=n(P),B=n(z),R=n(L),N=n(F);newCells.push([N,I,B,R])}return{positions:newPositions,cells:newCells}}function a(e,t,n,r){if(n<1)throw new Error("`numSubdivisions` must be a positive number!");"undefined"==typeof r&&(r=!0);for(var i={positions:e,cells:t},a=0;a<n;++a)i=o(i.positions,i.cells);return r&&(i.cells=f(i.cells)),i}var s=e(130),u=e(59),f=e(115);t.exports=a},{115:115,130:130,59:59}],72:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],f=t[7],c=t[8];return e[0]=a*c-s*f,e[1]=i*f-r*c,e[2]=r*s-i*a,e[3]=s*u-o*c,e[4]=n*c-i*u,e[5]=i*o-n*s,e[6]=o*f-a*u,e[7]=r*u-n*f,e[8]=n*a-r*o,e}t.exports=r},{}],73:[function(e,t,n){function r(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}t.exports=r},{}],74:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}t.exports=r},{}],75:[function(e,t,n){function r(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}t.exports=r},{}],76:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],f=e[8];return t*(f*o-a*u)+n*(a*s-f*i)+r*(u*i-o*s)}t.exports=r},{}],77:[function(e,t,n){function r(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8])}t.exports=r},{}],78:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}t.exports=r},{}],79:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}t.exports=r},{}],80:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,f=n*a,c=r*a,l=r*s,p=i*a,d=i*s,h=i*u,m=o*a,v=o*s,g=o*u;return e[0]=1-l-h,e[3]=c-g,e[6]=p+v,e[1]=c+g,e[4]=1-f-h,e[7]=d-m,e[2]=p-v,e[5]=d+m,e[8]=1-f-l,e}t.exports=r},{}],81:[function(e,t,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}t.exports=r},{}],82:[function(e,t,n){t.exports={adjoint:e(72),clone:e(73),copy:e(74),create:e(75),determinant:e(76),frob:e(77),fromMat2:e(78),fromMat4:e(79),fromQuat:e(80),identity:e(81),invert:e(83),multiply:e(84),normalFromMat4:e(85),rotate:e(86),scale:e(87),str:e(88),translate:e(89),transpose:e(90)}},{72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90}],83:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],f=t[7],c=t[8],l=c*a-s*f,p=-c*o+s*u,d=f*o-a*u,h=n*l+r*p+i*d;return h?(h=1/h,e[0]=l*h,e[1]=(-c*r+i*f)*h,e[2]=(s*r-i*a)*h,e[3]=p*h,e[4]=(c*n-i*u)*h,e[5]=(-s*n+i*o)*h,e[6]=d*h,e[7]=(-f*n+r*u)*h,e[8]=(a*n-r*o)*h,e):null}t.exports=r},{}],84:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],f=t[6],c=t[7],l=t[8],p=n[0],d=n[1],h=n[2],m=n[3],v=n[4],g=n[5],b=n[6],y=n[7],x=n[8];return e[0]=p*r+d*a+h*f,e[1]=p*i+d*s+h*c,e[2]=p*o+d*u+h*l,e[3]=m*r+v*a+g*f,e[4]=m*i+v*s+g*c,e[5]=m*o+v*u+g*l,e[6]=b*r+y*a+x*f,e[7]=b*i+y*s+x*c,e[8]=b*o+y*u+x*l,e}t.exports=r},{}],85:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],f=t[7],c=t[8],l=t[9],p=t[10],d=t[11],h=t[12],m=t[13],v=t[14],g=t[15],b=n*s-r*a,y=n*u-i*a,x=n*f-o*a,_=r*u-i*s,w=r*f-o*s,S=i*f-o*u,A=c*m-l*h,k=c*v-p*h,E=c*g-d*h,j=l*v-p*m,O=l*g-d*m,T=p*g-d*v,D=b*T-y*O+x*j+_*E-w*k+S*A;return D?(D=1/D,e[0]=(s*T-u*O+f*j)*D,e[1]=(u*E-a*T-f*k)*D,e[2]=(a*O-s*E+f*A)*D,e[3]=(i*O-r*T-o*j)*D,e[4]=(n*T-i*E+o*k)*D,e[5]=(r*E-n*O-o*A)*D,e[6]=(m*S-v*w+g*_)*D,e[7]=(v*x-h*S-g*y)*D,e[8]=(h*w-m*x+g*b)*D,e):null}t.exports=r},{}],86:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],f=t[6],c=t[7],l=t[8],p=Math.sin(n),d=Math.cos(n);return e[0]=d*r+p*a,e[1]=d*i+p*s,e[2]=d*o+p*u,e[3]=d*a-p*r,e[4]=d*s-p*i,e[5]=d*u-p*o,e[6]=f,e[7]=c,e[8]=l,e}t.exports=r},{}],87:[function(e,t,n){function r(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}t.exports=r},{}],88:[function(e,t,n){function r(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}t.exports=r},{}],89:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],f=t[6],c=t[7],l=t[8],p=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=p*r+d*a+f,e[7]=p*i+d*s+c,e[8]=p*o+d*u+l,e}t.exports=r},{}],90:[function(e,t,n){function r(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}t.exports=r},{}],91:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],f=t[7],c=t[8],l=t[9],p=t[10],d=t[11],h=t[12],m=t[13],v=t[14],g=t[15];return e[0]=s*(p*g-d*v)-l*(u*g-f*v)+m*(u*d-f*p),e[1]=-(r*(p*g-d*v)-l*(i*g-o*v)+m*(i*d-o*p)),e[2]=r*(u*g-f*v)-s*(i*g-o*v)+m*(i*f-o*u),e[3]=-(r*(u*d-f*p)-s*(i*d-o*p)+l*(i*f-o*u)),e[4]=-(a*(p*g-d*v)-c*(u*g-f*v)+h*(u*d-f*p)),e[5]=n*(p*g-d*v)-c*(i*g-o*v)+h*(i*d-o*p),e[6]=-(n*(u*g-f*v)-a*(i*g-o*v)+h*(i*f-o*u)),e[7]=n*(u*d-f*p)-a*(i*d-o*p)+c*(i*f-o*u),e[8]=a*(l*g-d*m)-c*(s*g-f*m)+h*(s*d-f*l),e[9]=-(n*(l*g-d*m)-c*(r*g-o*m)+h*(r*d-o*l)),e[10]=n*(s*g-f*m)-a*(r*g-o*m)+h*(r*f-o*s),e[11]=-(n*(s*d-f*l)-a*(r*d-o*l)+c*(r*f-o*s)),e[12]=-(a*(l*v-p*m)-c*(s*v-u*m)+h*(s*p-u*l)),e[13]=n*(l*v-p*m)-c*(r*v-i*m)+h*(r*p-i*l),e[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+h*(r*u-i*s)),e[15]=n*(s*p-u*l)-a*(r*p-i*l)+c*(r*u-i*s),e}t.exports=r},{}],92:[function(e,t,n){function r(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=r},{}],93:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],94:[function(e,t,n){function r(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],95:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],f=e[8],c=e[9],l=e[10],p=e[11],d=e[12],h=e[13],m=e[14],v=e[15],g=t*a-n*o,b=t*s-r*o,y=t*u-i*o,x=n*s-r*a,_=n*u-i*a,w=r*u-i*s,S=f*h-c*d,A=f*m-l*d,k=f*v-p*d,E=c*m-l*h,j=c*v-p*h,O=l*v-p*m;
return g*O-b*j+y*E+x*k-_*A+w*S}t.exports=r},{}],96:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,f=n*a,c=r*a,l=r*s,p=i*a,d=i*s,h=i*u,m=o*a,v=o*s,g=o*u;return e[0]=1-l-h,e[1]=c+g,e[2]=p-v,e[3]=0,e[4]=c-g,e[5]=1-f-h,e[6]=d+m,e[7]=0,e[8]=p+v,e[9]=d-m,e[10]=1-f-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],97:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,f=o+o,c=r*s,l=r*u,p=r*f,d=i*u,h=i*f,m=o*f,v=a*s,g=a*u,b=a*f;return e[0]=1-(d+m),e[1]=l+b,e[2]=p-g,e[3]=0,e[4]=l-b,e[5]=1-(c+m),e[6]=h+v,e[7]=0,e[8]=p+g,e[9]=h-v,e[10]=1-(c+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}t.exports=r},{}],98:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),f=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*f,e[15]=0,e}t.exports=r},{}],99:[function(e,t,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],100:[function(e,t,n){t.exports={create:e(94),clone:e(92),copy:e(93),identity:e(99),transpose:e(114),invert:e(101),adjoint:e(91),determinant:e(95),multiply:e(103),translate:e(113),scale:e(111),rotate:e(107),rotateX:e(108),rotateY:e(109),rotateZ:e(110),fromRotationTranslation:e(97),fromQuat:e(96),frustum:e(98),perspective:e(105),perspectiveFromFieldOfView:e(106),ortho:e(104),lookAt:e(102),str:e(112)}},{101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99}],101:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],f=t[7],c=t[8],l=t[9],p=t[10],d=t[11],h=t[12],m=t[13],v=t[14],g=t[15],b=n*s-r*a,y=n*u-i*a,x=n*f-o*a,_=r*u-i*s,w=r*f-o*s,S=i*f-o*u,A=c*m-l*h,k=c*v-p*h,E=c*g-d*h,j=l*v-p*m,O=l*g-d*m,T=p*g-d*v,D=b*T-y*O+x*j+_*E-w*k+S*A;return D?(D=1/D,e[0]=(s*T-u*O+f*j)*D,e[1]=(i*O-r*T-o*j)*D,e[2]=(m*S-v*w+g*_)*D,e[3]=(p*w-l*S-d*_)*D,e[4]=(u*E-a*T-f*k)*D,e[5]=(n*T-i*E+o*k)*D,e[6]=(v*x-h*S-g*y)*D,e[7]=(c*S-p*x+d*y)*D,e[8]=(a*O-s*E+f*A)*D,e[9]=(r*E-n*O-o*A)*D,e[10]=(h*w-m*x+g*b)*D,e[11]=(l*x-c*w-d*b)*D,e[12]=(s*k-a*j-u*A)*D,e[13]=(n*j-r*k+i*A)*D,e[14]=(m*y-h*_-v*b)*D,e[15]=(c*_-l*y+p*b)*D,e):null}t.exports=r},{}],102:[function(e,t,n){function r(e,t,n,r){var o,a,s,u,f,c,l,p,d,h,m=t[0],v=t[1],g=t[2],b=r[0],y=r[1],x=r[2],_=n[0],w=n[1],S=n[2];return Math.abs(m-_)<1e-6&&Math.abs(v-w)<1e-6&&Math.abs(g-S)<1e-6?i(e):(l=m-_,p=v-w,d=g-S,h=1/Math.sqrt(l*l+p*p+d*d),l*=h,p*=h,d*=h,o=y*d-x*p,a=x*l-b*d,s=b*p-y*l,h=Math.sqrt(o*o+a*a+s*s),h?(h=1/h,o*=h,a*=h,s*=h):(o=0,a=0,s=0),u=p*s-d*a,f=d*o-l*s,c=l*a-p*o,h=Math.sqrt(u*u+f*f+c*c),h?(h=1/h,u*=h,f*=h,c*=h):(u=0,f=0,c=0),e[0]=o,e[1]=u,e[2]=l,e[3]=0,e[4]=a,e[5]=f,e[6]=p,e[7]=0,e[8]=s,e[9]=c,e[10]=d,e[11]=0,e[12]=-(o*m+a*v+s*g),e[13]=-(u*m+f*v+c*g),e[14]=-(l*m+p*v+d*g),e[15]=1,e)}var i=e(99);t.exports=r},{99:99}],103:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],f=t[6],c=t[7],l=t[8],p=t[9],d=t[10],h=t[11],m=t[12],v=t[13],g=t[14],b=t[15],y=n[0],x=n[1],_=n[2],w=n[3];return e[0]=y*r+x*s+_*l+w*m,e[1]=y*i+x*u+_*p+w*v,e[2]=y*o+x*f+_*d+w*g,e[3]=y*a+x*c+_*h+w*b,y=n[4],x=n[5],_=n[6],w=n[7],e[4]=y*r+x*s+_*l+w*m,e[5]=y*i+x*u+_*p+w*v,e[6]=y*o+x*f+_*d+w*g,e[7]=y*a+x*c+_*h+w*b,y=n[8],x=n[9],_=n[10],w=n[11],e[8]=y*r+x*s+_*l+w*m,e[9]=y*i+x*u+_*p+w*v,e[10]=y*o+x*f+_*d+w*g,e[11]=y*a+x*c+_*h+w*b,y=n[12],x=n[13],_=n[14],w=n[15],e[12]=y*r+x*s+_*l+w*m,e[13]=y*i+x*u+_*p+w*v,e[14]=y*o+x*f+_*d+w*g,e[15]=y*a+x*c+_*h+w*b,e}t.exports=r},{}],104:[function(e,t,n){function r(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),f=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*f,e[15]=1,e}t.exports=r},{}],105:[function(e,t,n){function r(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}t.exports=r},{}],106:[function(e,t,n){function r(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),f=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-((a-s)*u*.5),e[9]=(i-o)*f*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}t.exports=r},{}],107:[function(e,t,n){function r(e,t,n,r){var i,o,a,s,u,f,c,l,p,d,h,m,v,g,b,y,x,_,w,S,A,k,E,j,O=r[0],T=r[1],D=r[2],M=Math.sqrt(O*O+T*T+D*D);return Math.abs(M)<1e-6?null:(M=1/M,O*=M,T*=M,D*=M,i=Math.sin(n),o=Math.cos(n),a=1-o,s=t[0],u=t[1],f=t[2],c=t[3],l=t[4],p=t[5],d=t[6],h=t[7],m=t[8],v=t[9],g=t[10],b=t[11],y=O*O*a+o,x=T*O*a+D*i,_=D*O*a-T*i,w=O*T*a-D*i,S=T*T*a+o,A=D*T*a+O*i,k=O*D*a+T*i,E=T*D*a-O*i,j=D*D*a+o,e[0]=s*y+l*x+m*_,e[1]=u*y+p*x+v*_,e[2]=f*y+d*x+g*_,e[3]=c*y+h*x+b*_,e[4]=s*w+l*S+m*A,e[5]=u*w+p*S+v*A,e[6]=f*w+d*S+g*A,e[7]=c*w+h*S+b*A,e[8]=s*k+l*E+m*j,e[9]=u*k+p*E+v*j,e[10]=f*k+d*E+g*j,e[11]=c*k+h*E+b*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}t.exports=r},{}],108:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],f=t[8],c=t[9],l=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+f*r,e[5]=a*i+c*r,e[6]=s*i+l*r,e[7]=u*i+p*r,e[8]=f*i-o*r,e[9]=c*i-a*r,e[10]=l*i-s*r,e[11]=p*i-u*r,e}t.exports=r},{}],109:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],f=t[8],c=t[9],l=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-f*r,e[1]=a*i-c*r,e[2]=s*i-l*r,e[3]=u*i-p*r,e[8]=o*r+f*i,e[9]=a*r+c*i,e[10]=s*r+l*i,e[11]=u*r+p*i,e}t.exports=r},{}],110:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],f=t[4],c=t[5],l=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+f*r,e[1]=a*i+c*r,e[2]=s*i+l*r,e[3]=u*i+p*r,e[4]=f*i-o*r,e[5]=c*i-a*r,e[6]=l*i-s*r,e[7]=p*i-u*r,e}t.exports=r},{}],111:[function(e,t,n){function r(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],112:[function(e,t,n){function r(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}t.exports=r},{}],113:[function(e,t,n){function r(e,t,n){var r,i,o,a,s,u,f,c,l,p,d,h,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],f=t[6],c=t[7],l=t[8],p=t[9],d=t[10],h=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=f,e[7]=c,e[8]=l,e[9]=p,e[10]=d,e[11]=h,e[12]=r*m+s*v+l*g+t[12],e[13]=i*m+u*v+p*g+t[13],e[14]=o*m+f*v+d*g+t[14],e[15]=a*m+c*v+h*g+t[15]),e}t.exports=r},{}],114:[function(e,t,n){function r(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}t.exports=r},{}],115:[function(e,t,n){function r(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push([r[0],r[1],r[2]]),t.push([r[0],r[2],r[3]])}return t}t.exports=r},{}],116:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e}t.exports=r},{}],117:[function(e,t,n){t.exports=e(152)},{152:152}],118:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}t.exports=r},{}],119:[function(e,t,n){function r(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}t.exports=r},{}],120:[function(e,t,n){function r(e,t){var n=i(e[0],e[1],e[2]),r=i(t[0],t[1],t[2]);o(n,n),o(r,r);var s=a(n,r);return s>1?0:Math.acos(s)}t.exports=r;var i=e(129),o=e(138),a=e(127)},{127:127,129:129,138:138}],121:[function(e,t,n){function r(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}t.exports=r},{}],122:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}t.exports=r},{}],123:[function(e,t,n){function r(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}t.exports=r},{}],124:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}t.exports=r},{}],125:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}t.exports=r},{}],126:[function(e,t,n){function r(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}t.exports=r},{}],127:[function(e,t,n){function r(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}t.exports=r},{}],128:[function(e,t,n){function r(e,t,n,r,o,a){var s,u;for(t||(t=3),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,s=n;s<u;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],o(i,i,a),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2];return e}t.exports=r;var i=e(123)()},{123:123}],129:[function(e,t,n){function r(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}t.exports=r},{}],130:[function(e,t,n){t.exports={create:e(123),clone:e(121),angle:e(120),fromValues:e(129),copy:e(122),set:e(145),add:e(119),subtract:e(148),multiply:e(136),divide:e(126),min:e(135),max:e(134),scale:e(143),scaleAndAdd:e(144),distance:e(125),squaredDistance:e(146),length:e(132),squaredLength:e(147),negate:e(137),inverse:e(131),normalize:e(138),dot:e(127),cross:e(124),lerp:e(133),random:e(139),transformMat4:e(150),transformMat3:e(149),transformQuat:e(151),rotateX:e(140),rotateY:e(141),rotateZ:e(142),forEach:e(128)}},{119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,127:127,128:128,129:129,131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151}],131:[function(e,t,n){function r(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}t.exports=r},{}],132:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}t.exports=r},{}],133:[function(e,t,n){function r(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}t.exports=r},{}],134:[function(e,t,n){function r(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}t.exports=r},{}],135:[function(e,t,n){function r(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}t.exports=r},{}],136:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}t.exports=r},{}],137:[function(e,t,n){function r(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}t.exports=r},{}],138:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}t.exports=r},{}],139:[function(e,t,n){function r(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}t.exports=r},{}],140:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],141:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],142:[function(e,t,n){function r(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}t.exports=r},{}],143:[function(e,t,n){function r(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}t.exports=r},{}],144:[function(e,t,n){function r(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}t.exports=r},{}],145:[function(e,t,n){function r(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}t.exports=r},{}],146:[function(e,t,n){function r(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}t.exports=r},{}],147:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}t.exports=r},{}],148:[function(e,t,n){function r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}t.exports=r},{}],149:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}t.exports=r},{}],150:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}t.exports=r},{}],151:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],f=n[3],c=f*r+s*o-u*i,l=f*i+u*r-a*o,p=f*o+a*i-s*r,d=-a*r-s*i-u*o;return e[0]=c*f+d*-a+l*-u-p*-s,e[1]=l*f+d*-s+p*-a-c*-u,e[2]=p*f+d*-u+c*-s-l*-a,e}t.exports=r},{}],152:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e}t.exports=r},{}],153:[function(e,t,n){function r(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}t.exports=r},{}],154:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}t.exports=r},{}],155:[function(e,t,n){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],156:[function(e,t,n){function r(e,t,n){return e*(1-n)+t*n}t.exports=r},{}],157:[function(e,t,n){function r(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,o=e.clientY||0,a=i(t);return n[0]=r-a.left,n[1]=o-a.top,n}function i(e){return e===window||e===document||e===document.body?o:e.getBoundingClientRect()}var o={left:0,top:0};t.exports=r},{}],158:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e&&(n=!!t,t=e,e=window);var r=i("ex",e),o=function(e){n&&e.preventDefault();var i=e.deltaX||0,o=e.deltaY||0,a=e.deltaZ||0,s=e.deltaMode,u=1;switch(s){case 1:u=r;break;case 2:u=window.innerHeight}if(i*=u,o*=u,a*=u,i||o||a)return t(i,o,a,e)};return e.addEventListener("wheel",o),o}var i=e(176);t.exports=r},{176:176}],159:[function(e,t,n){function r(e){function t(e,t){var n=2*Math.PI;g[0]-=n*e*_.rotateSpeed,g[1]-=n*t*_.rotateSpeed}function n(e){g[2]+=e*_.zoomSpeed}function r(e){g[2]-=e*_.pinchSpeed}function h(){var e=_.up||l;u(y,e,l),f(x,y);var t=_.distance;c.subtract(b,_.position,_.target),c.transformQuat(b,b,y);var n=Math.atan2(b[0],b[2]),r=Math.atan2(Math.sqrt(b[0]*b[0]+b[2]*b[2]),b[1]);n+=g[0],r+=g[1],n=a(n,_.thetaBounds[0],_.thetaBounds[1]),r=a(r,_.phiBounds[0],_.phiBounds[1]),r=a(r,p,Math.PI-p),t+=g[2],t=a(t,_.distanceBounds[0],_.distanceBounds[1]);var o=Math.abs(t)<=p?p:t;b[0]=o*Math.sin(r)*Math.sin(n),b[1]=o*Math.cos(r),b[2]=o*Math.sin(r)*Math.cos(n),_.phi=r,_.theta=n,_.distance=t,c.transformQuat(b,b,x),c.add(_.position,_.target,b),i(_.direction,e,_.position,_.target);for(var s="number"==typeof _.damping?_.damping:1,d=0;d<g.length;d++)g[d]*=1-s}function m(e,t,n){e&&c.copy(e,_.position),t&&c.copy(t,_.direction),n&&c.copy(n,_.up)}function v(){var e=Math.max(p,_.distance);_.position[0]=e*Math.sin(_.phi)*Math.sin(_.theta),_.position[1]=e*Math.cos(_.phi),_.position[2]=e*Math.sin(_.phi)*Math.cos(_.theta),c.add(_.position,_.position,_.target)}e=e||{};var g=[0,0,0],b=[0,0,0],y=[0,0,0,1],x=y.slice(),_={update:h,copyInto:m,position:e.position?e.position.slice():[0,0,1],direction:[0,0,-1],up:e.up?e.up.slice():[0,1,0],target:e.target?e.target.slice():[0,0,0],phi:o(e.phi,Math.PI/2),theta:e.theta||0,distance:o(e.distance,1),damping:o(e.damping,.25),rotateSpeed:o(e.rotateSpeed,.28),zoomSpeed:o(e.zoomSpeed,.0075),pinchSpeed:o(e.pinchSpeed,.0075),pinch:e.pinching!==!1,zoom:e.zoom!==!1,rotate:e.rotate!==!1,phiBounds:e.phiBounds||[0,Math.PI],thetaBounds:e.thetaBounds||[-(1/0),1/0],distanceBounds:e.distanceBounds||[0,1/0]};"number"!=typeof e.distance&&(c.subtract(d,_.position,_.target),_.distance=c.length(d)),v();const w=s({parent:e.parent||window,element:e.element,rotate:e.rotate!==!1?t:null,zoom:e.zoom!==!1?n:null,pinch:e.pinch!==!1?r:null});return _.enable=w.enable,_.disable=w.disable,_}function i(e,t,n,r){c.copy(e,r),c.subtract(e,e,n),c.normalize(e,e)}var o=e(19),a=e(16),s=e(160),u=e(167),f=e(116),c={length:e(132),add:e(119),subtract:e(148),transformQuat:e(151),copy:e(122),normalize:e(138),cross:e(124)},l=[0,1,0],p=Math.pow(2,-23),d=[0,0,0];t.exports=r},{116:116,119:119,122:122,124:124,132:132,138:138,148:148,151:151,16:16,160:160,167:167,19:19}],160:[function(e,t,n){function r(e){function t(){O||(O=!0,k&&(b=i(y,function(e,t){k(t)},!0)),E&&(x.addEventListener("mousedown",p,!1),x.addEventListener("mousemove",h,!1),x.addEventListener("mouseup",d,!1)),(E||j)&&(g=a(y),y.addEventListener("touchstart",r,!1),E&&(y.addEventListener("touchmove",s,!1),g.on("place",u),g.on("lift",f)),j&&g.on("change",l)))}function n(){O&&(O=!1,b&&y.removeEventListener("wheel",b),g&&(g.disable(),y.removeEventListener("touchstart",r,!1),E&&y.removeEventListener("touchmove",s,!1)),E&&(x.removeEventListener("mousedown",p,!1),x.removeEventListener("mousemove",h,!1),x.removeEventListener("mouseup",d,!1)))}function r(e){e.preventDefault()}function s(e){if(w&&!c())for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t],r=g.indexOfTouch(n),i=j?r!==-1:0===r;if(i){h(n);break}}}function u(e,t){if(w=!c()){var n=t||e;p(n)}}function f(e,t){w=!c(),w&&t&&o(t,y,_)}function c(){return g.pinching&&j}function l(e,t){j(e-t)}function p(e){o(e,y,_),m(_)&&(w=!0)}function d(){w=!1}function h(e){var t=o(e,y,S);if(g&&c())return void(_=t);if(w){var n=v(A),r=(t[0]-_[0])/n[0],i=(t[1]-_[1])/n[1];E(r,i),_[0]=t[0],_[1]=t[1]}}function m(e){if(y===window||y===document||y===document.body)return!0;var t=y.getBoundingClientRect();return e[0]>=0&&e[1]>=0&&e[0]<t.width&&e[1]<t.height}function v(e){var t=y;return t!==window&&t!==document&&t!==document.body||(t=document.documentElement),e[0]=t.clientWidth,e[1]=t.clientHeight,e}var g,b,y=e.element||window,x=e.parent||y,_=[0,0],w=!1,S=[0,0],A=[0,0],k=e.zoom,E=e.rotate,j=e.pinch,O=!1;return t(),{enable:t,disable:n}}var i=e(158),o=e(157),a=e(177);t.exports=r},{157:157,158:158,177:177}],161:[function(e,t,n){t.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],162:[function(e,t,n){t.exports=e(165)},{165:165}],163:[function(e,t,n){var r=e(166),i=e(168),o=e(13),a=e(14),s=e(164),u=e(12),f=e(119),c=e(103),l=e(101),p=e(99),d=e(145);t.exports=function(e){function t(){c(y.projView,y.projection,y.view);var e=l(y.invProjView,y.projView);if(!e)throw new Error("camera projection * view is non-invertible")}function n(e){return s(y.direction,y.up,y.position,e),y}function h(){return d(y.position,0,0,0),d(y.direction,0,0,-1),d(y.up,0,1,0),p(y.view),p(y.projection),p(y.projView),p(y.invProjView),y}function m(e){return f(y.position,y.position,e),y}function v(e){var t=new i;return u(t.origin,t.direction,e,y.viewport,y.invProjView),t}function g(e){return o([],e,y.viewport,y.projView)}function b(e){return a([],e,y.viewport,y.invProjView)}e=e||{};var y={projection:p([]),view:p([]),position:e.position||[0,0,0],direction:e.direction||[0,0,-1],up:e.up||[0,1,0],viewport:e.viewport||[-1,-1,1,1],projView:p([]),invProjView:p([])};return r(y,{translate:m,identity:h,lookAt:n,createPickingRay:v,update:t,project:g,unproject:b})}},{101:101,103:103,119:119,12:12,13:13,14:14,145:145,164:164,166:166,168:168,99:99}],164:[function(e,t,n){var r=e(124),i=e(148),o=e(138),a=e(122),s=e(127),u=e(143),f=[0,0,0],c=1e-9;t.exports=function(e,t,n,l){i(f,l,n),o(f,f);var p=0===f[0]&&0===f[1]&&0===f[2];if(!p){var d=s(f,t);Math.abs(d-1)<c?u(t,e,-1):Math.abs(d+1)<c&&a(t,e),a(e,f),r(f,e,t),o(f,f),r(t,f,e),o(t,t)}}},{122:122,124:124,127:127,138:138,143:143,148:148}],165:[function(e,t,n){var r=e(163),i=e(166),o=e(19),a=e(105),s=e(102),u=e(119);t.exports=function(e){function t(){var e=n.viewport[2]/n.viewport[3];return a(n.projection,n.fov,e,Math.abs(n.near),Math.abs(n.far)),u(f,n.position,n.direction),s(n.view,n.position,f,n.up),c(),n}e=e||{};var n=r(e);n.fov=o(e.fov,Math.PI/4),n.near=o(e.near,1),n.far=o(e.far,100);var f=[0,0,0],c=n.update;return t(),i(n,{update:t})}},{102:102,105:105,119:119,163:163,166:166,19:19}],166:[function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var n,i,o=r(e),a=1;a<arguments.length;a++){n=arguments[a],i=Object.keys(Object(n));for(var s=0;s<i.length;s++)o[i[s]]=n[i[s]]}return o}},{}],167:[function(e,t,n){function r(e,t,n){var r=i(t,n)+1;return r<f?(r=0,Math.abs(t[0])>Math.abs(t[2])?o(u,-t[1],t[0],0):o(u,0,-t[2],t[1])):s(u,t,n),e[0]=u[0],e[1]=u[1],e[2]=u[2],e[3]=r,a(e,e),e}var i=e(127),o=e(145),a=e(117),s=e(124),u=[0,0,0],f=1e-6;t.exports=r},{117:117,124:124,127:127,145:145}],168:[function(e,t,n){function r(e,t){this.origin=e||[0,0,0],this.direction=t||[0,0,-1]}var i=e(172),o=e(170),a=e(171),s=e(169),u=e(122),f=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];t.exports=r,r.prototype.set=function(e,t){this.origin=e,this.direction=t},r.prototype.copy=function(e){u(this.origin,e.origin),u(this.direction,e.direction)},r.prototype.clone=function(){var e=new r;return e.copy(this),e},r.prototype.intersectsSphere=function(e,t){return a(c,this.origin,this.direction,e,t)},r.prototype.intersectsPlane=function(e,t){return o(c,this.origin,this.direction,e,t)},r.prototype.intersectsTriangle=function(e){return i(c,this.origin,this.direction,e)},r.prototype.intersectsBox=function(e){return s(c,this.origin,this.direction,e)},r.prototype.intersectsTriangleCell=function(e,t){var n=e[0],r=e[1],i=e[2];return f[0]=t[n],f[1]=t[r],f[2]=t[i],this.intersectsTriangle(f)}},{122:122,169:169,170:170,171:171,172:172}],169:[function(e,t,n){function r(e,t,n,r){var o=i(t,n,r);if(o===1/0)e=null;else{e=e||[];for(var a=0;a<t.length;a++)e[a]=t[a]+n[a]*o}return e}function i(e,t,n){for(var r=e.length,i=-(1/0),o=+(1/0),a=0;a<r;a++){var s=(n[0][a]-e[a])/t[a],u=(n[1][a]-e[a])/t[a];if(s>u){var f=s;s=u,u=f}if(u<i||s>o)return 1/0;s>i&&(i=s),u<o&&(o=u)}return i>o?1/0:i}t.exports=r,t.exports.distance=i},{}],170:[function(e,t,n){function r(e,t,n,r,f){var c=i(n,r);if(0!==c){var l=-(i(t,r)+f)/c;return l<0?null:(a(u,n,l),o(e,t,u))}return i(r,t)+f===0?s(e,t):null}var i=e(127),o=e(119),a=e(143),s=e(122);t.exports=r;var u=[0,0,0]},{119:119,122:122,127:127,143:143}],171:[function(e,t,n){function r(e,t,n,r,l){a(c,r,t);var p=o(n,c);if(p<0)return null;s(c,t,n,p);var d=i(r,c),h=l*l;return d>h?null:(u(e,n,p-Math.sqrt(h-d)),f(e,e,t))}var i=e(146),o=e(127),a=e(148),s=e(144),u=e(143),f=e(119),c=[0,0,0];t.exports=r},{119:119,127:127,143:143,144:144,146:146,148:148}],172:[function(e,t,n){function r(e,t,n,r){a(u,r[1],r[0]),a(f,r[2],r[0]),i(l,n,f);var d=o(u,l);if(d<s)return null;a(c,t,r[0]);var h=o(c,l);if(h<0||h>d)return null;i(p,c,u);var m=o(n,p);if(m<0||h+m>d)return null;var v=o(f,p)/d;return e[0]=t[0]+v*n[0],e[1]=t[1]+v*n[1],e[2]=t[2]+v*n[2],e}var i=e(124),o=e(127),a=e(148),s=1e-6,u=[0,0,0],f=[0,0,0],c=[0,0,0],l=[0,0,0],p=[0,0,0];t.exports=r},{124:124,127:127,148:148}],173:[function(e,t,n){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.createREGL=r()}(this,function(){"use strict";function e(e){return"undefined"!=typeof btoa?btoa(e):"base64:"+e}function t(e){var t=new Error("(regl) "+e);throw console.error(t),t}function n(e,n){e||t(n)}function r(e){return e?": "+e:""}function i(e,n,i){e in n||t("unknown parameter ("+e+")"+r(i)+". possible values: "+Object.keys(n).join())}function o(e,n){Ke(e)||t("invalid parameter type"+r(n)+". must be a typed array")}function a(e,n,i){typeof e!==n&&t("invalid parameter type"+r(i)+". expected "+n+", got "+typeof e)}function s(e,n){e>=0&&(0|e)===e||t("invalid parameter type, ("+e+")"+r(n)+". must be a nonnegative integer")}function u(e,n,i){n.indexOf(e)<0&&t("invalid value"+r(i)+". must be one of: "+n)}function f(e){Object.keys(e).forEach(function(e){et.indexOf(e)<0&&t('invalid regl constructor argument "'+e+'". must be one of '+et)})}function c(e,t){for(e+="";e.length<t;)e=" "+e;return e}function l(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function p(e,t){this.number=e,this.line=t,this.errors=[]}function d(e,t,n){this.file=e,this.line=t,this.message=n}function h(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function m(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function v(t,n){var r=t.split("\n"),i=1,o=0,a={unknown:new l,0:new l};a.unknown.name=a[0].name=n||h(),a.unknown.lines.push(new p(0,""));for(var s=0;s<r.length;++s){var u=r[s],f=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(u);if(f)switch(f[1]){case"line":var c=/(\d+)(\s+\d+)?/.exec(f[2]);c&&(i=0|c[1],c[2]&&(o=0|c[2],o in a||(a[o]=new l)));break;case"define":var d=/SHADER_NAME(_B64)?\s+(.*)$/.exec(f[2]);d&&(a[o].name=d[1]?e(d[2]):d[2])}a[o].lines.push(new p(i++,u))}return Object.keys(a).forEach(function(e){var t=a[e];t.lines.forEach(function(e){t.index[e.number]=e})}),a}function g(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);n?t.push(new d(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new d("unknown",0,e))}}),t}function b(e,t){t.forEach(function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}function y(e,t,r,i,o){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(t),s=i===e.FRAGMENT_SHADER?"fragment":"vertex";E(r,"string",s+" shader source must be a string",o);var u=v(r,o),f=g(a);b(u,f),Object.keys(u).forEach(function(e){function t(e,t){r.push(e),i.push(t||"")}var n=u[e];if(n.hasErrors){var r=[""],i=[""];t("file number "+e+": "+n.name+"\n","color:red;text-decoration:underline;font-weight:bold"),n.lines.forEach(function(e){if(e.errors.length>0){t(c(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),t(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var n=0;e.errors.forEach(function(r){var i=r.message,o=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(i);if(o){var a=o[1];switch(i=o[2],a){case"assign":a="="}n=Math.max(e.line.indexOf(a,n),0)}else n=0;t(c("| ",6)),t(c("^^^",n+3)+"\n","font-weight:bold"),t(c("| ",6)),t(i+"\n","font-weight:bold")}),t(c("| ",6)+"\n")}else t(c(e.number,4)+"|  "),t(e.line+"\n","color:red")}),"undefined"!=typeof document?(i[0]=r.join("%c"),console.log.apply(console,i)):console.log(r.join(""))}}),n.raise("Error compiling "+s+" shader, "+u[0].name)}}function x(e,t,r,i,o){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),s=v(r,o),u=v(i,o),f='Error linking program with vertex shader, "'+u[0].name+'", and fragment shader "'+s[0].name+'"';"undefined"!=typeof document?console.log("%c"+f+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+a),n.raise(f)}}function _(e){e._commandRef=h()}function w(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}_(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var s=e._attributeSet={};o(s,n.static),o(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function S(e,n){var r=m();t(e+" in command "+(n||h())+("unknown"===r?"":" called from "+r))}function A(e,t,n){e||S(t,n||h())}function k(e,t,n,i){e in t||S("unknown parameter ("+e+")"+r(n)+". possible values: "+Object.keys(t).join(),i||h())}function E(e,t,n,i){typeof e!==t&&S("invalid parameter type"+r(n)+". expected "+t+", got "+typeof e,i||h())}function j(e){e()}function O(e,t,n){e.texture?u(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):u(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}function T(e,t){return e===mt||e===ht||e===vt?2:e===gt?4:yt[e]*t}function D(e){return!(e&e-1||!e)}function M(e,t,r){var i,o=t.width,a=t.height,s=t.channels;n(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),e.wrapS===tt&&e.wrapT===tt||n(D(o)&&D(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&n(e.minFilter!==rt&&e.minFilter!==ot&&e.minFilter!==it&&e.minFilter!==at,"min filter requires mipmap"):(n(D(o)&&D(a),"texture must be a square power of 2 to support mipmapping"),n(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),t.type===dt&&(r.extensions.indexOf("oes_texture_float_linear")<0&&n(e.minFilter===nt&&e.magFilter===nt,"filter not supported, must enable oes_texture_float_linear"),n(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(i=0;i<16;++i)if(u[i]){var f=o>>i,c=a>>i;n(t.mipmask&1<<i,"missing mipmap data");var l=u[i];if(n(l.width===f&&l.height===c,"invalid shape for mip images"),n(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed);else if(l.data){var p=Math.ceil(T(l.type,s)*f/l.unpackAlignment)*l.unpackAlignment;n(l.data.byteLength===p*c,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else e.genMipmaps||n(0===(t.mipmask&1<<i),"extra mipmap data");t.compressed&&n(!e.genMipmaps,"mipmap generation for compressed images not supported")}function C(e,t,r,i){var o=e.width,a=e.height,s=e.channels;n(o>0&&o<=i.maxTextureSize&&a>0&&a<=i.maxTextureSize,"invalid texture shape"),n(o===a,"cube map must be square"),n(t.wrapS===tt&&t.wrapT===tt,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var f=r[u];n(f.width===o&&f.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(n(!f.compressed,"can not generate mipmap for compressed textures"),n(1===f.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=f.images,l=0;l<16;++l){var p=c[l];if(p){var d=o>>l,h=a>>l;n(f.mipmask&1<<l,"missing mipmap data"),n(p.width===d&&p.height===h,"invalid shape for mip images"),n(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed||(p.data?n(p.data.byteLength===d*h*Math.max(T(p.type,s),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):p.element||p.copy)}}}}function P(e,t){this.id=_t++,this.type=e,this.data=t}function z(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function L(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+z(e.substr(1,e.length-2))+'"'];
var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return L(e.substr(0,r.index)).concat(L(r[1])).concat(L(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+z(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(L(i[a]));return o}function F(e){return"["+L(e).join("][")+"]"}function I(e,t){return new P(e,F(t+""))}function B(e){return"function"==typeof e&&!e._reglType||e instanceof P}function R(e,t){return"function"==typeof e?new P(wt,e):e}function N(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r?r:(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function q(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;if(e!==document.body){var i=e.getBoundingClientRect();t=i.right-i.left,r=i.bottom-i.top}o.width=n*t,o.height=n*r,Je(o.style,{width:t+"px",height:r+"px"})}function i(){window.removeEventListener("resize",r),e.removeChild(o)}var o=document.createElement("canvas");return Je(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",Je(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:o,onDestroy:i}}function V(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function G(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function H(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function U(e){return"string"==typeof e?e.split():(xt(Array.isArray(e),"invalid extension array"),e)}function W(e){return"string"==typeof e?(xt("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function Q(e){var t,n,r,i,o=e||{},a={},s=[],u=[],f="undefined"==typeof window?1:window.devicePixelRatio,c=!1,l=function(e){e&&xt.raise(e)},p=function(){};if("string"==typeof o?(xt("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(o),xt(t,"invalid query string for element")):"object"==typeof o?G(o)?t=o:H(o)?(i=o,r=i.canvas):(xt.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=W(o.canvas):"container"in o&&(n=W(o.container)),"attributes"in o&&(a=o.attributes,xt.type(a,"object","invalid context attributes")),"extensions"in o&&(s=U(o.extensions)),"optionalExtensions"in o&&(u=U(o.optionalExtensions)),"onDone"in o&&(xt.type(o.onDone,"function","invalid or missing onDone callback"),l=o.onDone),"profile"in o&&(c=!!o.profile),"pixelRatio"in o&&(f=+o.pixelRatio,xt(f>0,"invalid pixel ratio"))):xt.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){xt("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var d=q(n||document.body,l,f);if(!d)return null;r=d.canvas,p=d.onDestroy}i=V(r,a)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:f,profile:c,onDone:l,onDestroy:p}:(p(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Y(e,t){function n(t){xt.type(t,"string","extension name must be string");var n,i=t.toLowerCase();try{n=r[i]=e.getExtension(i)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw new Error("(regl): error restoring extension "+e)})}}}function X(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||Ke(e.data))}function Z(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function $(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function K(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1}function J(e){var t=$(e),n=fn[K(t)>>2];return n.length>0?n.pop():new ArrayBuffer(t)}function ee(e){fn[K(e.byteLength)>>2].push(e)}function te(e,t){var n=null;switch(e){case tn:n=new Int8Array(J(t),0,t);break;case nn:n=new Uint8Array(J(t),0,t);break;case rn:n=new Int16Array(J(2*t),0,t);break;case on:n=new Uint16Array(J(2*t),0,t);break;case an:n=new Int32Array(J(4*t),0,t);break;case sn:n=new Uint32Array(J(4*t),0,t);break;case un:n=new Float32Array(J(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n}function ne(e){ee(e.buffer)}function re(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function ie(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],s=0;s<n;++s)r[i++]=a[s]}function oe(e,t,n,r,i,o){for(var a=o,s=0;s<t;++s)for(var u=e[s],f=0;f<n;++f)for(var c=u[f],l=0;l<r;++l)i[a++]=c[l]}function ae(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(t.length-n===4){var u=t[n+1],f=t[n+2],c=t[n+3];for(a=0;a<s;++a)oe(e[a],u,f,c,r,i),i+=o}else for(a=0;a<s;++a)ae(e[a],t,n+1,r,i),i+=o}function se(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||cn.allocType(n,i);switch(t.length){case 0:break;case 1:re(e,t[0],a);break;case 2:ie(e,t[0],t[1],a);break;case 3:oe(e,t[0],t[1],t[2],a,0);break;default:ae(e,t,0,a,0)}return a}function ue(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}function fe(e){return 0|$e[Object.prototype.toString.call(e)]}function ce(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function le(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var f=0;f<r;++f)e[s++]=t[i*u+o*f+a]}function pe(e,t,n){function r(t){this.id=l++,this.buffer=e.createBuffer(),this.type=t,this.usage=En,this.byteLength=0,this.dimension=1,this.dtype=On,this.persistentData=null,n.profile&&(this.stats={size:0})}function i(e,t){var n=d.pop();return n||(n=new r(e)),n.bind(),s(n,t,jn,0,1,!1),n}function o(e){d.push(e)}function a(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function s(e,t,n,r,i,o){var s;if(e.usage=n,Array.isArray(t)){if(e.dtype=r||Tn,t.length>0){var u;if(Array.isArray(t[0])){s=kn(t);for(var f=1,c=1;c<s.length;++c)f*=s[c];e.dimension=f,u=An(t,s,e.dtype),a(e,u,n),o?e.persistentData=u:cn.freeType(u)}else if("number"==typeof t[0]){e.dimension=i;var l=cn.allocType(e.dtype,t.length);ce(l,t),a(e,l,n),o?e.persistentData=l:cn.freeType(l)}else Ke(t[0])?(e.dimension=t[0].length,e.dtype=r||fe(t[0])||Tn,u=An(t,[t.length,t[0].length],e.dtype),a(e,u,n),o?e.persistentData=u:cn.freeType(u)):xt.raise("invalid buffer data")}}else if(Ke(t))e.dtype=r||fe(t),e.dimension=i,a(e,t,n),o&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(X(t)){s=t.shape;var p=t.stride,d=t.offset,h=0,m=0,v=0,g=0;1===s.length?(h=s[0],m=1,v=p[0],g=0):2===s.length?(h=s[0],m=s[1],v=p[0],g=p[1]):xt.raise("invalid shape"),e.dtype=r||fe(t.data)||Tn,e.dimension=m;var b=cn.allocType(e.dtype,h*m);le(b,t.data,h,m,v,g,d),a(e,b,n),o?e.persistentData=b:cn.freeType(b)}else xt.raise("invalid buffer data")}function u(n){t.bufferCount--;var r=n.buffer;xt(r,"buffer must not be deleted already"),e.deleteBuffer(r),n.buffer=null,delete p[n.id]}function f(i,o,a,f){function c(t){var r=En,i=null,o=0,a=0,u=1;return Array.isArray(t)||Ke(t)||X(t)?i=t:"number"==typeof t?o=0|t:t&&(xt.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(xt(null===i||Array.isArray(i)||Ke(i)||X(i),"invalid data for buffer"),i=t.data),"usage"in t&&(xt.parameter(t.usage,Sn,"invalid buffer usage"),r=Sn[t.usage]),"type"in t&&(xt.parameter(t.type,xn,"invalid buffer type"),a=xn[t.type]),"dimension"in t&&(xt.type(t.dimension,"number","invalid dimension"),u=0|t.dimension),"length"in t&&(xt.nni(o,"buffer length must be a nonnegative integer"),o=0|t.length)),h.bind(),i?s(h,i,r,a,u,f):(e.bufferData(h.type,o,r),h.dtype=a||On,h.usage=r,h.dimension=u,h.byteLength=o),n.profile&&(h.stats.size=h.byteLength*Dn[h.dtype]),c}function l(t,n){xt(n+t.byteLength<=h.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+h.byteLength),e.bufferSubData(h.type,n,t)}function d(e,t){var n,r=0|(t||0);if(h.bind(),Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var i=cn.allocType(h.dtype,e.length);ce(i,e),l(i,r),cn.freeType(i)}else if(Array.isArray(e[0])||Ke(e[0])){n=kn(e);var o=An(e,n,h.dtype);l(o,r),cn.freeType(o)}else xt.raise("invalid buffer data")}else if(Ke(e))l(e,r);else if(X(e)){n=e.shape;var a=e.stride,s=0,u=0,f=0,p=0;1===n.length?(s=n[0],u=1,f=a[0],p=0):2===n.length?(s=n[0],u=n[1],f=a[0],p=a[1]):xt.raise("invalid shape");var d=Array.isArray(e.data)?h.dtype:fe(e.data),m=cn.allocType(d,s*u);le(m,e.data,s,u,f,p,e.offset),l(m,r),cn.freeType(m)}else xt.raise("invalid data for buffer subdata");return c}t.bufferCount++;var h=new r(o);return p[h.id]=h,a||c(i),c._reglType="buffer",c._buffer=h,c.subdata=d,n.profile&&(c.stats=h.stats),c.destroy=function(){u(h)},c}function c(){en(p).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})}var l=0,p={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){u(this)};var d=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(p).forEach(function(t){e+=p[t].stats.size}),e}),{create:f,createStream:i,destroyStream:o,clear:function(){en(p).forEach(u),d.forEach(u)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:c,_initBuffer:s}}function de(e,t,n,r){function i(e){this.id=l++,c[this.id]=this,this.buffer=e,this.primType=Nn,this.vertCount=0,this.type=0}function o(e){var t=d.pop();return t||(t=new i(n.create(null,Qn,!0,!1)._buffer)),s(t,e,Yn,-1,-1,0,0),t}function a(e){d.push(e)}function s(r,i,o,a,s,u,f){if(r.buffer.bind(),i){var c=f;f||Ke(i)&&(!X(i)||Ke(i.data))||(c=t.oes_element_index_uint?Wn:Hn),n._initBuffer(r.buffer,i,o,c,3)}else e.bufferData(Qn,u,o),r.buffer.dtype=l||Vn,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=u;var l=f;if(!f){switch(r.buffer.dtype){case Vn:case qn:l=Vn;break;case Hn:case Gn:l=Hn;break;case Wn:case Un:l=Wn;break;default:xt.raise("unsupported type for element array")}r.buffer.dtype=l}r.type=l,xt(l!==Wn||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var p=s;p<0&&(p=r.buffer.byteLength,l===Hn?p>>=1:l===Wn&&(p>>=2)),r.vertCount=p;var d=a;if(a<0){d=Nn;var h=r.buffer.dimension;1===h&&(d=Bn),2===h&&(d=Rn),3===h&&(d=Nn)}r.primType=d}function u(e){r.elementsCount--,xt(null!==e.buffer,"must not double destroy elements"),delete c[e.id],e.buffer.destroy(),e.buffer=null}function f(e,t){function o(e){if(e)if("number"==typeof e)a(e),f.primType=Nn,f.vertCount=0|e,f.type=Vn;else{var t=null,n=Xn,r=-1,i=-1,u=0,c=0;Array.isArray(e)||Ke(e)||X(e)?t=e:(xt.type(e,"object","invalid arguments for elements"),"data"in e&&(t=e.data,xt(Array.isArray(t)||Ke(t)||X(t),"invalid data for element buffer")),"usage"in e&&(xt.parameter(e.usage,Sn,"invalid element buffer usage"),n=Sn[e.usage]),"primitive"in e&&(xt.parameter(e.primitive,In,"invalid element buffer primitive"),r=In[e.primitive]),"count"in e&&(xt("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),i=0|e.count),"type"in e&&(xt.parameter(e.type,p,"invalid buffer type"),c=p[e.type]),"length"in e?u=0|e.length:(u=i,c===Hn||c===Gn?u*=2:c!==Wn&&c!==Un||(u*=4))),s(f,t,n,r,i,u,c)}else a(),f.primType=Nn,f.vertCount=0,f.type=Vn;return o}var a=n.create(null,Qn,!0),f=new i(a._buffer);return r.elementsCount++,o(e),o._reglType="elements",o._elements=f,o.subdata=function(e,t){return a.subdata(e,t),o},o.destroy=function(){u(f)},o}var c={},l=0,p={uint8:Vn,uint16:Hn};t.oes_element_index_uint&&(p.uint32=Wn),i.prototype.bind=function(){this.buffer.bind()};var d=[];return{create:f,createStream:o,destroyStream:a,getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){en(c).forEach(u)}}}function he(e){for(var t=cn.allocType(Kn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-(1/0))t[n]=64512;else{Zn[0]=e[n];var r=$n[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var s=-14-o;t[n]=i+(a+1024>>s)}else o>15?t[n]=i+31744:t[n]=i+(o+15<<10)+a}return t}function me(e){return Array.isArray(e)||Ke(e)}function ve(e){return"[object "+e+"]"}function ge(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function be(e){if(!Array.isArray(e))return!1;var t=e.length;return!(0===t||!me(e[0]))}function ye(e){return Object.prototype.toString.call(e)}function xe(e){return ye(e)===fi}function _e(e){return ye(e)===ci}function we(e){return ye(e)===li}function Se(e){return ye(e)===pi}function Ae(e){if(!e)return!1;var t=ye(e);return di.indexOf(t)>=0||(ge(e)||be(e)||X(e))}function ke(e){return 0|$e[Object.prototype.toString.call(e)]}function Ee(e,t){var n=t.length;switch(e.type){case Cr:case Pr:case zr:case Lr:var r=cn.allocType(e.type,n);r.set(t),e.data=r;break;case yr:e.data=he(t);break;default:xt.raise("unsupported texture type, must specify a typed array")}}function je(e,t){return cn.allocType(e.type===yr?Lr:e.type,t)}function Oe(e,t){e.type===yr?(e.data=he(t),cn.freeType(t)):e.data=t}function Te(e,t,n,r,i,o){for(var a=e.width,s=e.height,u=e.channels,f=a*s*u,c=je(e,f),l=0,p=0;p<s;++p)for(var d=0;d<a;++d)for(var h=0;h<u;++h)c[l++]=t[n*d+r*p+i*h+o];Oe(e,c)}function De(e,t,n,r,i,o){var a;if(a="undefined"!=typeof mi[e]?mi[e]:ui[e]*hi[t],o&&(a*=6),i){for(var s=0,u=n;u>=1;)s+=a*u*u,u/=2;return s}return a*n*r}function Me(e,t,n,r,i,o,a){function s(){this.internalformat=rr,this.format=rr,this.type=Cr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=0}function u(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function f(e,r){if("object"==typeof r&&r){if("premultiplyAlpha"in r&&(xt.type(r.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=r.premultiplyAlpha),"flipY"in r&&(xt.type(r.flipY,"boolean","invalid texture flip"),e.flipY=r.flipY),"alignment"in r&&(xt.oneOf(r.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=r.alignment),"colorSpace"in r&&(xt.parameter(r.colorSpace,B,"invalid colorSpace"),e.colorSpace=B[r.colorSpace]),"type"in r){var i=r.type;xt(t.oes_texture_float||!("float"===i||"float32"===i),"you must enable the OES_texture_float extension in order to use floating point textures."),xt(t.oes_texture_half_float||!("half float"===i||"float16"===i),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),xt(t.webgl_depth_texture||!("uint16"===i||"uint32"===i||"depth stencil"===i),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),xt.parameter(i,R,"invalid texture type"),e.type=R[i]}var o=e.width,a=e.height,s=e.channels,u=!1;"shape"in r?(xt(Array.isArray(r.shape)&&r.shape.length>=2,"shape must be an array"),o=r.shape[0],a=r.shape[1],3===r.shape.length&&(s=r.shape[2],xt(s>0&&s<=4,"invalid number of channels"),u=!0),xt(o>=0&&o<=n.maxTextureSize,"invalid width"),xt(a>=0&&a<=n.maxTextureSize,"invalid height")):("radius"in r&&(o=a=r.radius,xt(o>=0&&o<=n.maxTextureSize,"invalid radius")),"width"in r&&(o=r.width,xt(o>=0&&o<=n.maxTextureSize,"invalid width")),"height"in r&&(a=r.height,xt(a>=0&&a<=n.maxTextureSize,"invalid height")),"channels"in r&&(s=r.channels,xt(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|o,e.height=0|a,e.channels=0|s;var f=!1;if("format"in r){var c=r.format;xt(t.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),xt.parameter(c,N,"invalid texture format");var l=e.internalformat=N[c];e.format=Z[l],c in R&&("type"in r||(e.type=R[c])),c in q&&(e.compressed=!0),f=!0}!u&&f?e.channels=ui[e.format]:u&&!f?e.channels!==si[e.format]&&(e.format=e.internalformat=si[e.channels]):f&&u&&xt(e.channels===ui[e.format],"number of channels inconsistent with specified format")}}function c(t){e.pixelStorei(ti,t.flipY),e.pixelStorei(ni,t.premultiplyAlpha),e.pixelStorei(ri,t.colorSpace),e.pixelStorei(ei,t.unpackAlignment)}function l(){s.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(e,t){var r=null;if(Ae(t)?r=t:t&&(xt.type(t,"object","invalid pixel data type"),f(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),Ae(t.data)&&(r=t.data)),xt(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){xt(!r,"can not specify copy and data field for the same texture");var o=i.viewportWidth,a=i.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,xt(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(r){if(Ke(r))e.channels=e.channels||4,e.data=r,"type"in t||e.type!==Cr||(e.type=ke(r));else if(ge(r))e.channels=e.channels||4,Ee(e,r),e.alignment=1,e.needsFree=!0;else if(X(r)){var s=r.data;Array.isArray(s)||e.type!==Cr||(e.type=ke(s));var u,c,l,p,d,h,m=r.shape,v=r.stride;3===m.length?(l=m[2],h=v[2]):(xt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,h=1),u=m[0],c=m[1],p=v[0],d=v[1],e.alignment=1,e.width=u,e.height=c,e.channels=l,e.format=e.internalformat=si[l],e.needsFree=!0,Te(e,s,p,d,h,r.offset)}else if(xe(r)||_e(r))xe(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(we(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(Se(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(be(r)){var g=e.width||r[0].length,b=e.height||r.length,y=e.channels;y=me(r[0][0])?y||r[0][0].length:y||1;for(var x=ln.shape(r),_=1,w=0;w<x.length;++w)_*=x[w];var S=je(e,_);ln.flatten(r,x,"",S),Oe(e,S),e.alignment=1,e.width=g,e.height=b,e.channels=y,e.format=e.internalformat=si[y],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Lr?xt(n.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===yr&&xt(n.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function d(t,n,i){var o=t.element,a=t.data,s=t.internalformat,u=t.format,f=t.type,l=t.width,p=t.height;c(t),o?e.texImage2D(n,i,u,u,f,o):t.compressed?e.compressedTexImage2D(n,i,s,l,p,0,a):t.needsCopy?(r(),e.copyTexImage2D(n,i,u,t.xOffset,t.yOffset,l,p,0)):e.texImage2D(n,i,u,l,p,0,u,f,a)}function h(t,n,i,o,a){var s=t.element,u=t.data,f=t.internalformat,l=t.format,p=t.type,d=t.width,h=t.height;c(t),s?e.texSubImage2D(n,a,i,o,l,p,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,f,d,h,u):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,d,h)):e.texSubImage2D(n,a,i,o,d,h,l,p,u)}function m(){return $.pop()||new l}function v(e){e.needsFree&&cn.freeType(e.data),l.call(e),$.push(e)}function g(){s.call(this),this.genMipmaps=!1,this.mipmapHint=Zr,this.mipmask=0,this.images=Array(16)}function b(e,t,n){var r=e.images[0]=m();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function y(e,t){var n=null;if(Ae(t))n=e.images[0]=m(),u(n,e),p(n,t),e.mipmask=1;else if(f(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)n=e.images[i]=m(),u(n,e),n.width>>=i,n.height>>=i,p(n,r[i]),e.mipmask|=1<<i;else n=e.images[0]=m(),u(n,e),p(n,t),e.mipmask=1;u(e,e.images[0]),(e.compressed&&e.internalformat===xr||e.internalformat===_r||e.internalformat===wr||e.internalformat===Sr)&&xt(e.width%4===0&&e.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function x(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;d(n[r],t,r)}}function _(){var e=K.pop()||new g;s.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function w(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&v(t[n]),t[n]=null;K.push(e)}function S(){this.minFilter=Gr,this.magFilter=Gr,this.wrapS=Rr,this.wrapT=Rr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Zr}function A(e,t){if("min"in t){var r=t.min;xt.parameter(r,I),e.minFilter=I[r],ai.indexOf(e.minFilter)>=0&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;xt.parameter(i,F),e.magFilter=F[i]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(xt.parameter(s,L),o=a=L[s]):Array.isArray(s)&&(xt.parameter(s[0],L),xt.parameter(s[1],L),o=L[s[0]],a=L[s[1]])}else{if("wrapS"in t){var u=t.wrapS;xt.parameter(u,L),o=L[u]}if("wrapT"in t){var f=t.wrapT;xt.parameter(f,L),a=L[f]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var c=t.anisotropic;xt("number"==typeof c&&c>=1&&c<=n.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var l=!1;switch(typeof t.mipmap){case"string":xt.parameter(t.mipmap,z,"invalid mipmap hint"),e.mipmapHint=z[t.mipmap],e.genMipmaps=!0,l=!0;break;case"boolean":l=e.genMipmaps=t.mipmap;break;case"object":xt(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,l=!0;break;default:xt.raise("invalid mipmap type")}!l||"min"in t||(e.minFilter=Ur)}}function k(n,r){e.texParameteri(r,Vr,n.minFilter),e.texParameteri(r,qr,n.magFilter),e.texParameteri(r,Fr,n.wrapS),e.texParameteri(r,Ir,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,Jr,n.anisotropic),n.genMipmaps&&(e.hint(Xr,n.mipmapHint),e.generateMipmap(r))}function E(t){s.call(this),this.mipmask=0,this.internalformat=rr,this.id=J++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new S,a.profile&&(this.stats={size:0})}function j(t){e.activeTexture(oi),e.bindTexture(t.target,t.texture)}function O(){var t=ne[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(er,null)}function T(t){var n=t.texture;xt(n,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(e.activeTexture(oi+r),e.bindTexture(i,null),ne[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ee[t.id],o.textureCount--}function D(t,r){function i(e,t){var r=c.texInfo;S.call(r);var o=_();return"number"==typeof e?"number"==typeof t?b(o,0|e,0|t):b(o,0|e,0|e):e?(xt.type(e,"object","invalid arguments to regl.texture"),A(r,e),y(o,e)):b(o,1,1),r.genMipmaps&&(o.mipmask=(o.width<<1)-1),c.mipmask=o.mipmask,u(c,o),xt.texture2D(r,o,n),c.internalformat=o.internalformat,i.width=o.width,i.height=o.height,j(c),x(o,er),k(r,er),O(),w(o),a.profile&&(c.stats.size=De(c.internalformat,c.type,o.width,o.height,r.genMipmaps,!1)),i.format=H[c.internalformat],i.type=U[c.type],i.mag=W[r.magFilter],i.min=Q[r.minFilter],i.wrapS=Y[r.wrapS],i.wrapT=Y[r.wrapT],i}function s(e,t,n,r){xt(!!e,"must specify image data");var o=0|t,a=0|n,s=0|r,f=m();return u(f,c),f.width=0,f.height=0,p(f,e),f.width=f.width||(c.width>>s)-o,f.height=f.height||(c.height>>s)-a,xt(c.type===f.type&&c.format===f.format&&c.internalformat===f.internalformat,"incompatible format for texture.subimage"),xt(o>=0&&a>=0&&o+f.width<=c.width&&a+f.height<=c.height,"texture.subimage write out of bounds"),xt(c.mipmask&1<<s,"missing mipmap data"),xt(f.data||f.element||f.needsCopy,"missing image data"),j(c),h(f,er,o,a,s),O(),v(f),i}function f(t,n){var r=0|t,o=0|n||r;if(r===c.width&&o===c.height)return i;i.width=c.width=r,i.height=c.height=o,j(c);for(var s=0;c.mipmask>>s;++s)e.texImage2D(er,s,c.format,r>>s,o>>s,0,c.format,c.type,null);return O(),a.profile&&(c.stats.size=De(c.internalformat,c.type,r,o,!1,!1)),i}var c=new E(er);return ee[c.id]=c,o.textureCount++,i(t,r),i.subimage=s,i.resize=f,i._reglType="texture2d",i._texture=c,a.profile&&(i.stats=c.stats),i.destroy=function(){c.decRef()},i}function M(t,r,i,s,c,l){function d(e,t,r,i,o,s){var c,l=D.texInfo;for(S.call(l),c=0;c<6;++c)M[c]=_();if("number"!=typeof e&&e)if("object"==typeof e)if(t)y(M[0],e),y(M[1],t),y(M[2],r),y(M[3],i),y(M[4],o),y(M[5],s);else if(A(l,e),f(D,e),"faces"in e){var p=e.faces;for(xt(Array.isArray(p)&&6===p.length,"cube faces must be a length 6 array"),c=0;c<6;++c)xt("object"==typeof p[c]&&!!p[c],"invalid input for cube map face"),u(M[c],D),y(M[c],p[c])}else for(c=0;c<6;++c)y(M[c],e);else xt.raise("invalid arguments to cube map");else{var h=0|e||1;for(c=0;c<6;++c)b(M[c],h,h)}for(u(D,M[0]),l.genMipmaps?D.mipmask=(M[0].width<<1)-1:D.mipmask=M[0].mipmask,xt.textureCube(D,l,M,n),D.internalformat=M[0].internalformat,d.width=M[0].width,d.height=M[0].height,j(D),c=0;c<6;++c)x(M[c],nr+c);for(k(l,tr),O(),a.profile&&(D.stats.size=De(D.internalformat,D.type,d.width,d.height,l.genMipmaps,!0)),d.format=H[D.internalformat],d.type=U[D.type],d.mag=W[l.magFilter],d.min=Q[l.minFilter],d.wrapS=Y[l.wrapS],d.wrapT=Y[l.wrapT],c=0;c<6;++c)w(M[c]);return d}function g(e,t,n,r,i){xt(!!t,"must specify image data"),xt("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,s=0|i,f=m();return u(f,D),f.width=0,f.height=0,p(f,t),f.width=f.width||(D.width>>s)-o,f.height=f.height||(D.height>>s)-a,xt(D.type===f.type&&D.format===f.format&&D.internalformat===f.internalformat,"incompatible format for texture.subimage"),xt(o>=0&&a>=0&&o+f.width<=D.width&&a+f.height<=D.height,"texture.subimage write out of bounds"),xt(D.mipmask&1<<s,"missing mipmap data"),xt(f.data||f.element||f.needsCopy,"missing image data"),j(D),h(f,nr+e,o,a,s),O(),v(f),d}function T(t){var n=0|t;if(n!==D.width){d.width=D.width=n,d.height=D.height=n,j(D);for(var r=0;r<6;++r)for(var i=0;D.mipmask>>i;++i)e.texImage2D(nr+r,i,D.format,n>>i,n>>i,0,D.format,D.type,null);return O(),a.profile&&(D.stats.size=De(D.internalformat,D.type,d.width,d.height,!1,!0)),d}}var D=new E(tr);ee[D.id]=D,o.cubeCount++;var M=new Array(6);return d(t,r,i,s,c,l),d.subimage=g,d.resize=T,d._reglType="textureCube",d._texture=D,a.profile&&(d.stats=D.stats),d.destroy=function(){D.decRef()},d}function C(){for(var t=0;t<te;++t)e.activeTexture(oi+t),e.bindTexture(er,null),ne[t]=null;en(ee).forEach(T),o.cubeCount=0,o.textureCount=0}function P(){en(ee).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;n<32;++n)if(0!==(t.mipmask&1<<n))if(t.target===er)e.texImage2D(er,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)e.texImage2D(nr+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);k(t.texInfo,t.target)})}var z={"don't care":Zr,"dont care":Zr,nice:Kr,fast:$r},L={repeat:Br,clamp:Rr,mirror:Nr},F={nearest:Gr,linear:Hr},I=Je({mipmap:Yr,"nearest mipmap nearest":Ur,"linear mipmap nearest":Wr,"nearest mipmap linear":Qr,"linear mipmap linear":Yr},F),B={none:0,browser:ii},R={uint8:Cr,rgba4:lr,rgb565:dr,"rgb5 a1":pr},N={alpha:ir,luminance:ar,"luminance alpha":sr,rgb:or,rgba:rr,rgba4:ur,"rgb5 a1":fr,rgb565:cr},q={};t.ext_srgb&&(N.srgb=gr,N.srgba=br),t.oes_texture_float&&(R.float32=R.float=Lr),t.oes_texture_half_float&&(R.float16=R["half float"]=yr),t.webgl_depth_texture&&(Je(N,{depth:mr,"depth stencil":vr}),Je(R,{uint16:Pr,uint32:zr,"depth stencil":hr})),t.webgl_compressed_texture_s3tc&&Je(q,{"rgb s3tc dxt1":xr,"rgba s3tc dxt1":_r,"rgba s3tc dxt3":wr,"rgba s3tc dxt5":Sr}),t.webgl_compressed_texture_atc&&Je(q,{"rgb atc":Ar,"rgba atc explicit alpha":kr,"rgba atc interpolated alpha":Er}),t.webgl_compressed_texture_pvrtc&&Je(q,{"rgb pvrtc 4bppv1":jr,"rgb pvrtc 2bppv1":Or,"rgba pvrtc 4bppv1":Tr,"rgba pvrtc 2bppv1":Dr}),t.webgl_compressed_texture_etc1&&(q["rgb etc1"]=Mr);var V=Array.prototype.slice.call(e.getParameter(Jn));Object.keys(q).forEach(function(e){var t=q[e];V.indexOf(t)>=0&&(N[e]=t)});var G=Object.keys(N);n.textureFormats=G;var H=[];Object.keys(N).forEach(function(e){var t=N[e];H[t]=e});var U=[];Object.keys(R).forEach(function(e){var t=R[e];U[t]=e});var W=[];Object.keys(F).forEach(function(e){var t=F[e];W[t]=e});var Q=[];Object.keys(I).forEach(function(e){var t=I[e];Q[t]=e});var Y=[];Object.keys(L).forEach(function(e){var t=L[e];Y[t]=e});var Z=G.reduce(function(e,t){var n=N[t];return n===ar||n===ir||n===ar||n===sr||n===mr||n===vr?e[n]=n:n===fr||t.indexOf("rgba")>=0?e[n]=rr:e[n]=or,e},{}),$=[],K=[],J=0,ee={},te=n.maxTextureUnits,ne=Array(te).map(function(){return null});return Je(E.prototype,{bind:function(){var t=this;t.bindCount+=1;var n=t.unit;if(n<0){for(var r=0;r<te;++r){var i=ne[r];if(i){if(i.bindCount>0)continue;i.unit=-1}ne[r]=t,n=r;break}n>=te&&xt.raise("insufficient number of texture units"),a.profile&&o.maxTextureUnits<n+1&&(o.maxTextureUnits=n+1),t.unit=n,e.activeTexture(oi+n),e.bindTexture(t.target,t.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&T(this)}}),a.profile&&(o.getTotalTextureSize=function(){var e=0;return Object.keys(ee).forEach(function(t){e+=ee[t].stats.size}),e}),{create2D:D,createCube:M,clear:C,getTexture:function(e){return null},restore:P}}function Ce(e,t,n){return ji[e]*t*n}function Pe(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function u(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);xt(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;xt(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function f(t,n){n&&(n.texture?e.framebufferTexture2D(Ti,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(Ti,t,Di,n.renderbuffer._renderbuffer.renderbuffer))}function c(e){var t=Mi,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),xt.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,xt(t===Mi)):"textureCube"===o?(n=i,xt(t>=Ci&&t<Ci+6,"invalid cube map target")):"renderbuffer"===o?(r=i,t=Di):xt.raise("invalid regl object for attachment"),new a(t,n,r)}function l(e,t,n,o,s){if(n){var u=r.create2D({width:e,height:t,format:o,type:s});return u._texture.refCount=0,new a(Mi,u,null)}var f=i.create({width:e,height:t,format:o});return f._renderbuffer.refCount=0,new a(Di,null,f)}function p(e){return e&&(e.texture||e.renderbuffer)}function d(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function h(){this.id=k++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function v(t){var n=t.framebuffer;xt(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,o.framebufferCount--,delete E[t.id]}function g(t){var r;e.bindFramebuffer(Ti,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)f(Pi+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(Ti,Pi+r,Mi,null,0);e.framebufferTexture2D(Ti,Fi,Mi,null,0),e.framebufferTexture2D(Ti,zi,Mi,null,0),e.framebufferTexture2D(Ti,Li,Mi,null,0),f(zi,t.depthAttachment),f(Li,t.stencilAttachment),f(Fi,t.depthStencilAttachment);var o=e.checkFramebufferStatus(Ti);o!==Ii&&xt.raise("framebuffer configuration not supported, status = "+so[o]),e.bindFramebuffer(Ti,_.next),_.cur=_.next,e.getError()}function b(e,r){function i(e,r){var o;
xt(_.next!==s,"can not update framebuffer which is currently in use");var a=t.webgl_draw_buffers,f=0,d=0,h=!0,v=!0,b=null,y=!0,x="rgba",k="uint8",E=1,j=null,O=null,T=null,D=!1;if("number"==typeof e)f=0|e,d=0|r||f;else if(e){xt.type(e,"object","invalid arguments for framebuffer");var M=e;if("shape"in M){var C=M.shape;xt(Array.isArray(C)&&C.length>=2,"invalid shape for framebuffer"),f=C[0],d=C[1]}else"radius"in M&&(f=d=M.radius),"width"in M&&(f=M.width),"height"in M&&(d=M.height);("color"in M||"colors"in M)&&(b=M.color||M.colors,Array.isArray(b)&&xt(1===b.length||a,"multiple render targets not supported")),b||("colorCount"in M&&(E=0|M.colorCount,xt(E>0,"invalid color buffer count")),"colorTexture"in M&&(y=!!M.colorTexture,x="rgba4"),"colorType"in M&&(k=M.colorType,y?(xt(t.oes_texture_float||!("float"===k||"float32"===k),"you must enable OES_texture_float in order to use floating point framebuffer objects"),xt(t.oes_texture_half_float||!("half float"===k||"float16"===k),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===k||"float16"===k?(xt(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),x="rgba16f"):"float"!==k&&"float32"!==k||(xt(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),x="rgba32f"),xt.oneOf(k,A,"invalid color type")),"colorFormat"in M&&(x=M.colorFormat,w.indexOf(x)>=0?y=!0:S.indexOf(x)>=0?y=!1:y?xt.oneOf(M.colorFormat,w,"invalid color format for texture"):xt.oneOf(M.colorFormat,S,"invalid color format for renderbuffer"))),("depthTexture"in M||"depthStencilTexture"in M)&&(D=!(!M.depthTexture&&!M.depthStencilTexture),xt(!D||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"==typeof M.depth?h=M.depth:(j=M.depth,v=!1)),"stencil"in M&&("boolean"==typeof M.stencil?v=M.stencil:(O=M.stencil,h=!1)),"depthStencil"in M&&("boolean"==typeof M.depthStencil?h=v=M.depthStencil:(T=M.depthStencil,h=!1,v=!1))}else f=d=1;var P=null,z=null,L=null,F=null;if(Array.isArray(b))P=b.map(c);else if(b)P=[c(b)];else for(P=new Array(E),o=0;o<E;++o)P[o]=l(f,d,y,x,k);xt(t.webgl_draw_buffers||P.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),xt(P.length<=n.maxColorAttachments,"too many color attachments, not supported"),f=f||P[0].width,d=d||P[0].height,j?z=c(j):h&&!v&&(z=l(f,d,D,"depth","uint32")),O?L=c(O):v&&!h&&(L=l(f,d,!1,"stencil","uint8")),T?F=c(T):!j&&!O&&v&&h&&(F=l(f,d,D,"depth stencil","depth stencil")),xt(!!j+!!O+!!T<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var I=null;for(o=0;o<P.length;++o)if(u(P[o],f,d),xt(!P[o]||P[o].texture&&Qi.indexOf(P[o].texture._texture.format)>=0||P[o].renderbuffer&&ao.indexOf(P[o].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+o+" is invalid"),P[o]&&P[o].texture){var B=Yi[P[o].texture._texture.format]*Xi[P[o].texture._texture.type];null===I?I=B:xt(I===B,"all color attachments much have the same number of bits per pixel.")}return u(z,f,d),xt(!z||z.texture&&z.texture._texture.format===Wi||z.renderbuffer&&z.renderbuffer._renderbuffer.format===Ji,"invalid depth attachment for framebuffer object"),u(L,f,d),xt(!L||L.renderbuffer&&L.renderbuffer._renderbuffer.format===eo,"invalid stencil attachment for framebuffer object"),u(F,f,d),xt(!F||F.texture&&F.texture._texture.format===to||F.renderbuffer&&F.renderbuffer._renderbuffer.format===to,"invalid depth-stencil attachment for framebuffer object"),m(s),s.width=f,s.height=d,s.colorAttachments=P,s.depthAttachment=z,s.stencilAttachment=L,s.depthStencilAttachment=F,i.color=P.map(p),i.depth=p(z),i.stencil=p(L),i.depthStencil=p(F),i.width=s.width,i.height=s.height,g(s),i}function a(e,t){xt(_.next!==s,"can not resize a framebuffer which is currently in use");var n=0|e,r=0|t||n;if(n===s.width&&r===s.height)return i;for(var o=s.colorAttachments,a=0;a<o.length;++a)d(o[a],n,r);return d(s.depthAttachment,n,r),d(s.stencilAttachment,n,r),d(s.depthStencilAttachment,n,r),s.width=i.width=n,s.height=i.height=r,g(s),i}var s=new h;return o.framebufferCount++,i(e,r),Je(i,{resize:a,_reglType:"framebuffer",_framebuffer:s,destroy:function(){v(s),m(s)},use:function(e){_.setFBO({framebuffer:i},e)}})}function y(e){function i(e){var n;xt(a.indexOf(_.next)<0,"can not update framebuffer which is currently in use");var o=t.webgl_draw_buffers,s={color:null},u=0,f=null,c="rgba",l="uint8",p=1;if("number"==typeof e)u=0|e;else if(e){xt.type(e,"object","invalid arguments for framebuffer");var d=e;if("shape"in d){var h=d.shape;xt(Array.isArray(h)&&h.length>=2,"invalid shape for framebuffer"),xt(h[0]===h[1],"cube framebuffer must be square"),u=h[0]}else"radius"in d&&(u=0|d.radius),"width"in d?(u=0|d.width,"height"in d&&xt(d.height===u,"must be square")):"height"in d&&(u=0|d.height);("color"in d||"colors"in d)&&(f=d.color||d.colors,Array.isArray(f)&&xt(1===f.length||o,"multiple render targets not supported")),f||("colorCount"in d&&(p=0|d.colorCount,xt(p>0,"invalid color buffer count")),"colorType"in d&&(xt.oneOf(d.colorType,A,"invalid color type"),l=d.colorType),"colorFormat"in d&&(c=d.colorFormat,xt.oneOf(d.colorFormat,w,"invalid color format for texture"))),"depth"in d&&(s.depth=d.depth),"stencil"in d&&(s.stencil=d.stencil),"depthStencil"in d&&(s.depthStencil=d.depthStencil)}else u=1;var m;if(f)if(Array.isArray(f))for(m=[],n=0;n<f.length;++n)m[n]=f[n];else m=[f];else{m=Array(p);var v={radius:u,format:c,type:l};for(n=0;n<p;++n)m[n]=r.createCube(v)}for(s.color=Array(m.length),n=0;n<m.length;++n){var g=m[n];xt("function"==typeof g&&"textureCube"===g._reglType,"invalid cube map"),u=u||g.width,xt(g.width===u&&g.height===u,"invalid cube map shape"),s.color[n]={target:Ci,data:m[n]}}for(n=0;n<6;++n){for(var y=0;y<m.length;++y)s.color[y].target=Ci+n;n>0&&(s.depth=a[0].depth,s.stencil=a[0].stencil,s.depthStencil=a[0].depthStencil),a[n]?a[n](s):a[n]=b(s)}return Je(i,{width:u,height:u,color:m})}function o(e){var t,r=0|e;if(xt(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===i.width)return i;var o=i.color;for(t=0;t<o.length;++t)o[t].resize(r);for(t=0;t<6;++t)a[t].resize(r);return i.width=i.height=r,i}var a=Array(6);return i(e),Je(i,{faces:a,resize:o,_reglType:"framebufferCube",destroy:function(){a.forEach(function(e){e.destroy()})}})}function x(){en(E).forEach(function(t){t.framebuffer=e.createFramebuffer(),g(t)})}var _={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],S=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&S.push("srgba"),t.ext_color_buffer_half_float&&S.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&S.push("rgba32f");var A=["uint8"];t.oes_texture_half_float&&A.push("half float","float16"),t.oes_texture_float&&A.push("float","float32");var k=0,E={};return Je(_,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof h)return t}return null},create:b,createCube:y,clear:function(){en(E).forEach(v)},restore:x})}function ze(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=uo,this.offset=0,this.stride=0,this.divisor=0}function Le(e,t,n,r,i){for(var o=n.maxAttributes,a=new Array(o),s=0;s<o;++s)a[s]=new ze;return{Record:ze,scope:{},state:a}}function Fe(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){var o=n===fo?c:l,a=o[r];if(!a){var s=t.str(r);a=e.createShader(n),e.shaderSource(a,s),e.compileShader(a),xt.shaderError(e,a,s,n,i),o[r]=a}return a}function s(e,t){this.id=h++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s){var u,f,c=a(fo,n.fragId),l=a(co,n.vertId),p=n.program=e.createProgram();e.attachShader(p,c),e.attachShader(p,l),e.linkProgram(p),xt.linkError(e,p,t.str(n.fragId),t.str(n.vertId),s);var d=e.getProgramParameter(p,lo);r.profile&&(n.stats.uniformsCount=d);var h=n.uniforms;for(u=0;u<d;++u)if(f=e.getActiveUniform(p,u))if(f.size>1)for(var m=0;m<f.size;++m){var v=f.name.replace("[0]","["+m+"]");o(h,new i(v,t.id(v),e.getUniformLocation(p,v),f))}else o(h,new i(f.name,t.id(f.name),e.getUniformLocation(p,f.name),f));var g=e.getProgramParameter(p,po);r.profile&&(n.stats.attributesCount=g);var b=n.attributes;for(u=0;u<g;++u)f=e.getActiveAttrib(p,u),f&&o(b,new i(f.name,t.id(f.name),e.getAttribLocation(p,f.name),f))}function f(){c={},l={};for(var e=0;e<d.length;++e)u(d[e])}var c={},l={},p={},d=[],h=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return d.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return d.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);en(c).forEach(t),c={},en(l).forEach(t),l={},d.forEach(function(t){e.deleteProgram(t.program)}),d.length=0,p={},n.shaderCount=0},program:function(e,t,r){xt.command(e>=0,"missing vertex shader",r),xt.command(t>=0,"missing fragment shader",r);var i=p[t];i||(i=p[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,u(o,r),i[e]=o,d.push(o)),o},restore:f,shader:a,frag:-1,vert:-1}}function Ie(e,t,n,r,i,o){function a(a){var s;null===t.next?(xt(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),s=mo):(xt(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),s=t.next.colorAttachments[0].texture._texture.type,o.oes_texture_float?xt(s===mo||s===go,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):xt(s===mo,"Reading from a framebuffer is only allowed for the type 'uint8'"));var u=0,f=0,c=r.framebufferWidth,l=r.framebufferHeight,p=null;Ke(a)?p=a:a&&(xt.type(a,"object","invalid arguments to regl.read()"),u=0|a.x,f=0|a.y,xt(u>=0&&u<r.framebufferWidth,"invalid x offset for regl.read"),xt(f>=0&&f<r.framebufferHeight,"invalid y offset for regl.read"),c=0|(a.width||r.framebufferWidth-u),l=0|(a.height||r.framebufferHeight-f),p=a.data||null),p&&(s===mo?xt(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):s===go&&xt(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),xt(c>0&&c+u<=r.framebufferWidth,"invalid width for read pixels"),xt(l>0&&l+f<=r.framebufferHeight,"invalid height for read pixels"),n();var d=c*l*4;return p||(s===mo?p=new Uint8Array(d):s===go&&(p=p||new Float32Array(d))),xt.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),xt(p.byteLength>=d,"data buffer for regl.read() too small"),e.pixelStorei(vo,4),e.readPixels(u,f,c,l,ho,s,p),p}function s(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}function u(e){return e&&"framebuffer"in e?s(e):a(e)}return u}function Be(e){return Array.prototype.slice.call(e)}function Re(e){return Be(e).join("")}function Ne(){function e(e){for(var t=0;t<u.length;++t)if(u[t]===e)return s[t];var n="g"+a++;return s.push(n),u.push(e),n}function t(){function e(){n.push.apply(n,Be(arguments))}function t(){var e="v"+a++;return r.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,Be(arguments)),n.push(";")),e}var n=[],r=[];return Je(e,{def:t,toString:function(){return Re([r.length>0?"var "+r+";":"",Re(n)])}})}function n(){function e(e,t){r(e,t,"=",n.def(e,t),";")}var n=t(),r=t(),i=n.toString,o=r.toString;return Je(function(){n.apply(n,Be(arguments))},{def:n.def,entry:n,exit:r,save:e,set:function(t,r,i){e(t,r),n(t,r,"=",i,";")},toString:function(){return i()+o()}})}function r(){var e=Re(arguments),t=n(),r=n(),i=t.toString,o=r.toString;return Je(t,{then:function(){return t.apply(t,Be(arguments)),this},else:function(){return r.apply(r,Be(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),Re(["if(",e,"){",i(),"}",t])}})}function i(e,t){function r(){var e="a"+i.length;return i.push(e),e}var i=[];t=t||0;for(var o=0;o<t;++o)r();var a=n(),s=a.toString,u=c[e]=Je(a,{arg:r,toString:function(){return Re(["function(",i.join(),"){",s(),"}"])}});return u}function o(){var e=['"use strict";',f,"return {"];Object.keys(c).forEach(function(t){e.push('"',t,'":',c[t].toString(),",")}),e.push("}");var t=Re(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),n=Function.apply(null,s.concat(t));return n.apply(null,u)}var a=0,s=[],u=[],f=t(),c={};return{global:f,link:e,block:t,proc:i,scope:n,cond:r,compile:o}}function qe(e){return Array.isArray(e)||Ke(e)||X(e)}function Ve(e){return e.sort(function(e,t){return e===Jo?-1:t===Jo?1:e<t?-1:1})}function Ge(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function He(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Ue(e){return new Ge(!1,!1,!1,e)}function We(e,t){var n=e.type;if(n===wo){var r=e.data.length;return new Ge(!0,r>=1,r>=2,t)}if(n===Eo){var i=e.data;return new Ge(i.thisDep,i.contextDep,i.propDep,t)}return new Ge(n===ko,n===Ao,n===So,t)}function Qe(e,t,n,r,i,o,a,s,u,f,c,l,p,d,h){function m(e){return e.replace(".","_")}function v(e,t,n){var r=m(e);te.push(e),ee[r]=J[r]=!!n,ne[r]=t}function g(e,t,n){var r=m(e);te.push(e),Array.isArray(n)?(J[r]=n.slice(),ee[r]=n.slice()):J[r]=ee[r]=n,re[r]=t}function b(){var e=Ne(),n=e.link,r=e.global;e.id=ae++,e.batchId="0";var i=n(ie),o=e.shared={props:"a0"};Object.keys(ie).forEach(function(e){o[e]=r.def(i,".",e)}),xt.optional(function(){e.CHECK=n(xt),e.commandStr=xt.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},oe.invalidBlendCombinations=ds});var a=e.next={},s=e.current={};Object.keys(re).forEach(function(e){Array.isArray(J[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var u=e.constants={};Object.keys(oe).forEach(function(e){u[e]=r.def(JSON.stringify(oe[e]))}),e.invoke=function(t,r){switch(r.type){case wo:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case So:return t.def(o.props,r.data);case Ao:return t.def(o.context,r.data);case ko:return t.def("this",r.data);case Eo:return r.data.append(e,t),r.data.ref}},e.attribCache={};var c={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in c)return c[r];var i=f.scope[r];i||(i=f.scope[r]=new Y);var o=c[r]=n(i);return o},e}function y(e){var t,n=e.static,r=e.dynamic;if(ea in n){var i=!!n[ea];t=Ue(function(e,t){return i}),t.enable=i}else if(ea in r){var o=r[ea];t=We(o,function(e,t){return e.invoke(t,o)})}return t}function x(e,t){var n=e.static,r=e.dynamic;if(ta in n){var i=n[ta];return i?(i=s.getFramebuffer(i),xt.command(i,"invalid framebuffer object"),Ue(function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+la,n+".width"),t.set(o,"."+pa,n+".height"),n})):Ue(function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+la,r+"."+va),t.set(r,"."+pa,r+"."+ga),"null"})}if(ta in r){var o=r[ta];return We(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");xt.optional(function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")}),t.set(i,".next",a);var s=r.context;return t.set(s,"."+la,a+"?"+a+".width:"+s+"."+va),t.set(s,"."+pa,a+"?"+a+".height:"+s+"."+ga),a})}return null}function _(e,t,n){function r(e){if(e in i){var r=i[e];xt.commandType(r,"object","invalid "+e,n.commandStr);var a,s,u=!0,f=0|r.x,c=0|r.y;return"width"in r?(a=0|r.width,xt.command(a>=0,"invalid "+e,n.commandStr)):u=!1,"height"in r?(s=0|r.height,xt.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new Ge(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,function(e,t){var n=e.shared.context,i=a;"width"in r||(i=t.def(n,".",la,"-",f));var o=s;return"height"in r||(o=t.def(n,".",pa,"-",c)),[f,c,i,o]})}if(e in o){var l=o[e],p=We(l,function(t,n){var r=t.invoke(n,l);xt.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",la,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",pa,"-",a,")");return xt.optional(function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)}),[o,a,s,u]});return t&&(p.thisDep=p.thisDep||t.thisDep,p.contextDep=p.contextDep||t.contextDep,p.propDep=p.propDep||t.propDep),p}return t?new Ge(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",la),t.def(n,".",pa)]}):null}var i=e.static,o=e.dynamic,a=r(Jo);if(a){var s=a;a=new Ge(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+da,n[2]),t.set(r,"."+ha,n[3]),n})}return{viewport:a,scissor_box:r(Ko)}}function w(e){function n(e){if(e in i){var n=t.id(i[e]);xt.optional(function(){c.shader(vs[e],n,xt.guessCommand())});var r=Ue(function(){return n});return r.id=n,r}if(e in o){var a=o[e];return We(a,function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return xt.optional(function(){n(t.shared.shader,".shader(",vs[e],",",i,",",t.command,");")}),i})}return null}var r,i=e.static,o=e.dynamic,a=n(ra),s=n(na),u=null;return He(a)&&He(s)?(u=c.program(s.id,a.id),r=Ue(function(e,t){return e.link(u)})):r=new Ge(a&&a.thisDep||s&&s.thisDep,a&&a.contextDep||s&&s.contextDep,a&&a.propDep||s&&s.propDep,function(e,t){var n,r=e.shared.shader;n=a?a.append(e,t):t.def(r,".",ra);var i;i=s?s.append(e,t):t.def(r,".",na);var o=r+".program("+i+","+n;return xt.optional(function(){o+=","+e.command}),t.def(o+")")}),{frag:a,vert:s,progVar:r,program:u}}function S(e,t){function n(){if(ia in s){var e=s[ia];qe(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e),xt.command(e,"invalid elements",t.commandStr));var n=Ue(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null});return n.value=e,n}if(ia in u){var r=u[ia];return We(r,function(e,t){var n=e.shared,i=n.isBufferArgs,o=n.elements,a=e.invoke(t,r),s=t.def("null"),u=t.def(i,"(",a,")"),f=e.cond(u).then(s,"=",o,".createStream(",a,");").else(s,"=",o,".getElements(",a,");");return xt.optional(function(){e.assert(f.else,"!"+a+"||"+s,"invalid elements")}),t.entry(f),t.exit(e.cond(u).then(o,".destroyStream(",s,");")),e.ELEMENTS=s,s})}return null}function r(){if(oa in s){var e=s[oa];return xt.commandParameter(e,In,"invalid primitve",t.commandStr),Ue(function(t,n){return In[e]})}if(oa in u){var n=u[oa];return We(n,function(e,t){var r=e.constants.primTypes,i=e.invoke(t,n);return xt.optional(function(){e.assert(t,i+" in "+r,"invalid primitive, must be one of "+Object.keys(In))}),t.def(r,"[",i,"]")})}return f?He(f)?Ue(f.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return $a}):new Ge(f.thisDep,f.contextDep,f.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",$a)}):null}function i(e,n){if(e in s){var r=0|s[e];return xt.command(!n||r>=0,"invalid "+e,t.commandStr),Ue(function(e,t){return n&&(e.OFFSET=r),r})}if(e in u){var i=u[e];return We(i,function(t,r){var o=t.invoke(r,i);return n&&(t.OFFSET=o,xt.optional(function(){t.assert(r,o+">=0","invalid "+e)})),o})}return n&&f?Ue(function(e,t){return e.OFFSET="0",0}):null}function a(){if(aa in s){var e=0|s[aa];return xt.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),Ue(function(){return e})}if(aa in u){var n=u[aa];return We(n,function(e,t){var r=e.invoke(t,n);return xt.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(f){if(He(f)){if(f)return c?new Ge(c.thisDep,c.contextDep,c.propDep,function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return xt.optional(function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")}),n}):Ue(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var r=Ue(function(){return-1});return xt.optional(function(){r.MISSING=!0}),r}var i=new Ge(f.thisDep||c.thisDep,f.contextDep||c.contextDep,f.propDep||c.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")});return xt.optional(function(){i.DYNAMIC=!0}),i}return null}var s=e.static,u=e.dynamic,f=n(),c=i(sa,!0);return{elements:f,primitive:r(),count:a(),instances:i(ua,!1),offset:c}}function A(e,t){var n=e.static,i=e.dynamic,o={};return te.forEach(function(e){function a(t,r){if(e in n){var a=t(n[e]);o[s]=Ue(function(){return a})}else if(e in i){var u=i[e];o[s]=We(u,function(e,t){return r(e,t,e.invoke(t,u))})}}var s=m(e);switch(e){case Io:case Oo:case jo:case Wo:case Co:case $o:case qo:case Go:case Ho:case Lo:return a(function(n){return xt.commandType(n,"boolean",e,t.commandStr),n},function(t,n,r){return xt.optional(function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)}),r});case Po:return a(function(n){return xt.commandParameter(n,hs,"invalid "+e,t.commandStr),hs[n]},function(t,n,r){var i=t.constants.compareFuncs;return xt.optional(function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(hs))}),n.def(i,"[",r,"]")});case zo:return a(function(e){return xt.command(me(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,n){xt.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")});var r=t.def("+",n,"[0]"),i=t.def("+",n,"[1]");return[r,i]});case Mo:return a(function(e){xt.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return xt.commandParameter(n,ps,s+".srcRGB",t.commandStr),xt.commandParameter(r,ps,s+".srcAlpha",t.commandStr),xt.commandParameter(i,ps,s+".dstRGB",t.commandStr),xt.commandParameter(o,ps,s+".dstAlpha",t.commandStr),xt.command(ds.indexOf(n+", "+i)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[ps[n],ps[i],ps[r],ps[o]]},function(t,n,r){function i(i,a){var s=n.def('"',i,a,'" in ',r,"?",r,".",i,a,":",r,".",i);return xt.optional(function(){t.assert(n,s+" in "+o,"invalid "+e+"."+i+a+", must be one of "+Object.keys(ps))}),s}var o=t.constants.blendFuncs;xt.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var a=i("src","RGB"),s=i("dst","RGB");xt.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var u=n.def(o,"[",a,"]"),f=n.def(o,"[",i("src","Alpha"),"]"),c=n.def(o,"[",s,"]"),l=n.def(o,"[",i("dst","Alpha"),"]");return[u,c,f,l]});case Do:return a(function(n){return"string"==typeof n?(xt.commandParameter(n,X,"invalid "+e,t.commandStr),[X[n],X[n]]):"object"==typeof n?(xt.commandParameter(n.rgb,X,e+".rgb",t.commandStr),xt.commandParameter(n.alpha,X,e+".alpha",t.commandStr),[X[n.rgb],X[n.alpha]]):void xt.commandRaise("invalid blend.equation",t.commandStr)},function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),s=t.cond("typeof ",r,'==="string"');return xt.optional(function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(X))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")}),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]});case To:return a(function(e){return xt.command(me(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),Z(4,function(t){return+e[t]})},function(e,t,n){return xt.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),Z(4,function(e){return t.def("+",n,"[",e,"]")})});case Qo:return a(function(e){return xt.commandType(e,"number",s,t.commandStr),0|e},function(e,t,n){return xt.optional(function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")}),t.def(n,"|0")});case Yo:return a(function(n){xt.commandType(n,"object",s,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return xt.commandParameter(r,hs,e+".cmp",t.commandStr),xt.commandType(i,"number",e+".ref",t.commandStr),xt.commandType(o,"number",e+".mask",t.commandStr),[hs[r],i,o]},function(e,t,n){var r=e.constants.compareFuncs;xt.optional(function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")});var i=t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",os),o=t.def(n,".ref|0"),a=t.def('"mask" in ',n,"?",n,".mask|0:-1");return[i,o,a]});case Xo:case Zo:return a(function(n){xt.commandType(n,"object",s,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return xt.commandParameter(r,ms,e+".fail",t.commandStr),xt.commandParameter(i,ms,e+".zfail",t.commandStr),xt.commandParameter(o,ms,e+".zpass",t.commandStr),[e===Zo?Ja:Ka,ms[r],ms[i],ms[o]]},function(t,n,r){function i(i){return xt.optional(function(){t.assert(n,'!("'+i+'" in '+r+")||("+r+"."+i+" in "+o+")","invalid "+e+"."+i+", must be one of "+Object.keys(ms))}),n.def('"',i,'" in ',r,"?",o,"[",r,".",i,"]:",os)}var o=t.constants.stencilOps;return xt.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[e===Zo?Ja:Ka,i("fail"),i("zfail"),i("zpass")]});case Vo:return a(function(e){xt.commandType(e,"object",s,t.commandStr);var n=0|e.factor,r=0|e.units;return xt.commandType(n,"number",s+".factor",t.commandStr),xt.commandType(r,"number",s+".units",t.commandStr),[n,r]},function(t,n,r){xt.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=n.def(r,".factor|0"),o=n.def(r,".units|0");return[i,o]});case Bo:return a(function(e){var n=0;return"front"===e?n=Ka:"back"===e&&(n=Ja),xt.command(!!n,s,t.commandStr),n},function(e,t,n){return xt.optional(function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),t.def(n,'==="front"?',Ka,":",Ja)});case No:return a(function(e){return xt.command("number"==typeof e&&e>=r.lineWidthDims[0]&&e<=r.lineWidthDims[1],"invalid line width, must positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],t.commandStr),e},function(e,t,n){return xt.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")}),n});case Ro:return a(function(e){return xt.commandParameter(e,gs,s,t.commandStr),gs[e]},function(e,t,n){return xt.optional(function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(n+'==="cw"?'+es+":"+ts)});case Fo:return a(function(e){return xt.command(me(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,n){return xt.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),Z(4,function(e){return"!!"+n+"["+e+"]"})});case Uo:return a(function(e){xt.command("object"==typeof e&&e,s,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return xt.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]},function(e,t,n){xt.optional(function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")});var r=t.def('"value" in ',n,"?+",n,".value:1"),i=t.def("!!",n,".invert");return[r,i]})}}),o}function k(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=Ue(function(){return o});else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=Ue(function(e){return e.link(o)}):"framebuffer"===a||"framebufferCube"===a?(xt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=Ue(function(e){return e.link(o.color[0])})):xt.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else me(o)?r=Ue(function(t){var n=t.global.def("[",Z(o.length,function(n){return xt.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]}),"]");return n}):xt.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=We(t,function(e,n){return e.invoke(n,t)})}),i}function E(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var o=r[e],s=t.id(e),u=new Y;if(qe(o))u.state=xo,u.buffer=i.getBuffer(i.create(o,ya,!1,!0)),u.type=0;else{var f=i.getBuffer(o);if(f)u.state=xo,u.buffer=f,u.type=0;else if(xt.command("object"==typeof o&&o,"invalid data for attribute "+e,n.commandStr),o.constant){var c=o.constant;u.buffer="null",u.state=_o,"number"==typeof c?u.x=c:(xt.command(me(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+e,n.commandStr),bo.forEach(function(e,t){t<c.length&&(u[e]=c[t])}))}else{f=qe(o.buffer)?i.getBuffer(i.create(o.buffer,ya,!1,!0)):i.getBuffer(o.buffer),xt.command(!!f,'missing buffer for attribute "'+e+'"',n.commandStr);var l=0|o.offset;xt.command(l>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var p=0|o.stride;xt.command(p>=0&&p<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var d=0|o.size;xt.command(!("size"in o)||d>0&&d<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var h=!!o.normalized,m=0;"type"in o&&(xt.commandParameter(o.type,xn,"invalid type for attribute "+e,n.commandStr),m=xn[o.type]);var v=0|o.divisor;"divisor"in o&&(xt.command(0===v||$,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),xt.command(v>=0,'invalid divisor for attribute "'+e+'"',n.commandStr)),xt.optional(function(){var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach(function(n){xt.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)})}),u.buffer=f,u.state=xo,u.size=d,u.normalized=h,u.type=m||f.dtype,u.offset=l,u.stride=p,u.divisor=v}}a[e]=Ue(function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach(function(e){r[e]=u[e]}),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r})}),Object.keys(o).forEach(function(e){function t(t,r){function i(e){r(f[e],"=",o,".",e,"|0;")}var o=t.invoke(r,n),a=t.shared,s=a.isBufferArgs,u=a.buffer;xt.optional(function(){t.assert(r,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+s+"("+o+")||"+u+".getBuffer("+o+")||"+u+".getBuffer("+o+".buffer)||"+s+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+a.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+e+'"')});var f={isStream:r.def(!1)},c=new Y;c.state=xo,Object.keys(c).forEach(function(e){f[e]=r.def(""+c[e])});var l=f.buffer,p=f.type;return r("if(",s,"(",o,")){",f.isStream,"=true;",l,"=",u,".createStream(",ya,",",o,");",p,"=",l,".dtype;","}else{",l,"=",u,".getBuffer(",o,");","if(",l,"){",p,"=",l,".dtype;",'}else if("constant" in ',o,"){",f.state,"=",_o,";","if(typeof "+o+'.constant === "number"){',f[bo[0]],"=",o,".constant;",bo.slice(1).map(function(e){return f[e]}).join("="),"=0;","}else{",bo.map(function(e,t){return f[e]+"="+o+".constant.length>="+t+"?"+o+".constant["+t+"]:0;"}).join(""),"}}else{","if(",s,"(",o,".buffer)){",l,"=",u,".createStream(",ya,",",o,".buffer);","}else{",l,"=",u,".getBuffer(",o,".buffer);","}",p,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",l,".dtype;",f.normalized,"=!!",o,".normalized;"),
i("size"),i("offset"),i("stride"),i("divisor"),r("}}"),r.exit("if(",f.isStream,"){",u,".destroyStream(",l,");","}"),f}var n=o[e];a[e]=We(n,t)}),a}function j(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=Ue(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=We(t,function(e,n){return e.invoke(n,t)})}),r}function O(e,t,n,r,i){function o(e){var t=f[e];t&&(l[e]=t)}var a=e.static,s=e.dynamic;xt.optional(function(){function e(e){Object.keys(e).forEach(function(e){xt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',i.commandStr)})}var t=[ta,na,ra,ia,oa,sa,aa,ua,ea].concat(te);e(a),e(s)});var u=x(e,i),f=_(e,u,i),c=S(e,i),l=A(e,i),p=w(e,i);o(Jo),o(m(Ko));var d=Object.keys(l).length>0,h={framebuffer:u,draw:c,shader:p,state:l,dirty:d};return h.profile=y(e,i),h.uniforms=k(n,i),h.attributes=E(t,i),h.context=j(r,i),h}function T(e,t,n){var r=e.shared,i=r.context,o=e.scope();Object.keys(n).forEach(function(r){t.save(i,"."+r);var a=n[r];o(i,".",r,"=",a.append(e,t),";")}),t(o)}function D(e,t,n,r){var i,o=e.shared,a=o.gl,s=o.framebuffer;K&&(i=t.def(o.extensions,".webgl_draw_buffers"));var u,f=e.constants,c=f.drawBuffer,l=f.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",cs,",",u,".framebuffer);"),K&&t(i,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",cs,",null);"),K&&t(i,".drawBuffersWEBGL(",l,");"),t("}",s,".cur=",u,";"),r||t("}")}function M(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,s=r.current,u=r.next,f=e.cond(s,".dirty");te.forEach(function(t){var r=m(t);if(!(r in n.state)){var c,l;if(r in a){c=a[r],l=o[r];var p=Z(J[r].length,function(e){return f.def(c,"[",e,"]")});f(e.cond(p.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",re[r],"(",p,");",p.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else{c=f.def(u,".",r);var d=e.cond(c,"!==",s,".",r);f(d),r in ne?d(e.cond(c).then(i,".enable(",ne[r],");").else(i,".disable(",ne[r],");"),s,".",r,"=",c,";"):d(i,".",re[r],"(",c,");",s,".",r,"=",c,";")}}}),0===Object.keys(n.state).length&&f(s,".dirty=false;"),t(f)}function C(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;Ve(Object.keys(n)).forEach(function(i){var u=n[i];if(!r||r(u)){var f=u.append(e,t);if(ne[i]){var c=ne[i];He(u)?f?t(s,".enable(",c,");"):t(s,".disable(",c,");"):t(e.cond(f).then(s,".enable(",c,");").else(s,".disable(",c,");")),t(a,".",i,"=",f,";")}else if(me(f)){var l=o[i];t(s,".",re[i],"(",f,");",f.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(s,".",re[i],"(",f,");",a,".",i,"=",f,";")}})}function P(e,t){$&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function z(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){f=t.def(),e(f,"=",o(),";"),"string"==typeof i?e(h,".count+=",i,";"):e(h,".count++;"),d&&(r?(c=t.def(),e(c,"=",v,".getNumPendingQueries();")):e(v,".beginQuery(",h,");"))}function s(e){e(h,".cpuTime+=",o(),"-",f,";"),d&&(r?e(v,".pushScopeStats(",c,",",v,".getNumPendingQueries(),",h,");"):e(v,".endQuery();"))}function u(e){var n=t.def(m,".profile");t(m,".profile=",e,";"),t.exit(m,".profile=",n,";")}var f,c,l,p=e.shared,h=e.stats,m=p.current,v=p.timer,g=n.profile;if(g){if(He(g))return void(g.enable?(a(t),s(t.exit),u("true")):u("false"));l=g.append(e,t),u(l)}else l=t.def(m,".profile");var b=e.block();a(b),t("if(",l,"){",b,"}");var y=e.block();s(y),t.exit("if(",l,"){",y,"}")}function L(e,t,n,r,i){function o(e){switch(e){case La:case Ra:case Ga:return 2;case Fa:case Na:case Ha:return 3;case Ia:case qa:case Ua:return 4;default:return 1}}function a(n,r,i){function o(){t("if(!",c,".buffer){",u,".enableVertexAttribArray(",f,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",c,".type!==",o,"||",c,".size!==",n,"||",h.map(function(e){return c+"."+e+"!=="+i[e]}).join("||"),"){",u,".bindBuffer(",ya,",",p,".buffer);",u,".vertexAttribPointer(",[f,n,o,i.normalized,i.stride,i.offset],");",c,".type=",o,";",c,".size=",n,";",h.map(function(e){return c+"."+e+"="+i[e]+";"}).join(""),"}"),$){var a=i.divisor;t("if(",c,".divisor!==",a,"){",e.instancing,".vertexAttribDivisorANGLE(",[f,a],");",c,".divisor=",a,";}")}}function a(){t("if(",c,".buffer){",u,".disableVertexAttribArray(",f,");","}if(",bo.map(function(e,t){return c+"."+e+"!=="+d[t]}).join("||"),"){",u,".vertexAttrib4f(",f,",",d,");",bo.map(function(e,t){return c+"."+e+"="+d[t]+";"}).join(""),"}")}var u=s.gl,f=t.def(n,".location"),c=t.def(s.attributes,"[",f,"]"),l=i.state,p=i.buffer,d=[i.x,i.y,i.z,i.w],h=["buffer","normalized","offset","stride"];l===xo?o():l===_o?a():(t("if(",l,"===",xo,"){"),o(),t("}else{"),a(),t("}"))}var s=e.shared;r.forEach(function(r){var s,u=r.name,f=n.attributes[u];if(f){if(!i(f))return;s=f.append(e,t)}else{if(!i(bs))return;var c=e.scopeAttrib(u);xt.optional(function(){e.assert(t,c+".state","missing attribute "+u)}),s={},Object.keys(new Y).forEach(function(e){s[e]=t.def(c,".",e)})}a(e.link(r),o(r.info.type),s)})}function F(e,n,r,i,o){for(var a,s=e.shared,u=s.gl,f=0;f<i.length;++f){var c,l=i[f],p=l.name,d=l.info.type,h=r.uniforms[p],m=e.link(l),v=m+".location";if(h){if(!o(h))continue;if(He(h)){var g=h.value;if(xt.command(null!==g&&"undefined"!=typeof g,'missing uniform "'+p+'"',e.commandStr),d===Xa||d===Za){xt.command("function"==typeof g&&(d===Xa&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||d===Za&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+p,e.commandStr);var b=e.link(g._texture||g.color[0]._texture);n(u,".uniform1i(",v,",",b+".bind());"),n.exit(b,".unbind();")}else if(d===Wa||d===Qa||d===Ya){xt.optional(function(){xt.command(me(g),"invalid matrix for uniform "+p,e.commandStr),xt.command(d===Wa&&4===g.length||d===Qa&&9===g.length||d===Ya&&16===g.length,"invalid length for matrix uniform "+p,e.commandStr)});var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),x=2;d===Qa?x=3:d===Ya&&(x=4),n(u,".uniformMatrix",x,"fv(",v,",false,",y,");")}else{switch(d){case za:xt.commandType(g,"number","uniform "+p,e.commandStr),a="1f";break;case La:xt.command(me(g)&&2===g.length,"uniform "+p,e.commandStr),a="2f";break;case Fa:xt.command(me(g)&&3===g.length,"uniform "+p,e.commandStr),a="3f";break;case Ia:xt.command(me(g)&&4===g.length,"uniform "+p,e.commandStr),a="4f";break;case Va:xt.commandType(g,"boolean","uniform "+p,e.commandStr),a="1i";break;case Ba:xt.commandType(g,"number","uniform "+p,e.commandStr),a="1i";break;case Ga:xt.command(me(g)&&2===g.length,"uniform "+p,e.commandStr),a="2i";break;case Ra:xt.command(me(g)&&2===g.length,"uniform "+p,e.commandStr),a="2i";break;case Ha:xt.command(me(g)&&3===g.length,"uniform "+p,e.commandStr),a="3i";break;case Na:xt.command(me(g)&&3===g.length,"uniform "+p,e.commandStr),a="3i";break;case Ua:xt.command(me(g)&&4===g.length,"uniform "+p,e.commandStr),a="4i";break;case qa:xt.command(me(g)&&4===g.length,"uniform "+p,e.commandStr),a="4i"}n(u,".uniform",a,"(",v,",",me(g)?Array.prototype.slice.call(g):g,");")}continue}c=h.append(e,n)}else{if(!o(bs))continue;c=n.def(s.uniforms,"[",t.id(p),"]")}d===Xa?n("if(",c,"&&",c,'._reglType==="framebuffer"){',c,"=",c,".color[0];","}"):d===Za&&n("if(",c,"&&",c,'._reglType==="framebufferCube"){',c,"=",c,".color[0];","}"),xt.optional(function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+p+'".  '+r)}function r(e){t("typeof "+c+'==="'+e+'"',"invalid type, expected "+e)}function i(n,r){t(s.isArrayLike+"("+c+")&&"+c+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function o(n){t("typeof "+c+'==="function"&&'+c+'._reglType==="texture'+(n===Sa?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(d){case Ba:r("number");break;case Ra:i(2,"number");break;case Na:i(3,"number");break;case qa:i(4,"number");break;case za:r("number");break;case La:i(2,"number");break;case Fa:i(3,"number");break;case Ia:i(4,"number");break;case Va:r("boolean");break;case Ga:i(2,"boolean");break;case Ha:i(3,"boolean");break;case Ua:i(4,"boolean");break;case Wa:i(4,"number");break;case Qa:i(9,"number");break;case Ya:i(16,"number");break;case Xa:o(Sa);break;case Za:o(Aa)}});var _=1;switch(d){case Xa:case Za:var w=n.def(c,"._texture");n(u,".uniform1i(",v,",",w,".bind());"),n.exit(w,".unbind();");continue;case Ba:case Va:a="1i";break;case Ra:case Ga:a="2i",_=2;break;case Na:case Ha:a="3i",_=3;break;case qa:case Ua:a="4i",_=4;break;case za:a="1f";break;case La:a="2f",_=2;break;case Fa:a="3f",_=3;break;case Ia:a="4f",_=4;break;case Wa:a="Matrix2fv";break;case Qa:a="Matrix3fv";break;case Ya:a="Matrix4fv"}if(n(u,".uniform",a,"(",v,","),"M"===a.charAt(0)){var S=Math.pow(d-Wa+2,2),A=e.global.def("new Float32Array(",S,")");n("false,(Array.isArray(",c,")||",c," instanceof Float32Array)?",c,":(",Z(S,function(e){return A+"["+e+"]="+c+"["+e+"]"}),",",A,")")}else n(_>1?Z(_,function(e){return c+"["+e+"]"}):c);n(");")}}function I(e,t,n,r){function i(){var i,o=p.elements,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a)):i=a.def(l,".",ia),i&&a("if("+i+")"+c+".bindBuffer("+xa+","+i+".buffer.buffer);"),i}function o(){var i,o=p.count,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a),xt.optional(function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(a,i+">=0","missing vertex count")})):(i=a.def(l,".",aa),xt.optional(function(){e.assert(a,i+">=0","missing vertex count")})),i}function a(i){var o=p[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(l,".",i)}function s(){function e(){n(b,".drawElementsInstancedANGLE(",[h,v,y,m+"<<(("+y+"-"+yo+")>>1)",g],");")}function t(){n(b,".drawArraysInstancedANGLE(",[h,m,v,g],");")}d?x?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}function u(){function e(){n(c+".drawElements("+[h,v,y,m+"<<(("+y+"-"+yo+")>>1)"]+");")}function t(){n(c+".drawArrays("+[h,m,v]+");")}d?x?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}var f=e.shared,c=f.gl,l=f.draw,p=r.draw,d=i(),h=a(oa),m=a(sa),v=o();if("number"==typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");var g,b;$&&(g=a(ua),b=e.instancing);var y=d+".type",x=p.elements&&He(p.elements);$&&("number"!=typeof g||g>=0)?"string"==typeof g?(n("if(",g,">0){"),s(),n("}else if(",g,"<0){"),u(),n("}")):s():u()}function B(e,t,n,r,i){var o=b(),a=o.proc("body",i);return xt.optional(function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)}),$&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function R(e,t,n,r){P(e,t),L(e,t,n,r.attributes,function(){return!0}),F(e,t,n,r.uniforms,function(){return!0}),I(e,t,t,n)}function N(e,t){var n=e.proc("draw",1);P(e,n),T(e,n,t.context),D(e,n,t.framebuffer),M(e,n,t),C(e,n,t.state),z(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)R(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return B(R,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function q(e,t,n,r){function i(){return!0}e.batchId="a1",P(e,t),L(e,t,n,r.attributes,i),F(e,t,n,r.uniforms,i),I(e,t,t,n)}function V(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}P(e,t);var a=n.contextDep,s=t.def(),u="a0",f="a1",c=t.def();e.shared.props=c,e.batchId=s;var l=e.scope(),p=e.scope();if(t(l.entry,"for(",s,"=0;",s,"<",f,";++",s,"){",c,"=",u,"[",s,"];",p,"}",l.exit),n.needsContext&&T(e,p,n.context),n.needsFramebuffer&&D(e,p,n.framebuffer),C(e,p,n.state,i),n.profile&&i(n.profile)&&z(e,p,n,!1,!0),r)L(e,l,n,r.attributes,o),L(e,p,n,r.attributes,i),F(e,l,n,r.uniforms,o),F(e,p,n,r.uniforms,i),I(e,l,p,n);else{var d=e.global.def("{}"),h=n.shader.progVar.append(e,p),m=p.def(h,".id"),v=p.def(d,"[",m,"]");p(e.shared.gl,".useProgram(",h,".program);","if(!",v,"){",v,"=",d,"[",m,"]=",e.link(function(t){return B(q,e,n,t,2)}),"(",h,");}",v,".call(this,a0[",s,"],",s,");")}}function G(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",P(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(T(e,r,t.context),o=!1);var a=t.framebuffer,s=!1;a?(a.propDep?i=s=!0:a.contextDep&&i&&(s=!0),s||D(e,r,a)):D(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),M(e,r,t),C(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||z(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=s;var u=t.shader.progVar;if(u.contextDep&&i||u.propDep)V(e,r,t,null);else{var f=u.append(e,r);if(r(e.shared.gl,".useProgram(",f,".program);"),t.shader.program)V(e,r,t,t.shader.program);else{var c=e.global.def("{}"),l=r.def(f,".id"),p=r.def(c,"[",l,"]");r(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",c,"[",l,"]=",e.link(function(n){return B(V,e,t,n,2)}),"(",f,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function H(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;T(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),Ve(Object.keys(n.state)).forEach(function(t){var r=n.state[t],a=r.append(e,i);me(a)?a.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,a)}),z(e,i,n,!0,!0),[ia,sa,aa,ua,oa].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new Y).forEach(function(e){i.set(o,"."+e,r[e])})}),r(na),r(ra),Object.keys(n.state).length>0&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function U(e){if("object"==typeof e&&!me(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(St.isDynamic(e[t[n]]))return!0;return!1}}function W(e,t,n){function r(e,t){a.forEach(function(n){var r=i[n];if(St.isDynamic(r)){var o=e.invoke(t,r);t(c,".",n,"=",o,";")}})}var i=t.static[n];if(i&&U(i)){var o=e.global,a=Object.keys(i),s=!1,u=!1,f=!1,c=e.global.def("{}");a.forEach(function(t){var n=i[t];if(St.isDynamic(n)){"function"==typeof n&&(n=i[t]=St.unbox(n));var r=We(n,null);s=s||r.thisDep,f=f||r.propDep,u=u||r.contextDep}else{switch(o(c,".",t,"="),typeof n){case"number":o(n);break;case"string":o('"',n,'"');break;case"object":Array.isArray(n)&&o("[",n.join(),"]");break;default:o(e.link(n))}o(";")}}),t.dynamic[n]=new St.DynamicVariable(Eo,{thisDep:s,contextDep:u,propDep:f,ref:c,append:r}),delete t.static[n]}}function Q(e,t,n,r,i){var o=b();o.stats=o.link(i),Object.keys(t.static).forEach(function(e){W(o,t,e)}),ba.forEach(function(t){W(o,e,t)});var a=O(e,t,n,r,o);return N(o,a),H(o,a),G(o,a),o.compile()}var Y=f.Record,X={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(X.min=ns,X.max=rs);var $=n.angle_instanced_arrays,K=n.webgl_draw_buffers,J={dirty:!0,profile:h.profile},ee={},te=[],ne={},re={};v(jo,ja),v(Oo,Ea),g(To,"blendColor",[0,0,0,0]),g(Do,"blendEquationSeparate",[us,us]),g(Mo,"blendFuncSeparate",[ss,as,ss,as]),v(Co,Ta,!0),g(Po,"depthFunc",fs),g(zo,"depthRange",[0,1]),g(Lo,"depthMask",!0),g(Fo,Fo,[!0,!0,!0,!0]),v(Io,ka),g(Bo,"cullFace",Ja),g(Ro,Ro,ts),g(No,No,1),v(qo,Ma),g(Vo,"polygonOffset",[0,0]),v(Go,Ca),v(Ho,Pa),g(Uo,"sampleCoverage",[1,!1]),v(Wo,Oa),g(Qo,"stencilMask",-1),g(Yo,"stencilFunc",[is,0,-1]),g(Xo,"stencilOpSeparate",[Ka,os,os,os]),g(Zo,"stencilOpSeparate",[Ja,os,os,os]),v($o,Da),g(Ko,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),g(Jo,Jo,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ie={gl:e,context:p,strings:t,next:ee,current:J,draw:l,elements:o,buffer:i,shader:c,attributes:f.state,uniforms:u,framebuffer:s,extensions:n,timer:d,isBufferArgs:qe},oe={primTypes:In,compareFuncs:hs,blendFuncs:ps,blendEquations:X,stencilOps:ms,glTypes:xn,orientationType:gs};xt.optional(function(){ie.isArrayLike=me}),K&&(oe.backBuffer=[Ja],oe.drawBuffer=Z(r.maxDrawbuffers,function(e){return 0===e?[0]:Z(e,function(e){return ls+e})}));var ae=0;return{next:ee,current:J,procs:function(){var t=b(),n=t.proc("poll"),i=t.proc("refresh"),o=t.block();n(o),i(o);var a=t.shared,s=a.gl,u=a.next,f=a.current;o(f,".dirty=false;"),D(t,n),D(t,i,null,!0);var c,l=e.getExtension("angle_instanced_arrays");l&&(c=t.link(l));for(var p=0;p<r.maxAttributes;++p){var d=i.def(a.attributes,"[",p,"]"),h=t.cond(d,".buffer");h.then(s,".enableVertexAttribArray(",p,");",s,".bindBuffer(",ya,",",d,".buffer.buffer);",s,".vertexAttribPointer(",p,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(s,".disableVertexAttribArray(",p,");",s,".vertexAttrib4f(",p,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),i(h),l&&i(c,".vertexAttribDivisorANGLE(",p,",",d,".divisor);")}return Object.keys(ne).forEach(function(e){var r=ne[e],a=o.def(u,".",e),c=t.block();c("if(",a,"){",s,".enable(",r,")}else{",s,".disable(",r,")}",f,".",e,"=",a,";"),i(c),n("if(",a,"!==",f,".",e,"){",c,"}")}),Object.keys(re).forEach(function(e){var r,a,c=re[e],l=J[e],p=t.block();if(p(s,".",c,"("),me(l)){var d=l.length;r=t.global.def(u,".",e),a=t.global.def(f,".",e),p(Z(d,function(e){return r+"["+e+"]"}),");",Z(d,function(e){return a+"["+e+"]="+r+"["+e+"];"}).join("")),n("if(",Z(d,function(e){return r+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",p,"}")}else r=o.def(u,".",e),a=o.def(f,".",e),p(r,");",f,".",e,"=",r,";"),n("if(",r,"!==",a,"){",p,"}");i(p)}),t.compile()}(),compile:Q}}function Ye(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function Xe(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function Ze(e){function t(){if(0===H.length)return A&&A.update(),void(Z=null);Z=At.next(t),p();for(var e=H.length-1;e>=0;--e){var n=H[e];n&&n(O,null,0)}g.flush(),A&&A.update()}function n(){!Z&&H.length>0&&(Z=At.next(t))}function r(){Z&&(At.cancel(t),Z=null)}function i(e){e.preventDefault(),y=!0,r(),U.forEach(function(e){e()})}function o(e){g.getError(),y=!1,x.restore(),L.restore(),C.restore(),F.restore(),I.restore(),B.restore(),A&&A.restore(),R.procs.refresh(),n(),W.forEach(function(e){e()})}function a(){H.length=0,r(),G&&(G.removeEventListener(js,i),G.removeEventListener(Os,o)),L.clear(),B.clear(),I.clear(),F.clear(),P.clear(),C.clear(),A&&A.clear(),X.forEach(function(e){e()})}function s(e){function t(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=Je({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}function n(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];St.isDynamic(i)?n[r]=St.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}function r(e){for(;h.length<e;)h.push(null);return h}function i(e,t){var n;if(y&&xt.raise("context lost"),"function"==typeof e)return d.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e){for(n=0;n<e;++n)d.call(this,null,t,n);return}if(Array.isArray(e)){for(n=0;n<e.length;++n)d.call(this,e[n],t,n);return}return d.call(this,e,t,0)}if("number"==typeof e){if(e>0)return p.call(this,r(0|e),0|e)}else{if(!Array.isArray(e))return l.call(this,e);if(e.length)return p.call(this,e,e.length)}}xt(!!e,"invalid args to regl({...})"),xt.type(e,"object","invalid args to regl({...})");var o=n(e.context||{}),a=n(e.uniforms||{}),s=n(e.attributes||{}),u=n(t(e)),f={gpuTime:0,cpuTime:0,count:0},c=R.compile(u,s,a,o,f),l=c.draw,p=c.batch,d=c.scope,h=[];return Je(i,{stats:f})}function u(e,t){var n=0;R.procs.poll();var r=t.color;r&&(g.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=Ss),"depth"in t&&(g.clearDepth(+t.depth),n|=As),"stencil"in t&&(g.clearStencil(0|t.stencil),n|=ks),xt(!!n,"called regl.clear with no buffer specified"),g.clear(n)}function f(e){if(xt("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)$(Je({framebuffer:e.framebuffer.faces[t]},e),u);else $(e,u);else u(null,e)}function c(e){function t(){function t(){var e=Xe(H,t);H[e]=H[H.length-1],H.length-=1,H.length<=0&&r()}var n=Xe(H,e);xt(n>=0,"cannot cancel a frame twice"),H[n]=t}return xt.type(e,"function","regl.frame() callback must be a function"),H.push(e),n(),{cancel:t}}function l(){var e=V.viewport,t=V.scissor_box;e[0]=e[1]=t[0]=t[1]=0,O.viewportWidth=O.framebufferWidth=O.drawingBufferWidth=e[2]=t[2]=g.drawingBufferWidth,O.viewportHeight=O.framebufferHeight=O.drawingBufferHeight=e[3]=t[3]=g.drawingBufferHeight}function p(){O.tick+=1,O.time=h(),l(),R.procs.poll()}function d(){l(),R.procs.refresh(),A&&A.update()}function h(){return(kt()-k)/1e3}function m(e,t){xt.type(t,"function","listener callback must be a function");var n;switch(e){case"frame":return c(t);case"lost":n=U;break;case"restore":n=W;break;case"destroy":n=X;break;default:xt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}var v=Q(e);if(!v)return null;var g=v.gl,b=g.getContextAttributes(),y=g.isContextLost(),x=Y(g,v);if(!x)return null;var _=N(),w=Ye(),S=x.extensions,A=ws(g,S),k=kt(),E=g.drawingBufferWidth,j=g.drawingBufferHeight,O={tick:0,time:0,viewportWidth:E,viewportHeight:j,framebufferWidth:E,framebufferHeight:j,drawingBufferWidth:E,drawingBufferHeight:j,pixelRatio:v.pixelRatio},T={},D={elements:null,primitive:4,count:-1,offset:0,instances:-1},M=Jt(g,S),C=pe(g,w,v),P=de(g,S,C,w),z=Le(g,S,M,C,_),L=Fe(g,_,w,v),F=Me(g,S,M,function(){R.procs.poll()},O,w,v),I=Oi(g,S,M,w,v),B=Pe(g,S,M,F,I,w),R=Qe(g,_,S,M,C,P,F,B,T,z,L,D,O,A,v),q=Ie(g,B,R.procs.poll,O,b,S),V=R.next,G=g.canvas,H=[],U=[],W=[],X=[v.onDestroy],Z=null;G&&(G.addEventListener(js,i,!1),G.addEventListener(Os,o,!1));var $=B.setFBO=s({framebuffer:St.define.call(null,Ts,"framebuffer")});d();var K=Je(s,{clear:f,prop:St.define.bind(null,Ts),context:St.define.bind(null,Ds),this:St.define.bind(null,Ms),draw:s({}),buffer:function(e){return C.create(e,Es,!1,!1)},elements:function(e){return P.create(e,!1)},texture:F.create2D,cube:F.createCube,renderbuffer:I.create,framebuffer:B.create,framebufferCube:B.createCube,attributes:b,frame:c,on:m,limits:M,hasExtension:function(e){return M.extensions.indexOf(e.toLowerCase())>=0},read:q,destroy:a,_gl:g,_refresh:d,poll:function(){p(),A&&A.update()},now:h,stats:w});return v.onDone(null,K),K}var $e={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ke=function(e){return Object.prototype.toString.call(e)in $e},Je=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},et=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],tt=33071,nt=9728,rt=9984,it=9985,ot=9986,at=9987,st=5120,ut=5121,ft=5122,ct=5123,lt=5124,pt=5125,dt=5126,ht=32819,mt=32820,vt=33635,gt=34042,bt=36193,yt={};yt[st]=yt[ut]=1,yt[ft]=yt[ct]=yt[bt]=yt[vt]=yt[ht]=yt[mt]=2,yt[lt]=yt[pt]=yt[dt]=yt[gt]=4;var xt=Je(n,{optional:j,raise:t,commandRaise:S,command:A,parameter:i,commandParameter:k,constructor:f,type:a,commandType:E,isTypedArray:o,nni:s,oneOf:u,shaderError:y,linkError:x,callSite:m,saveCommandRef:_,saveDrawInfo:w,framebufferFormat:O,guessCommand:h,texture2D:M,textureCube:C}),_t=0,wt=0,St={DynamicVariable:P,define:I,isDynamic:B,unbox:R,accessor:F},At={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},kt="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Et=3408,jt=3410,Ot=3411,Tt=3412,Dt=3413,Mt=3414,Ct=3415,Pt=33901,zt=33902,Lt=3379,Ft=3386,It=34921,Bt=36347,Rt=36348,Nt=35661,qt=35660,Vt=34930,Gt=36349,Ht=34076,Ut=34024,Wt=7936,Qt=7937,Yt=7938,Xt=35724,Zt=34047,$t=36063,Kt=34852,Jt=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(Zt));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(Kt),i=e.getParameter($t)),{colorBits:[e.getParameter(jt),e.getParameter(Ot),e.getParameter(Tt),e.getParameter(Dt)],depthBits:e.getParameter(Mt),stencilBits:e.getParameter(Ct),subpixelBits:e.getParameter(Et),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(Pt),lineWidthDims:e.getParameter(zt),maxViewportDims:e.getParameter(Ft),maxCombinedTextureUnits:e.getParameter(Nt),maxCubeMapSize:e.getParameter(Ht),maxRenderbufferSize:e.getParameter(Ut),maxTextureUnits:e.getParameter(Vt),maxTextureSize:e.getParameter(Lt),maxAttributes:e.getParameter(It),maxVertexUniforms:e.getParameter(Bt),maxVertexTextureUnits:e.getParameter(qt),maxVaryingVectors:e.getParameter(Rt),maxFragmentUniforms:e.getParameter(Gt),glsl:e.getParameter(Xt),renderer:e.getParameter(Qt),vendor:e.getParameter(Wt),version:e.getParameter(Yt)}},en=function(e){return Object.keys(e).map(function(t){return e[t]})},tn=5120,nn=5121,rn=5122,on=5123,an=5124,sn=5125,un=5126,fn=Z(8,function(){return[]}),cn={alloc:J,free:ee,allocType:te,freeType:ne},ln={shape:ue,flatten:se},pn=5120,dn=5122,hn=5124,mn=5121,vn=5123,gn=5125,bn=5126,yn=5126,xn={int8:pn,int16:dn,int32:hn,uint8:mn,uint16:vn,uint32:gn,float:bn,float32:yn},_n=35048,wn=35040,Sn={dynamic:_n,stream:wn,static:35044},An=ln.flatten,kn=ln.shape,En=35044,jn=35040,On=5121,Tn=5126,Dn=[];Dn[5120]=1,Dn[5122]=2,Dn[5124]=4,Dn[5121]=1,Dn[5123]=2,Dn[5125]=4,Dn[5126]=4;var Mn=0,Cn=0,Pn=1,zn=1,Ln=4,Fn=4,In={points:Mn,point:Cn,lines:Pn,line:zn,triangles:Ln,triangle:Fn,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Bn=0,Rn=1,Nn=4,qn=5120,Vn=5121,Gn=5122,Hn=5123,Un=5124,Wn=5125,Qn=34963,Yn=35040,Xn=35044,Zn=new Float32Array(1),$n=new Uint32Array(Zn.buffer),Kn=5123,Jn=34467,er=3553,tr=34067,nr=34069,rr=6408,ir=6406,or=6407,ar=6409,sr=6410,ur=32854,fr=32855,cr=36194,lr=32819,pr=32820,dr=33635,hr=34042,mr=6402,vr=34041,gr=35904,br=35906,yr=36193,xr=33776,_r=33777,wr=33778,Sr=33779,Ar=35986,kr=35987,Er=34798,jr=35840,Or=35841,Tr=35842,Dr=35843,Mr=36196,Cr=5121,Pr=5123,zr=5125,Lr=5126,Fr=10242,Ir=10243,Br=10497,Rr=33071,Nr=33648,qr=10240,Vr=10241,Gr=9728,Hr=9729,Ur=9984,Wr=9985,Qr=9986,Yr=9987,Xr=33170,Zr=4352,$r=4353,Kr=4354,Jr=34046,ei=3317,ti=37440,ni=37441,ri=37443,ii=37444,oi=33984,ai=[Ur,Qr,Wr,Yr],si=[0,ar,sr,or,rr],ui={};ui[ar]=ui[ir]=ui[mr]=1,ui[vr]=ui[sr]=2,ui[or]=ui[gr]=3,ui[rr]=ui[br]=4;var fi=ve("HTMLCanvasElement"),ci=ve("CanvasRenderingContext2D"),li=ve("HTMLImageElement"),pi=ve("HTMLVideoElement"),di=Object.keys($e).concat([fi,ci,li,pi]),hi=[];hi[Cr]=1,hi[Lr]=4,hi[yr]=2,hi[Pr]=2,hi[zr]=4;var mi=[];mi[ur]=2,mi[fr]=2,mi[cr]=2,mi[vr]=4,mi[xr]=.5,mi[_r]=.5,mi[wr]=1,mi[Sr]=1,mi[Ar]=.5,mi[kr]=1,mi[Er]=1,mi[jr]=.5,mi[Or]=.25,mi[Tr]=.5,mi[Dr]=.25,mi[Mr]=.5;var vi=36161,gi=32854,bi=32855,yi=36194,xi=33189,_i=36168,wi=34041,Si=35907,Ai=34836,ki=34842,Ei=34843,ji=[];ji[gi]=2,ji[bi]=2,ji[yi]=2,ji[xi]=2,ji[_i]=1,ji[wi]=4,ji[Si]=4,ji[Ai]=16,ji[ki]=8,ji[Ei]=6;var Oi=function(e,t,n,r,i){function o(e){this.id=l++,this.refCount=1,this.renderbuffer=e,this.format=gi,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;xt(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(vi,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete p[t.id],r.renderbufferCount--}function s(t,a){function s(t,r){var o=0,a=0,u=gi;if("object"==typeof t&&t){var p=t;if("shape"in p){var d=p.shape;xt(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),o=0|d[0],a=0|d[1]}else"radius"in p&&(o=a=0|p.radius),"width"in p&&(o=0|p.width),"height"in p&&(a=0|p.height);"format"in p&&(xt.parameter(p.format,f,"invalid renderbuffer format"),u=f[p.format])}else"number"==typeof t?(o=0|t,a="number"==typeof r?0|r:o):t?xt.raise("invalid arguments to renderbuffer constructor"):o=a=1;if(xt(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),o!==l.width||a!==l.height||u!==l.format)return s.width=l.width=o,s.height=l.height=a,l.format=u,e.bindRenderbuffer(vi,l.renderbuffer),e.renderbufferStorage(vi,u,o,a),i.profile&&(l.stats.size=Ce(l.format,l.width,l.height)),s.format=c[l.format],s}function u(t,r){var o=0|t,a=0|r||o;return o===l.width&&a===l.height?s:(xt(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),s.width=l.width=o,s.height=l.height=a,e.bindRenderbuffer(vi,l.renderbuffer),e.renderbufferStorage(vi,l.format,o,a),i.profile&&(l.stats.size=Ce(l.format,l.width,l.height)),s)}var l=new o(e.createRenderbuffer());return p[l.id]=l,r.renderbufferCount++,s(t,a),s.resize=u,s._reglType="renderbuffer",s._renderbuffer=l,i.profile&&(s.stats=l.stats),s.destroy=function(){l.decRef()},s}function u(){en(p).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(vi,t.renderbuffer),e.renderbufferStorage(vi,t.format,t.width,t.height)}),e.bindRenderbuffer(vi,null)}var f={rgba4:gi,rgb565:yi,"rgb5 a1":bi,depth:xi,stencil:_i,"depth stencil":wi};t.ext_srgb&&(f.srgba=Si),t.ext_color_buffer_half_float&&(f.rgba16f=ki,f.rgb16f=Ei),t.webgl_color_buffer_float&&(f.rgba32f=Ai);var c=[];Object.keys(f).forEach(function(e){var t=f[e];c[t]=e});var l=0,p={};return o.prototype.decRef=function(){--this.refCount<=0&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(p).forEach(function(t){e+=p[t].stats.size}),e}),{create:s,clear:function(){en(p).forEach(a)},restore:u}},Ti=36160,Di=36161,Mi=3553,Ci=34069,Pi=36064,zi=36096,Li=36128,Fi=33306,Ii=36053,Bi=36054,Ri=36055,Ni=36057,qi=36061,Vi=36193,Gi=5121,Hi=5126,Ui=6408,Wi=6402,Qi=[Ui],Yi=[];Yi[Ui]=4;var Xi=[];Xi[Gi]=1,Xi[Hi]=4,Xi[Vi]=2;var Zi=32854,$i=32855,Ki=36194,Ji=33189,eo=36168,to=34041,no=35907,ro=34836,io=34842,oo=34843,ao=[Zi,$i,Ki,no,io,oo,ro],so={};so[Ii]="complete",so[Bi]="incomplete attachment",so[Ni]="incomplete dimensions",so[Ri]="incomplete, missing attachment",so[qi]="unsupported";var uo=5126,fo=35632,co=35633,lo=35718,po=35721,ho=6408,mo=5121,vo=3333,go=5126,bo="xyzw".split(""),yo=5121,xo=1,_o=2,wo=0,So=1,Ao=2,ko=3,Eo=4,jo="dither",Oo="blend.enable",To="blend.color",Do="blend.equation",Mo="blend.func",Co="depth.enable",Po="depth.func",zo="depth.range",Lo="depth.mask",Fo="colorMask",Io="cull.enable",Bo="cull.face",Ro="frontFace",No="lineWidth",qo="polygonOffset.enable",Vo="polygonOffset.offset",Go="sample.alpha",Ho="sample.enable",Uo="sample.coverage",Wo="stencil.enable",Qo="stencil.mask",Yo="stencil.func",Xo="stencil.opFront",Zo="stencil.opBack",$o="scissor.enable",Ko="scissor.box",Jo="viewport",ea="profile",ta="framebuffer",na="vert",ra="frag",ia="elements",oa="primitive",aa="count",sa="offset",ua="instances",fa="Width",ca="Height",la=ta+fa,pa=ta+ca,da=Jo+fa,ha=Jo+ca,ma="drawingBuffer",va=ma+fa,ga=ma+ca,ba=[Mo,Do,Yo,Xo,Zo,Uo,Jo,Ko,Vo],ya=34962,xa=34963,_a=35632,wa=35633,Sa=3553,Aa=34067,ka=2884,Ea=3042,ja=3024,Oa=2960,Ta=2929,Da=3089,Ma=32823,Ca=32926,Pa=32928,za=5126,La=35664,Fa=35665,Ia=35666,Ba=5124,Ra=35667,Na=35668,qa=35669,Va=35670,Ga=35671,Ha=35672,Ua=35673,Wa=35674,Qa=35675,Ya=35676,Xa=35678,Za=35680,$a=4,Ka=1028,Ja=1029,es=2304,ts=2305,ns=32775,rs=32776,is=519,os=7680,as=0,ss=1,us=32774,fs=513,cs=36160,ls=36064,ps={
0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ds=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],hs={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ms={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},vs={frag:_a,vert:wa},gs={cw:es,ccw:ts},bs=new Ge(!1,!1,!1,function(){}),ys=34918,xs=34919,_s=35007,ws=function(e,t){function n(){return p.pop()||l.createQueryEXT()}function r(e){p.push(e)}function i(e){var t=n();l.beginQueryEXT(_s,t),d.push(t),f(d.length-1,d.length,e)}function o(){l.endQueryEXT(_s)}function a(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function s(){return h.pop()||new a}function u(e){h.push(e)}function f(e,t,n){var r=s();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,m.push(r)}function c(){var e,t,n=d.length;if(0!==n){g.length=Math.max(g.length,n+1),v.length=Math.max(v.length,n+1),v[0]=0,g[0]=0;var i=0;for(e=0,t=0;t<d.length;++t){var o=d[t];l.getQueryObjectEXT(o,xs)?(i+=l.getQueryObjectEXT(o,ys),r(o)):d[e++]=o,v[t+1]=i,g[t+1]=e}for(d.length=e,e=0,t=0;t<m.length;++t){var a=m[t],s=a.startQueryIndex,f=a.endQueryIndex;a.sum+=v[f]-v[s];var c=g[s],p=g[f];p===c?(a.stats.gpuTime+=a.sum/1e6,u(a)):(a.startQueryIndex=c,a.endQueryIndex=p,m[e++]=a)}m.length=e}}var l=t.ext_disjoint_timer_query;if(!l)return null;var p=[],d=[],h=[],m=[],v=[],g=[];return{beginQuery:i,endQuery:o,pushScopeStats:f,update:c,getNumPendingQueries:function(){return d.length},clear:function(){p.push.apply(p,d);for(var e=0;e<p.length;e++)l.deleteQueryEXT(p[e]);d.length=0,p.length=0},restore:function(){d.length=0,p.length=0}}},Ss=16384,As=256,ks=1024,Es=34962,js="webglcontextlost",Os="webglcontextrestored",Ts=1,Ds=2,Ms=3;return Ze})},{}],174:[function(e,t,n){function r(e){throw new Error("resl: "+e)}function i(e,t,n){Object.keys(e).forEach(function(e){t.indexOf(e)<0&&r('invalid parameter "'+e+'" in '+n)})}function o(e,t){this.state=c,this.ready=!1,this.progress=0,this.name=e,this.cancel=t}var a=["manifest","onDone","onProgress","onError"],s=["type","src","stream","credentials","parser"],u=["onData","onDone"],f=-1,c=0,l=1;t.exports=function(e){function t(t,n){if(t in e){var i=e[t];return"function"!=typeof i&&r('invalid callback "'+t+'"'),i}return null}function n(e){function t(){if(!(u.readyState<2||m.state===l||m.state===f)){if(200!==u.status)return d('error loading resource "'+e.name+'"');if(u.readyState>2&&m.state===c){var t;if(t="binary"===e.type?u.response:u.responseText,s.data)try{p=s.data(t)}catch(e){return d(e)}else p=t}if(u.readyState>3&&m.state===c){if(s.done)try{p=s.done()}catch(e){return d(e)}m.state=l}y[r]=p,m.progress=.75*m.progress+.25,m.ready=e.stream&&!!p||m.state===l,h()}}function n(){m.state!==l&&m.state!==f&&(u.onreadystatechange=null,u.abort(),m.state=f)}var r=e.name,i=e.stream,a="binary"===e.type,s=e.parser,u=new XMLHttpRequest,p=null,m=new o(r,n);return i?u.onreadystatechange=t:u.onreadystatechange=function(){4===u.readyState&&t()},a&&(u.responseType="arraybuffer"),e.credentials&&(u.withCredentials=!0),u.open("GET",e.src,!0),u.send(),m}function p(e,t){function n(){if(v.state===c)if(m.data)try{g=m.data(t)}catch(e){return d(e)}else g=t}function r(e){n(),y[p]=g,e.lengthComputable?v.progress=Math.max(v.progress,e.loaded/e.total):v.progress=.75*v.progress+.25,h(p)}function i(){if(n(),v.state===c){if(m.done)try{g=m.done()}catch(e){return d(e)}v.state=l}v.progress=1,v.ready=!0,y[p]=g,s(),h("finish "+p)}function a(){d('error loading asset "'+p+'"')}function s(){e.stream&&t.removeEventListener("progress",r),"image"===e.type?t.addEventListener("load",i):t.addEventListener("canplay",i),t.removeEventListener("error",a)}function u(){v.state!==l&&v.state!==f&&(v.state=f,s(),t.src="")}var p=e.name,m=e.parser,v=new o(p,u),g=t;if(e.stream&&t.addEventListener("progress",r),"image"===e.type)t.addEventListener("load",i);else{var b=!1,x=!1;t.addEventListener("loadedmetadata",function(){x=!0,b&&i()}),t.addEventListener("canplay",function(){b=!0,x&&i()})}return t.addEventListener("error",a),e.credentials?t.crossOrigin="use-credentials":t.crossOrigin="anonymous",t.src=e.src,v}function d(e){x!==f&&x!==l&&(x=f,w.forEach(function(e){e.cancel()}),b?b("string"==typeof e?new Error("resl: "+e):e):console.error("resl error:",e))}function h(e){if(x!==f&&x!==l){var t=0,n=0;w.forEach(function(e){e.ready&&(n+=1),t+=e.progress}),n===w.length?(x=l,v(y)):g&&g(t/w.length,e)}}"object"==typeof e&&e||r("invalid or missing configuration"),i(e,a,"config");var m=e.manifest;"object"==typeof m&&m||r("missing manifest");var v=t("onDone");v||r("missing onDone() callback");var g=t("onProgress"),b=t("onError"),y={},x=c,_={text:n,binary:function(e){return n(e)},image:function(e){return p(e,document.createElement("img"))},video:function(e){return p(e,document.createElement("video"))},audio:function(e){return p(e,document.createElement("audio"))}},w=Object.keys(m).map(function(e){function t(t,n,i){var o=i;return t in a&&(o=a[t]),n.indexOf(o)<0&&r("invalid "+t+' "'+o+'" for asset "'+e+'", possible values: '+n),o}function n(t,n,i){var o=i;return t in a?o=a[t]:n&&r("missing "+t+' for asset "'+e+'"'),"string"!=typeof o&&r("invalid "+t+' for asset "'+e+'", must be a string'),o}function o(e,t){if(e in a.parser){var n=a.parser[e];return"function"!=typeof n&&r("invalid parser callback "+e+' for asset "'+e+'"'),n}return t}var a=m[e];"string"==typeof a?a={src:a}:"object"==typeof a&&a||r('invalid asset definition "'+e+'"'),i(a,s,'asset "'+e+'"');var f={};return"parser"in a&&("function"==typeof a.parser?f={data:a.parser}:"object"==typeof a.parser&&a.parser?(i(f,u,'parser for asset "'+e+'"'),"onData"in f||r('missing onData callback for parser in asset "'+e+'"'),f={data:o("onData"),done:o("onDone")}):r('invalid parser for asset "'+e+'"')),{name:e,type:t("type",Object.keys(_),"text"),stream:!!a.stream,credentials:!!a.credentials,src:n("src",!0,""),parser:f}}).map(function(e){return _[e.type](e)});0===w.length&&setTimeout(function(){h("done")},1)}},{}],175:[function(e,t,n){!function(){"use strict";function e(e){e||(e=Math.random),this.p=new Uint8Array(256),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var t=0;t<256;t++)this.p[t]=256*e();for(t=0;t<512;t++)this.perm[t]=this.p[255&t],this.permMod12[t]=this.perm[t]%12}var r=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,o=1/3,a=1/6,s=(Math.sqrt(5)-1)/4,u=(5-Math.sqrt(5))/20;e.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(e,t){var n,o,a=this.permMod12,s=this.perm,u=this.grad3,f=0,c=0,l=0,p=(e+t)*r,d=Math.floor(e+p),h=Math.floor(t+p),m=(d+h)*i,v=d-m,g=h-m,b=e-v,y=t-g;b>y?(n=1,o=0):(n=0,o=1);var x=b-n+i,_=y-o+i,w=b-1+2*i,S=y-1+2*i,A=255&d,k=255&h,E=.5-b*b-y*y;if(E>=0){var j=3*a[A+s[k]];E*=E,f=E*E*(u[j]*b+u[j+1]*y)}var O=.5-x*x-_*_;if(O>=0){var T=3*a[A+n+s[k+o]];O*=O,c=O*O*(u[T]*x+u[T+1]*_)}var D=.5-w*w-S*S;if(D>=0){var M=3*a[A+1+s[k+1]];D*=D,l=D*D*(u[M]*w+u[M+1]*S)}return 70*(f+c+l)},noise3D:function(e,t,n){var r,i,s,u,f,c,l,p,d,h,m=this.permMod12,v=this.perm,g=this.grad3,b=(e+t+n)*o,y=Math.floor(e+b),x=Math.floor(t+b),_=Math.floor(n+b),w=(y+x+_)*a,S=y-w,A=x-w,k=_-w,E=e-S,j=t-A,O=n-k;E>=j?j>=O?(f=1,c=0,l=0,p=1,d=1,h=0):E>=O?(f=1,c=0,l=0,p=1,d=0,h=1):(f=0,c=0,l=1,p=1,d=0,h=1):j<O?(f=0,c=0,l=1,p=0,d=1,h=1):E<O?(f=0,c=1,l=0,p=0,d=1,h=1):(f=0,c=1,l=0,p=1,d=1,h=0);var T=E-f+a,D=j-c+a,M=O-l+a,C=E-p+2*a,P=j-d+2*a,z=O-h+2*a,L=E-1+3*a,F=j-1+3*a,I=O-1+3*a,B=255&y,R=255&x,N=255&_,q=.6-E*E-j*j-O*O;if(q<0)r=0;else{var V=3*m[B+v[R+v[N]]];q*=q,r=q*q*(g[V]*E+g[V+1]*j+g[V+2]*O)}var G=.6-T*T-D*D-M*M;if(G<0)i=0;else{var H=3*m[B+f+v[R+c+v[N+l]]];G*=G,i=G*G*(g[H]*T+g[H+1]*D+g[H+2]*M)}var U=.6-C*C-P*P-z*z;if(U<0)s=0;else{var W=3*m[B+p+v[R+d+v[N+h]]];U*=U,s=U*U*(g[W]*C+g[W+1]*P+g[W+2]*z)}var Q=.6-L*L-F*F-I*I;if(Q<0)u=0;else{var Y=3*m[B+1+v[R+1+v[N+1]]];Q*=Q,u=Q*Q*(g[Y]*L+g[Y+1]*F+g[Y+2]*I)}return 32*(r+i+s+u)},noise4D:function(e,t,n,r){var i,o,a,f,c,l=(this.permMod12,this.perm),p=this.grad4,d=(e+t+n+r)*s,h=Math.floor(e+d),m=Math.floor(t+d),v=Math.floor(n+d),g=Math.floor(r+d),b=(h+m+v+g)*u,y=h-b,x=m-b,_=v-b,w=g-b,S=e-y,A=t-x,k=n-_,E=r-w,j=0,O=0,T=0,D=0;S>A?j++:O++,S>k?j++:T++,S>E?j++:D++,A>k?O++:T++,A>E?O++:D++,k>E?T++:D++;var M,C,P,z,L,F,I,B,R,N,q,V;M=j>=3?1:0,C=O>=3?1:0,P=T>=3?1:0,z=D>=3?1:0,L=j>=2?1:0,F=O>=2?1:0,I=T>=2?1:0,B=D>=2?1:0,R=j>=1?1:0,N=O>=1?1:0,q=T>=1?1:0,V=D>=1?1:0;var G=S-M+u,H=A-C+u,U=k-P+u,W=E-z+u,Q=S-L+2*u,Y=A-F+2*u,X=k-I+2*u,Z=E-B+2*u,$=S-R+3*u,K=A-N+3*u,J=k-q+3*u,ee=E-V+3*u,te=S-1+4*u,ne=A-1+4*u,re=k-1+4*u,ie=E-1+4*u,oe=255&h,ae=255&m,se=255&v,ue=255&g,fe=.6-S*S-A*A-k*k-E*E;if(fe<0)i=0;else{var ce=l[oe+l[ae+l[se+l[ue]]]]%32*4;fe*=fe,i=fe*fe*(p[ce]*S+p[ce+1]*A+p[ce+2]*k+p[ce+3]*E)}var le=.6-G*G-H*H-U*U-W*W;if(le<0)o=0;else{var pe=l[oe+M+l[ae+C+l[se+P+l[ue+z]]]]%32*4;le*=le,o=le*le*(p[pe]*G+p[pe+1]*H+p[pe+2]*U+p[pe+3]*W)}var de=.6-Q*Q-Y*Y-X*X-Z*Z;if(de<0)a=0;else{var he=l[oe+L+l[ae+F+l[se+I+l[ue+B]]]]%32*4;de*=de,a=de*de*(p[he]*Q+p[he+1]*Y+p[he+2]*X+p[he+3]*Z)}var me=.6-$*$-K*K-J*J-ee*ee;if(me<0)f=0;else{var ve=l[oe+R+l[ae+N+l[se+q+l[ue+V]]]]%32*4;me*=me,f=me*me*(p[ve]*$+p[ve+1]*K+p[ve+2]*J+p[ve+3]*ee)}var ge=.6-te*te-ne*ne-re*re-ie*ie;if(ge<0)c=0;else{var be=l[oe+1+l[ae+1+l[se+1+l[ue+1]]]]%32*4;ge*=ge,c=ge*ge*(p[be]*te+p[be+1]*ne+p[be+2]*re+p[be+3]*ie)}return 27*(i+o+a+f+c)}},"undefined"!=typeof define&&define.amd&&define(function(){return e}),"undefined"!=typeof n?n.SimplexNoise=e:"undefined"!=typeof window&&(window.SimplexNoise=e),"undefined"!=typeof t&&(t.exports=e)}()},{}],176:[function(e,t,n){"use strict";function r(e,t){var n=a(getComputedStyle(e).getPropertyValue(t));return n[0]*o(n[1],e)}function i(e,t){var n=document.createElement("div");n.style["font-size"]="128"+e,t.appendChild(n);var i=r(n,"font-size")/128;return t.removeChild(n),i}function o(e,t){switch(t=t||document.body,e=(e||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return i(e,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return s;case"cm":return s/2.54;case"mm":return s/25.4;case"pt":return s/72;case"pc":return s/6}return 1}var a=e(161);t.exports=o;var s=96},{161:161}],177:[function(e,t,n){function r(e){function t(e){for(var t=e.identifier,n=0;n<h.length;n++)if(h[n]&&h[n].touch&&h[n].touch.identifier===t)return n;return-1}function n(){b||(b=!0,e.addEventListener("touchstart",f,!1),e.addEventListener("touchmove",c,!1),e.addEventListener("touchend",l,!1),e.addEventListener("touchcancel",l,!1))}function r(){b&&(b=!1,e.removeEventListener("touchstart",f,!1),e.removeEventListener("touchmove",c,!1),e.removeEventListener("touchend",l,!1),e.removeEventListener("touchcancel",l,!1))}function f(n){for(var r=0;r<n.changedTouches.length;r++){var o=n.changedTouches[r],a=o.identifier,s=t(a);if(s===-1&&m<2){var f=0===m,c=h[0]?1:0,l=h[0]?0:1,b=new i;h[c]=b,m++,b.touch=o,u(o,e,b.position);var y=h[l]?h[l].touch:void 0;if(d.emit("place",o,y),!f){var x=p();g=!1,d.emit("start",x),v=x}}}}function c(n){for(var r=!1,i=0;i<n.changedTouches.length;i++){var o=n.changedTouches[i],a=t(o);a!==-1&&(r=!0,h[a].touch=o,u(o,e,h[a].position))}if(2===m&&r){var s=p();d.emit("change",s,v),v=s}}function l(e){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],i=t(r);if(i!==-1){h[i]=null,m--;var o=0===i?1:0,a=h[o]?h[o].touch:void 0;d.emit("lift",r,a)}}g||2===m||(g=!0,d.emit("end"))}function p(){return m<2?0:o(h[0].position,h[1].position)}e=e||window;var d=new a,h=[null,null],m=0,v=0,g=!1,b=!1;return Object.defineProperties(d,{pinching:s(function(){return 2===m}),fingers:s(function(){return h})}),n(),d.enable=n,d.disable=r,d.indexOfTouch=t,d}function i(){this.position=[0,0],this.touch=null}var o=e(118),a=e(70).EventEmitter,s=e(20),u=e(157);t.exports=r},{118:118,157:157,20:20,70:70}]},{},[4]);